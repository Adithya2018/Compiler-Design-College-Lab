(window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0=window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0||[]).push([[35],{"/uB8":function(e,t,i){"use strict";i.d(t,"a",function(){return m});var o,a,n=i("17wl"),r=i("68aR"),s=i.n(r),l=i("Q8wJ"),u=i("2xT9"),d=i("Aboe"),c=i("P1BV"),p="c8b3137a-ca4c-48a9-b356-a8e7987dd693",h=((o={})[l.b.teamSite]=p,o[l.b.group]=p,o[l.b.sitePagePublishing]="96c933ac-3698-44c7-9f4a-5fd17d71af9e",o[l.b.pointPublishingPersonal]="400955b3-329f-4b22-ade5-002653506aee",o[l.b.contentCenter]="ab120c41-0d36-490b-a048-b39f65675858",o),g=((a={})[p]=function(){return{id:p,title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:d.f.none},nav:{hidden:!1,placement:d.e.LEFT},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[l.b.teamSite,l.b.group]}},a["96c933ac-3698-44c7-9f4a-5fd17d71af9e"]=function(){return{id:"96c933ac-3698-44c7-9f4a-5fd17d71af9e",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:d.f.none},nav:{hidden:!1,placement:d.e.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!0}},supportedTemplates:[l.b.sitePagePublishing]}},a["6142d2a0-63a5-4ba0-aede-d9fefca2c767"]=function(){return{id:"6142d2a0-63a5-4ba0-aede-d9fefca2c767",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:d.f.none},nav:{hidden:!1,placement:d.e.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!0}},supportedTemplates:[l.b.sitePagePublishing]}},a["f6cc5403-0d63-442e-96c0-285923709ffc"]=function(){return{id:"f6cc5403-0d63-442e-96c0-285923709ffc",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:d.f.none},nav:{hidden:!1,placement:d.e.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!0}},supportedTemplates:[l.b.sitePagePublishing]}},a["400955b3-329f-4b22-ade5-002653506aee"]=function(){return{id:"400955b3-329f-4b22-ade5-002653506aee",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:d.f.none},nav:{hidden:!1,placement:d.e.LEFT,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[l.b.pointPublishingPersonal]}},a["fbf8ec01-846c-44c4-b17b-8fe1e4e5adae"]=function(){return{id:"fbf8ec01-846c-44c4-b17b-8fe1e4e5adae",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:d.f.none},nav:{hidden:!1,placement:d.e.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[l.b.sitePagePublishing]}},a["ab120c41-0d36-490b-a048-b39f65675858"]=function(){return{id:"ab120c41-0d36-490b-a048-b39f65675858",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:d.f.none},nav:{hidden:!1,placement:d.e.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[l.b.contentCenter]}},a["67f52693-99aa-428d-8670-0b1b2d291aa8"]=function(){if(!c.Killswitch.isActivated("5ff3cf56-b6b0-4ac9-8162-f87f7a49a5cf","04/09/2020","Deactivate knowledge center design package"))return{id:"67f52693-99aa-428d-8670-0b1b2d291aa8",title:void 0,description:void 0,chromeOptions:{header:{hidden:!1,layout:d.f.none},nav:{hidden:!1,placement:d.e.HORIZONTAL,megaMenuEnabled:!0},footer:{hidden:!1},search:{hidden:!1}},supportedTemplates:[l.b.contentCenter]}},a);function m(e){var t,i=function(e){if(!e)throw new Error("pageContext missing");var t=function(e){var t,i=s.a.Empty;return e.DesignPackageId&&(t=e.DesignPackageId,void 0!==g[t])&&(i=e.DesignPackageId),i===s.a.Empty&&void 0!==h[e.webTemplate]&&(i=h[e.webTemplate]),i===s.a.Empty&&(i=p),i}(e);return Object(n.__assign)(Object(n.__assign)({},g[t]().chromeOptions),{footer:{emphasis:d.a.Strong,hidden:!0,layout:d.b.SIMPLE}})}(e),o=(e.webPropertyFlags2&u.b.FooterEmphasis1)>>8,a=(e.webPropertyFlags2&u.b.FooterEmphasis0)>>8;i.footer.emphasis=o|a;var r=(e.webPropertyFlags2&u.b.FooterLayout1)>>10,l=(e.webPropertyFlags2&u.b.FooterLayout0)>>10;i.footer.layout=r|l,i.footer.hidden=0==(2&e.webPropertyFlags2),i.nav&&!i.nav.hidden&&(i.nav.megaMenuEnabled=0!=(128&e.webPropertyFlags2),i.nav.quickLaunchEnabled=!!(null===(t=e.navigationInfo)||void 0===t?void 0:t.quickLaunch)),i.header.layout=e.headerLayout,i.header.emphasis=e.headerEmphasis,i.header.logoAlignment=e.logoAlignment;var c=0!=(e.webPropertyFlags2&u.b.HideTitleInHeader);return i.header.hideTitle=c,i}},"6w9V":function(e,t,i){var o=i("K9kD");for(var a in e.exports={},o)o.hasOwnProperty(a)&&(e.exports[a]=o[a]);e.exports.default=o.Async,Object.defineProperty(e.exports,"__esModule",{value:!0})},"8YHf":function(e,t,i){"use strict";var o;i.d(t,"a",function(){return o}),function(e){e[e.Cache=0]="Cache",e[e.Server=1]="Server",e[e.None=2]="None",e[e.Error=3]="Error"}(o||(o={}))},IeXd:function(e,t,i){"use strict";i.r(t),i.d(t,"FOLLOWED_SITES_IN_STORE_KEY",function(){return q}),i.d(t,"SiteHeaderContainerStateManager",function(){return K});var o,a=i("17wl"),n=i("nbQ9"),r=i("xZje"),s=i("1B3/"),l=i("/uB8"),u=i("SrEf"),d=i("gcRq"),c=i.n(d),p=i("4xRo"),h=i.n(p),g={ODB:1075},m=i("xOxG"),f=i.n(m),b=i("2xT9"),_=i("mDjs"),v=i("Aboe"),S=i("8YHf"),y=i("Q8wJ"),C=i("08Oh"),w=i.n(C),x=i("P1BV"),P=i("JzEA"),O=i("uN8c"),T={"SPHome-ClientType":"PagesWeb"},A=function(e){function t(t){var i=e.call(this,{dataSourceName:"FollowDataSource",id:"FavoriteFeed"},{pageContext:t})||this;return i._isSiteFollowedCacheKey="isSiteFollowed_"+(t.siteId+t.webId),i._doubleQuoteKillSwitchIsActivated=x.Killswitch.isActivated("83386358-6d38-48f2-94b4-b91c9c9b1d84","06/29/2020","Double quote for Follow post data"),i}return Object(a.__extends)(t,e),t.prototype.followSite=function(e){var t=this;return this.dataRequestor.getData({url:Object(b.c)(this._pageContext)+"/_vti_bin/homeapi.ashx/sites/followed/add",qosName:"FollowSite",additionalPostData:this._doubleQuoteKillSwitchIsActivated?"'"+e+"'":'"'+e+'"',additionalHeaders:T,noRedirect:!0}).then(function(){t.flushCache(t._isSiteFollowedCacheKey)})},t.prototype.unfollowSite=function(e){var t=this;return this.dataRequestor.getData({url:Object(b.c)(this._pageContext)+"/_vti_bin/homeapi.ashx/sites/followed/remove",qosName:"UnfollowSite",additionalPostData:this._doubleQuoteKillSwitchIsActivated?"'"+e+"'":'"'+e+'"',additionalHeaders:T,noRedirect:!0}).then(function(){t.flushCache(t._isSiteFollowedCacheKey)})},t.prototype.isSiteFollowed=function(e,t,i,o,n){void 0===t&&(t=!1),void 0===i&&(i=!1);var r=0;return i?r=3:t&&(r=2),o&&n?this.getDataUtilizingPersistentCache({url:Object(b.c)(this._pageContext)+"/_vti_bin/homeapi.ashx/sites/followed/isFollowed?siteId="+o+"&webId="+n+"&url="+w.a.encodeURIComponent(e),parseResponse:function(e){return"true"===e},qosName:"isSiteFollowed",telemetryHandler:function(e){var t=e.errorData,i=e.eventData;if(t){var o=!1;if(t.responseData&&t.responseData.ErrorCode){var n=t.responseData.ErrorCode;500007!==n&&500019!==n&&500020!==n&&500021!==n||(o=!0)}var r=o?O.ResultTypeEnum.ExpectedFailure:O.ResultTypeEnum.Failure;return{eventData:Object(a.__assign)(Object(a.__assign)({},i),{resultType:r})}}return{eventData:i}},additionalHeaders:T,noRedirect:!0,method:"GET",cachingStrategy:r,cacheRequestKey:this._isSiteFollowedCacheKey}).catch(function(e){if(e&&e.responseData&&e.responseData.ErrorCode){var t=e.responseData.ErrorCode;if(500007===t||500019===t||500020===t||500021===t)return!1}throw e}):this.getDataUtilizingPersistentCache({url:Object(b.c)(this._pageContext)+"/_api/social.following/IsFollowed",parseResponse:function(e){return JSON.parse(e).d.IsFollowed},qosName:"isSiteFollowed",noRedirect:!0,method:"POST",additionalPostData:JSON.stringify({actor:{__metadata:{type:"SP.Social.SocialActorInfo"},ActorType:1,ContentUri:e,Id:null}}),cachingStrategy:r,cacheRequestKey:this._isSiteFollowedCacheKey})},t.prototype.isFollowFeatureEnabled=function(){return this.getDataUtilizingPersistentCache({url:this._pageContext.webAbsoluteUrl+"/_api/SP.Utilities.SPSocialSwitch.IsFollowingFeatureEnabled",cacheRequestKey:"followEnabled_"+(this._pageContext.webId+this._pageContext.siteId),method:"POST",noRedirect:!0,qosName:"isFollowFeatureEnabled",parseResponse:function(e){return JSON.parse(e).d.IsFollowingFeatureEnabled}})},t}(P.a),E=i("yCth"),L=i("fj7e"),k=i("qIay"),U=i("6w9V"),F=i.n(U),D=i("LEbc"),I=i.n(D),G=i("rmH8"),B=i.n(G),N=i("mVz8"),R={ODB:1075},M={ODB:1120},H={ODB:1559},z={ODB:1067},j=[{name:"inboxUrl",eid:"Mail",trimIfAnonymous:!0},{name:"calendarUrl",eid:"Calendar",trimIfAnonymous:!0},{name:"filesUrl",eid:"Files",trimIfAnonymous:!1},{name:"notebookUrl",eid:"Notebook",trimIfAnonymous:!1},{name:"siteUrl",eid:"Home",trimIfAnonymous:!1},{name:"membersUrl",eid:"Members",trimIfAnonymous:!0},{name:"plannerUrl",eid:"Planner",trimIfAnonymous:!0}],q="FollowedSites";!function(e){e[e.quickLaunch=0]="quickLaunch",e[e.globalNav=1]="globalNav",e[e.none=2]="none"}(o||(o={}));var K=function(){function e(e){var t=this;this._onGoToMembersClick=function(e){N.Engagement.logData({name:"SiteHeader.GoToMembers.Click"}),t._params.goToMembersOnClick(e),e&&(e.stopPropagation(),e.preventDefault())},this._onCreateSiteClick=function(e){N.Engagement.logData({name:"SiteHeader.CreateSite.Click"}),t._params.createSiteOnClick&&t._params.createSiteOnClick(e),e&&(e.stopPropagation(),e.preventDefault())},this._onUserExpirationDismissClick=function(e){N.Engagement.logData({name:"SiteHeader.UserExpirationMessageBarDismiss.Click"}),t.setState({hideUserExpirationBar:!0})},this._onFollowClick=function(e){N.Engagement.logData({name:"SiteHeader.Follow.Click"});var i=t._params.siteHeader.state.followState;t.setState({followState:r.a.transitioning}),i===r.a.followed?t._followDataSource.unfollowSite(t._pageContext.webAbsoluteUrl).done(function(){t.setState({followState:r.a.notFollowing})},function(e){t.setState({followState:r.a.followed})}):t._followDataSource.followSite(t._pageContext.webAbsoluteUrl).done(function(){t.setState({followState:r.a.followed})},function(e){t.setState({followState:r.a.notFollowing})})},this._getUrlFromEnum=function(e,i){var o=i[j[e].name];return o||e!==n.a.site||(o=t._params.pageContext.webAbsoluteUrl),o},this._updateUsageGuidelineCallback=function(){t._noThrowPromise(t._updateUsageGuidelineUrl()).then(function(e){e&&e.usageGuidelineUrl&&t.setState({usageGuidelineUrl:e.usageGuidelineUrl})})},this._params=e;var i=e.pageContext;this._pageContext=i,this._isGroup=Object(b.e)(i),this._async=new F.a,this._asyncFetchTopNav=!1,x.Killswitch.isActivated("76048f30-8c23-4145-97e4-f0aadb3b29aa","7/13/2020","FixGuestExperience")?(this._isAnonymousGuest=i.isAnonymousGuestUser||i.isExternalGuestUser,this._isGuest=this._isAnonymousGuest):(this._isAnonymousGuest=i.isAnonymousGuestUser||i.isEmailAuthenticationGuestUser,this._isGuest=this._isAnonymousGuest||i.isExternalGuestUser),this._hasManageLists=E.a.hasPermission(i.webPermMasks,E.a.manageLists),this._chrome=Object(l.a)(this._pageContext);var o,a="";a=h.a.isFeatureEnabled(z)&&this.shouldUseSiteIconManager(i)?x.Killswitch.isActivated("535d360b-694f-4f0c-8024-51b6ffa98bdd","10/21/2020","UpdateSiteLogoFormat")?"/_api/siteiconmanager/getsitelogo?siteurl='"+i.webAbsoluteUrl+"'&type=1":i.webAbsoluteUrl+"/_api/siteiconmanager/getsitelogo?type='1'":e.pageContext.webLogoUrl,h.a.isFeatureEnabled(z)||(a&&(-1===a.indexOf(b.a)||(a=void 0)),!this._isGroup||a&&-1!==a.toLowerCase().indexOf("/_api/GroupService/GetGroupImage".toLowerCase())||(a=i.webAbsoluteUrl+"/_api/GroupService/GetGroupImage"));var s=e.pageContext.webAbsoluteUrl;s&&(o=function(t){N.Engagement.logData({name:"SiteHeader.Logo.Click"}),e.logoOnClick&&(e.logoOnClick(s,t),t.stopPropagation(),t.preventDefault())});var u=this._setupHorizontalNav(),d=this._isGroup?i.webAbsoluteUrl+"/_layouts/15/groupstatus.aspx?id="+i.groupId+"&target=conversations":void 0;this._params.siteHeader.state={membersText:void 0,siteClassification:this._isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled&&this._getSiteClassification()||i.siteClassification,usageGuidelineUrl:void 0,siteLogoUrl:a,horizontalNavItems:u,logoOnClick:o,webAbsoluteUrl:s,outlookUrl:d,showCreateSiteButton:!1},W()&&!a&&(this._acronymDatasource=this._params.acronymDatasource||new _.a(i))}return e.prototype.componentDidMount=function(){var e=this,t=[this._isGroup||W()&&!this._acronymDatasource?c.a.resolve(void 0):this._noThrowPromise(this._loadSiteAcronym()),this._noThrowPromise(this._setupSiteReadOnlyBar()),this._noThrowPromise(this._setupSiteResourceQuotaBar()),this._noThrowPromise(this._setupFollowButton()),this._noThrowPromise(this._setupUserExpirationBar()),this._noThrowPromise(this._processGroups()),this._noThrowPromise(this._setupCreateSiteButton()),this._noThrowPromise(this._setupSiteStatusBar()),this._noThrowPromise(this._setupSitePolicyBar()),this._noThrowPromise(this._setupUnauthorizedTenantBar()),this._noThrowPromise(this._fetchTopNavigation()),this._noThrowPromise(this._setupNoSharePointSyntexLicenseBar())];c.a.all(t).then(function(t){var i={};t.forEach(function(e){e&&(i=Object(a.__assign)(Object(a.__assign)({},i),e))}),e.setState(i)})},e.prototype.componentWillUnmount=function(){this._async.dispose(),this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=null)},e.prototype.getRenderProps=function(e,t,i,a){var n,r,l=this._params,d=l.siteHeader.state,c=l.strings,p=l.pageContext,g=Number(p.webTemplate),m={siteLogoUrl:d.siteLogoUrl,siteAcronym:d.siteAcronym},b=this._computeGoToMembersAction(d.membersUrl),_=d.facepilePersonas&&!x.Killswitch.isActivated("96EC0112-DF6B-41BE-A704-47ABF4B7D922","05/03/2018","Facepile Persona coins with LPC control")?{personas:d.facepilePersonas,getPersonaProps:function(e){return{onRenderCoin:function(o,a){var n,r={personaType:(n=e&&e.data&&e.data.groupPerson)&&2===n.entityType?"Group":"User",identifier:n&&n.email,pageContext:p,moduleLoader:t,customWaiter:i,addGroupMembersCallback:function(e){b(void 0)},lpcHoverTargetProps:{upn:n&&n.email,hostAppPersonaInfo:{PersonaDisplayName:n&&n.name}}};return Object(u.b)(r,a(o))}}}}:{personas:d.facepilePersonas},S={membersText:d.membersText,goToMembersAction:b},C=d.webAbsoluteUrl,w={siteTitle:p.webTitle,headerOptions:this._chrome&&this._chrome.header,groupInfoString:this._getGroupInfoString(p,c),siteClassification:this._isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled&&this._getSiteClassification()||p.siteClassification,siteLogo:m,logoHref:C,logoOnClick:d.logoOnClick,disableSiteLogoFallback:!0,facepile:_,showGroupCard:!!d.groupLinks,groupLinks:d.groupLinks,membersInfoProps:S,moduleLoader:e,lpcModuleLoader:t,lpcModuleLoaderWaiter:i,usageGuidelineUrl:d.usageGuidelineUrl,updateUsageGuidelineUrl:this._updateUsageGuidelineCallback,pageContext:p,groupEmail:d.groupEmail,waitForPLT:this._params.waitForPLT},P=!!l.onEditClicked&&!d.isSiteReadOnly&&!this._isAnonymousGuest&&this._hasManageLists,O=this._chrome.nav.megaMenuEnabled,T={items:d.horizontalNavItems,editLink:P?Object(s.c)(p,!1,l.onEditClicked,void 0,f.a.editButtonAriaLabel):void 0,moduleLoader:e,isEditMode:d.isEditMode,ariaLabel:c.horizontalNavAriaLabel||f.a.ariaLabel,splitButtonAriaLabel:f.a.splitButtonAriaLabelWithName,moreOptionsAriaLabel:c.horizontalNavMoreOptionsAriaLabel||f.a.moreOptionsAriaLabel,hasSelectedState:this._horizontalNavType===o.quickLaunch,pageContext:this._pageContext,useMegaMenu:O};p&&p.navigationInfo&&p.navigationInfo.isAudienceTargeted&&(T.isAudienceTargeted=!0),this._horizontalNavType===o.quickLaunch?n=T:this._horizontalNavType===o.globalNav&&(r=T);var A=void 0!==d.followState?{followLabel:c.follow,followAction:this._onFollowClick,followState:d.followState,followedAriaLabel:c.followButtonAriaLabel,notFollowedAriaLabel:c.followButtonAriaLabel,followedHoverText:c.followedHover,notFollowedHoverText:c.notFollowedHover,notFollowedLabel:c.notFollowed}:void 0,L=void 0;B.a.isFeatureEnabled(M)&&(L={pageContext:p,moduleLoader:a,moduleLoaderWaiter:i,imageUrls:this._params.imageUrls});var k=void 0;this._isAnonymousGuest||!E.a.hasPermission(this._pageContext.webPermMasks,E.a.editListItems)||p.groupId&&"00000000-0000-0000-0000-000000000000"!==p.groupId||(k={url:p.webAbsoluteUrl+"/_layouts/15/share.aspx?isDlg=1&OpenInTopFrame=1",shareLabel:c.shareLabel,loadingLabel:c.loadingLabel},l.shareButtonOnClick&&(k.url="",k.onShare=l.shareButtonOnClick));var U,F=d.showCreateSiteButton?{createSiteAction:this._onCreateSiteClick}:void 0;d.isSiteReadOnly?(U={isSiteReadOnly:!0,siteReadOnlyString:c.siteIsReadOnly,siteReadOnlyState:d.siteReadOnlyState,siteIsMovingString:c.siteIsMoving,siteMoveCompletedString:c.siteMoveComplete},p.isArchived&&g===y.a.teamChannel&&(U.siteReadOnlyString=c.siteIsArchived)):U=void 0;var D=void 0;0!==d.siteResourceQuotaState&&(D={siteResourceQuotaState:d.siteResourceQuotaState,siteResourceOverQuota:c.siteIsOverQuota,siteResourceQuotaWarning:c.siteIsCloseToQuota});var I=this._horizontalNavType===o.quickLaunch?v.c.FULLBLEED:void 0,G=h.a.isFeatureEnabled({ODB:1179})?this._pageContext.headerLayout:void 0,N=!d.hideUserExpirationBar&&d.expiringUsers>0&&{userExpirationOnClick:this._params.userExpirationOnClick,onDismiss:this._onUserExpirationDismissClick,expiringUserCount:d.expiringUsers};return{siteHeaderProps:w,horizontalNavProps:n,topNavProps:r,onRenderHorizontalNav:l.onRenderHorizontalNav,createSiteButton:F,shareButton:k,follow:A,siteScriptProgressIndicator:L,messageBarProps:d.messageBarState,siteReadOnlyProps:U,siteResourceQuotaProps:D,policyBarProps:d.policyBarState,unauthorizedTenantBarProps:d.unauthorizedTenantBarState,noSharePointSyntexLicenseBarProps:d.noSharePointSyntexLicenseBarState,layout:I,unifiedLayout:G,userExpirationBarProps:N,getAccessToken:l.getAccessToken,groupsProvider:this._groupsProvider}},e.prototype.updateHorizontalNav=function(e,t){this.setState({horizontalNavItems:e,editModeHorizontalNav:!1},t)},e.prototype._getGroupInfoString=function(e,t){var i;if(this._isGroup)i="Public"===e.groupType?t.publicGroup:t.privateGroup;else if(e.isTeamsChannelSite||Number(e.webTemplate)===y.a.teamChannel){var o=e.teamsChannelType;i=3===o?t.standardChannel:2===o?t.sharedChannel:t.privateChannel}return i},e.prototype._computeGoToMembersAction=function(e){var t=void 0;return this._isGuest||(t=this._onGoToMembersClick),t},e.prototype.setState=function(e,t){this._params.siteHeader.setState(e,t)},e.prototype._noThrowPromise=function(e){return e.catch(function(){})},e.prototype.shouldUseSiteIconManager=function(e){return e.webLogoUrl||e.webLogoUrl.indexOf(b.a)>=0||this.containsSiteAssetsRelativePath(e)||this._isGroup},e.prototype.containsSiteAssetsRelativePath=function(e){return e.webLogoUrl&&e.webAbsoluteUrl&&e.webLogoUrl.toLowerCase().indexOf(e.webAbsoluteUrl.toLowerCase()+"/siteassets")>=0},e.prototype._loadSiteAcronym=function(){return this._acronymDatasource.getAcronymData(this._pageContext.webTitle).then(function(e){return{siteAcronym:e.acronym,siteLogoColor:e.color}})},e.prototype._setupHorizontalNav=function(){var e,t=this._pageContext,i=t.navigationInfo,a=i&&i.quickLaunch,n=i&&i.topNav,r=this._chrome.nav.placement===v.e.HORIZONTAL,s=o.none;return r&&this._params.horizontalQuickLaunchEnabled&&a&&a.length?(e=a,s=o.quickLaunch):t.isHubSite?s=o.none:t.PublishingFeatureOn?(this._asyncFetchTopNav=!0,s=o.globalNav):n&&n.length&&(s=o.globalNav,e=n),this._horizontalNavType=s,this._transformToNavItems(e)},e.prototype._fetchTopNavigation=function(){if(this._asyncFetchTopNav){var e=new L.a(this._pageContext,"GlobalNavigationSwitchableProvider"),t=this._chrome.nav.megaMenuEnabled?3:2;return e.getMenuState({useCache:!0,depth:t}).then(function(e){if((!Q||e)&&e.links)return{horizontalNavItems:e.links}})}return c.a.resolve(void 0)},e.prototype._transformToNavItems=function(e){var t=this,i=[];if(e&&e.length>0){var a=this._horizontalNavType===o.quickLaunch;i=L.a.transformNodesToLinks(e,function(e,i){(!i||""!==i.url&&i.url!==s.b)&&t._params.topNavNodeOnClick(e,i),e.stopPropagation(),e.preventDefault()},function(e,t){return t>0||!(a&&e.Id===Number("1033"))})}return i},e.prototype._processGroups=function(){var e=this;return this._isGroup?this._params.getGroupsProvider().then(function(t){return t&&(e._groupsProvider=t,e._groupsProvider.group)?(e._groupsProvider.group.membership.load(),e._updateGroupsInfo()):c.a.resolve(void 0)}):c.a.resolve(void 0)},e.prototype._updateGroupsInfo=function(){var e,t,i,o=this,n={};if(this._isGroup){var r=this._groupsProvider.group,s=function(e){var t={};if(e!==S.a.None&&r.membership&&o._totalNumberOfMembers!==r.membership.totalNumberOfMembers){var i=o._updateFacepilePersonas(r.membership),n=o._getMembersText(r.membership);o._totalNumberOfMembers=r.membership.totalNumberOfMembers,t=Object(a.__assign)(Object(a.__assign)({},t),{membersText:n,facepilePersonas:i})}return c.a.resolve(t)},l=function(n){var s={};if(n!==S.a.None&&!o._hasParsedMembers){o._hasParsedMembers=!0,i=o._isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled&&o._getSiteClassification()||r.classification||o._pageContext.siteClassification,e=o._isGuest?void 0:r.inboxUrl,t=o._isGuest?void 0:r.membersUrl;var l=o._groupCardLinksFromGroupCardLinkParams(o._params.groupCardInfo,r);if(s={siteClassification:i,outlookUrl:e,membersUrl:t,groupLinks:l,groupEmail:r.mail},!W()||o._acronymDatasource)return o._noThrowPromise(o._loadSiteAcronym()).then(function(e){return Object(a.__assign)(Object(a.__assign)({},e),s)})}return c.a.resolve(s)};return this._ensureEventGroup(),this._eventGroup.on(r,"source",function(e){l(e).then(function(e){o.setState(e)})}),this._eventGroup.on(r.membership,"source",function(e){s(e).then(function(e){o.setState(e)})}),c.a.all([l(r.source),s(r.membership.source)]).then(function(e){return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},e[0]),e[1]),n)})}return c.a.resolve(n)},e.prototype._ensureEventGroup=function(){this._eventGroup||(this._eventGroup=new I.a(this))},e.prototype._groupCardLinksFromGroupCardLinkParams=function(e,t){var i=[];if(this._isGroup&&t&&e&&e.length){for(var o=0;o<e.length;o++){var a=e[o].linkType,n=this._getUrlFromEnum(a,t);if(n&&(!this._isAnonymousGuest||!j[a].trimIfAnonymous)){var r="GroupCard."+j[a].eid+".Click";i.push({title:e[o].title,icon:e[o].icon,href:n,engagementId:r})}}return i}return null},e.prototype._updateUsageGuidelineUrl=function(){var e=this;return(this._isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled&&this._pageContext.sensitivityLabel||this._pageContext.siteClassification&&!this._pageContext.isAnonymousGuestUser&&!this._pageContext.isExternalGuestUser)&&this._params.getGroupSiteProvider?this._params.getGroupSiteProvider().then(function(t){e._groupSiteProvider=t}).then(function(){var t;return e._groupSiteProvider&&(t=e._groupSiteProvider.getGroupCreationContext()),t}).then(function(e){return{usageGuidelineUrl:e.usageGuidelineUrl}}):c.a.resolve(void 0)},e.prototype._getHubDataSource=function(){var e=this;return this._hubDataSource?c.a.as(this._hubDataSource):Promise.resolve().then(i.bind(null,"NP8v")).then(function(t){return e._hubDataSource=new t.default(e._pageContext),e._hubDataSource})},e.prototype._setupCreateSiteButton=function(){var e=this;if(h.a.isFeatureEnabled(R)){var t=this._params.waitForPLT;if(t)return t.then(function(){return e._getHubDataSource()}).then(function(t){return function(e,t){return h.a.isFeatureEnabled(g)&&t&&e&&e.isHubSite?t.canCreateHubJoinedSite(e.hubSiteId):c.a.resolve(!1)}(e._pageContext,t)}).then(function(e){return{showCreateSiteButton:!!e}})}return c.a.resolve(void 0)},e.prototype._setupFollowButton=function(){var e=this;return this._isGuest?c.a.resolve(void 0):(this._followDataSource=this._params.followDataSource||new A(this._pageContext),this._followDataSource.isFollowFeatureEnabled().then(function(t){var i;return t?e._followDataSource.isSiteFollowed(e._pageContext.webAbsoluteUrl,!1,!1,e._pageContext.siteId,e._pageContext.webId).then(function(e){return void 0!==e&&(i={followState:e?r.a.followed:r.a.notFollowing}),i}):{followState:void 0}}))},e.prototype._setupSiteStatusBar=function(){return this._params.getSiteDataSource?this._params.getSiteDataSource().then(function(e){return e.getStatusBarInfo()}).then(function(e){return e.StatusBarText?{messageBarState:{message:e.StatusBarText,linkText:e.StatusBarLinkText,linkTarget:e.StatusBarLinkTarget}}:c.a.resolve(void 0)}):c.a.resolve(void 0)},e.prototype._setupSitePolicyBar=function(){var e;return B.a.isFeatureEnabled({ODB:749,ODC:null,Fallback:!1})&&(this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled)?(e=this._params.strings.authenticationPolicyActive&&this._params.strings.messageBarMoreInfo?{message:this._params.strings.authenticationPolicyActive,linkText:this._params.strings.messageBarMoreInfo,linkTarget:"http://go.microsoft.com/fwlink/p/?LinkId=823640"}:{message:void 0,linkText:void 0,linkTarget:void 0},c.a.resolve({policyBarState:e})):c.a.resolve(void 0)},e.prototype._setupUnauthorizedTenantBar=function(){var e;return B.a.isFeatureEnabled({ODB:1577,ODC:null,Fallback:!1})&&this._pageContext.isUnauthorizedTenant?(e=this._params.strings.unauthorizedTenantActive&&this._params.strings.messageBarMoreInfo?{message:this._params.strings.unauthorizedTenantActive,linkText:this._params.strings.messageBarMoreInfo,linkTarget:"http://go.microsoft.com/fwlink/p/?LinkId=2092321"}:{message:void 0,linkText:void 0,linkTarget:void 0},c.a.resolve({unauthorizedTenantBarState:e})):c.a.resolve(void 0)},e.prototype._setupNoSharePointSyntexLicenseBar=function(){var e=this;if(B.a.isFeatureEnabled({ODB:60031,ODC:null,Fallback:!1})&&Number(this._pageContext.webTemplate)===y.a.contentCenter){var t={noSharePointSyntexLicenseBarState:void 0};if(this._params.getSyntexDataSource)return this._params.getSyntexDataSource().then(function(i){return i.getMachineLearningCaptureEnabled().then(function(i){var o,a;if(!i){var n=B.a.isFeatureEnabled({ODB:60049,ODC:null,Fallback:!1}),r=null===(o=e._params.strings)||void 0===o?void 0:o.default;t.noSharePointSyntexLicenseBarState={message:n&&(null===(a=r)||void 0===a?void 0:a.noSharePointSyntexLicense)?r.noSharePointSyntexLicense:e._params.strings.noSharePointSyntexLicense,linkText:void 0,linkTarget:void 0}}return t})})}return c.a.resolve(void 0)},e.prototype._setupSiteReadOnlyBar=function(){if(x.Killswitch.isActivated("40EBE94D-11BC-4926-A75E-6827E8FB6CD8","8/11/2020","Remove Readonly XHR"))return this._setupSiteReadOnlyBarOld();var e={};return void 0===this._pageContext.readOnlyState?e.siteReadOnlyState=-2:null===this._pageContext.readOnlyState?e.siteReadOnlyState=-1:(e.siteReadOnlyState=this._pageContext.readOnlyState,e.isSiteReadOnly=this._pageContext.readOnlyState>=0),this._pageContext.isArchived&&(e.isSiteReadOnly=!0),c.a.resolve(e)},e.prototype._setupSiteReadOnlyBarOld=function(){var e=this;return this._params.getSiteDataSource?this._params.getSiteDataSource().then(function(t){return t.getReadOnlyState().then(function(i){var o={siteReadOnlyState:t.getFullSiteReadOnlyState()};return(i||e._pageContext.isArchived)&&(o.isSiteReadOnly=!0),o})}):c.a.resolve(void 0)},e.prototype._setupSiteResourceQuotaBar=function(){var e={siteResourceQuotaState:this._pageContext.resourceQuotaExceeded};return c.a.resolve(e)},e.prototype._setupUserExpirationBar=function(){var e=this,t=this._pageContext.isSiteAdmin&&B.a.isFeatureEnabled(H);return this._params.userExpirationOnClick&&this._params.getUserExpirationProvider&&t?this._userExpirationProvider?this._userExpirationProvider.getUsersWithExpirations("UserExpiration",!0,50,0,void 0).then(function(t){return e._countExpiringUsers(t)}).then(function(e){if(e>0)return{expiringUsers:e}}):this._params.getUserExpirationProvider().then(function(t){e._userExpirationProvider=t}).then(function(){return e._userExpirationProvider.getUsersWithExpirations("UserExpiration",!0,50,0,void 0).then(function(t){return e._countExpiringUsers(t)}).then(function(e){if(e>0)return{expiringUsers:e}})}):c.a.resolve(void 0)},e.prototype._countExpiringUsers=function(e){var t=0,i=new Date,o=new Date(i.getTime()+18144e5);return e.forEach(function(e){e.expiration<o&&!(e.isSiteAdmin&&e.expiration<i)&&t++}),t},e.prototype._getMembersText=function(e){var t=e.totalNumberOfMembers;if(t){var i=this._params.strings,o=k.getLocalizedCountValue(i.membersCount,i.membersCountIntervals,t);return k.format(o,t)}},e.prototype._updateFacepilePersonas=function(e){return e.membersList.members.slice(0,3).map(function(e,t){return{personaName:e.name,imageUrl:e.image,data:{groupPerson:e,personaType:e.entityType},"data-automationid":"SiteHeaderFacepilePersona_"+t.toString()}})},Object.defineProperty(e.prototype,"_isDisplayAssignedLabelsInsteadOfClassificationFeatureEnabled",{get:function(){return h.a.isFeatureEnabled({ODB:1688})},enumerable:!0,configurable:!0}),e.prototype._getSiteClassification=function(){var e,t;return this._groupsProvider&&this._groupsProvider.group&&(this._pageContext&&(e=this._pageContext.sensitivityLabelName),e||(t=this._groupsProvider.group.classification)),e||t||this._pageContext&&this._pageContext.siteClassification},e}();function Q(){return x.Killswitch.isActivated("1cd2d1c9-fdc8-4110-a71e-e8125063dd90","2020-09-01","Refine the audience targeting logging")}function W(){return!x.Killswitch.isActivated("4f8452f7-e57d-4fcd-978c-fb72127955a9","09/08/2020","Skip call to get acronym if cusotm site logo exists")}t.default=K},Q8wJ:function(e,t,i){"use strict";var o;i.d(t,"a",function(){return o}),function(e){e[e.invalid=-1]="invalid",e[e.teamSite=1]="teamSite",e[e.meetings=2]="meetings",e[e.centralAdmin=3]="centralAdmin",e[e.wiki=4]="wiki",e[e.documentCenter=7]="documentCenter",e[e.blog=9]="blog",e[e.tenantAdmin=16]="tenantAdmin",e[e.app=17]="app",e[e.appCatalog=18]="appCatalog",e[e.mySite=21]="mySite",e[e.subgroup=39]="subgroup",e[e.publishingPortal=52]="publishingPortal",e[e.mySiteHost=54]="mySiteHost",e[e.enterpriseWiki=56]="enterpriseWiki",e[e.group=64]="group",e[e.pointPublishingPersonal=66]="pointPublishingPersonal",e[e.sitePagePublishing=68]="sitePagePublishing",e[e.teamChannel=69]="teamChannel",e[e.projectWebAppSite=6221]="projectWebAppSite",e[e.contentCenter=6001]="contentCenter"}(o||(o={})),t.b=o},mDjs:function(e,t,i){"use strict";i.d(t,"a",function(){return p});var o,a=i("17wl"),n=i("2xT9"),r=i("JzEA"),s=i("gcRq"),l=i.n(s),u=i("08Oh"),d=i.n(u);!function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed"}(o||(o={}));var c=["#0078d7","#088272","#107c10","#881798","#b4009e","#e81123","#da3b01","#006f94","#005e50","#004e8c","#a80000","#4e257f"],p=function(e){function t(t){return e.call(this,{dataSourceName:"SiteHeaderLogoAcronym",id:"acronymAndColors"},{pageContext:t})||this}return Object(a.__extends)(t,e),t.decodeAcronymColor=function(e){return c.indexOf(e)+1},t.prototype.getAcronymData=function(e){return this.getAcronyms([e]).then(function(e){return e[0]},function(){return{acronym:void 0,color:void 0,text:void 0}})},t.prototype.getAcronyms=function(e,t){var i=this;if(void 0===t&&(t={}),this._pageContext.webServerRelativeUrl){var o=t.qosName,a=void 0===o?"GetSiteHeaderLogoAcronym":o;return this.getDataUtilizingPersistentCache({getUrl:function(){var t=e.map(function(e){return"{Text: "+d.a.encodeURIComponent('"'+e+'"')+"}"}).join(",");return Object(n.c)(i._pageContext)+"/_api/sphome/GetAcronymsAndColors?labels=["+t+"]"},parseResponse:function(e){return JSON.parse(e).d.GetAcronymsAndColors.results.map(function(e){return{acronym:e.Acronym,color:e.Color,text:e.Text}})},method:"GET",qosName:a})}return l.a.reject(new Error("No web URL specified for request."))},t}(r.a);t.b=p}}]);