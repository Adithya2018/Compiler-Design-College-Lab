(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[102],{"6axY":function(e,t,n){"use strict";n.r(t),n.d(t,"pageMode",function(){return M}),n.d(t,"DwellTime",function(){return O}),n.d(t,"DwellTimeSignalType",function(){return a}),n.d(t,"DwellTimeTelemetry",function(){return x});var a,i,r=n("17wl"),s=n("mVz8"),o=n("O88D"),l=n("csrF"),c=n("gHZK"),d=n("2xT9"),u=n("68aR"),g=n.n(u),v=n("q/yJ"),_=n.n(v),I=n("rmH8"),T=n.n(I),m=n("wQUy"),f={method:"POST",noRedirect:!0},p=T.a.isFeatureEnabled({ODB:379}),E=function(e){function t(t,n){var a=e.call(this,{dataSourceName:"PageActivities"},{pageContext:t})||this;return p&&n?a._getToken=n:(a._tokenProvider=new l.a(null,{oAuthTokenDataSource:new c.a(t)}),a._getToken=function(e,t){return a._tokenProvider.getToken(e,t)}),a}return Object(r.__extends)(t,e),t.prototype.postPageActivities=function(e){var t=this,n=this._getBaseUrl(),a=new m.Qos({name:"dwellFetchToken"});return this._getToken(Object(d.d)(this._pageContext)).then(function(i){a.end({resultType:m.ResultTypeEnum.Success});var s=new m.Qos({name:"sendPageActivitiesSync"}),o=n+"/pages/oneDrive.sendActivities",l={value:e},c=t.dataRequestor.getData(Object(r.__assign)({url:o,authToken:i,qosName:"sendPageActivities",additionalPostData:JSON.stringify(l),additionalHeaders:{accept:"application/json"}},f));return s.end({resultType:m.ResultTypeEnum.Success}),c},function(e){return a.end({resultCode:e,resultType:m.ResultTypeEnum.Failure}),e})},t.prototype._getBaseUrl=function(e){var t=this._getAPIBaseUrl(e);return t+"/sites/"+new _.a(t).getAuthority()+","+g.a.normalizeLower(this._pageContext.siteId,!1)+","+g.a.normalizeLower(this._pageContext.webId,!1)},t.prototype._getAPIBaseUrl=function(e){return Object(d.d)(this._pageContext)+"/_api/v"+(e||"2.1")},t}(o.b),D=T.a.isFeatureEnabled({ODB:1794}),w=T.a.isFeatureEnabled({ODB:1795}),S=T.a.isFeatureEnabled({ODB:1797}),h=T.a.isFeatureEnabled({ODB:1694}),L=T.a.isFeatureEnabled({ODB:1361}),y=T.a.isFeatureEnabled({ODB:1727}),P=T.a.isFeatureEnabled({ODB:1782}),b=T.a.isFeatureEnabled({ODB:1899});!function(e){e.PageActivities="PageActivities"}(a||(a={})),function(e){e.HomePage="HomePage",e.ArticlePage="ArticlePage",e.ModernPage="ModernPage",e.ClassicPage="ClassicPage",e.NewsPage="NewsPage",e.NewsDigestPage="NewsDigestPage",e.Space="Space"}(i||(i={}));var M,x=function(){function e(){}return e.initialize=function(t,n,a,i){var r=new m.Qos({name:"DwellTimeTelemetryInitialization"});if(e.sessionId=t,e.initializationTimestamp=e.initializationTimestamp||Date.now(),e.initializeLocalStorage=!0,e.ariaKeyPrefix=n,a){e.pageContext=a,e.PageActivitiesDatSource=new E(a,i);try{var s=a.systemUserKey;if(s){var o=s.lastIndexOf("|")+1,l=-1===s.indexOf("@")?s.length:s.indexOf("@");e.userId=s.substring(o,l)}}catch(t){e._handleException(t&&t.message)}}this.sendEvents(),this._initializeForDiffIntervals("DWELL_TIME","LAST_DWELL_TIME_SENT"),D&&(this._initializeForDiffIntervals("DWELL_TIME_10_SEC","LAST_DWELL_TIME_SENT_10_SEC"),this._initializeForDiffIntervals("DWELL_TIME_1_MIN","LAST_DWELL_TIME_SENT_1_MIN"),this._initializeForDiffIntervals("DWELL_TIME_2_MIN","LAST_DWELL_TIME_SENT_2_MIN"),this._initializeForDiffIntervals("DWELL_TIME_3_MIN","LAST_DWELL_TIME_SENT_3_MIN")),w&&this._initializeForDiffIntervals("DWELL_TIME_30_SEC","LAST_DWELL_TIME_SENT_30_SEC"),e.initializeLocalStorage=!1,b&&e._isIncognitoBrowser().then(function(t){e.isIncognitoBrowser=t}),r.end({resultType:m.ResultTypeEnum.Success})},e.bufferDwellTimeIntervals=function(){this._bufferDwellTimeIntervalsForDiffIntervals("DWELL_TIME","LAST_DWELL_TIME_SENT",3e5),D&&(this._bufferDwellTimeIntervalsForDiffIntervals("DWELL_TIME_10_SEC","LAST_DWELL_TIME_SENT_10_SEC",1e4),this._bufferDwellTimeIntervalsForDiffIntervals("DWELL_TIME_1_MIN","LAST_DWELL_TIME_SENT_1_MIN",6e4),this._bufferDwellTimeIntervalsForDiffIntervals("DWELL_TIME_2_MIN","LAST_DWELL_TIME_SENT_2_MIN",12e4),this._bufferDwellTimeIntervalsForDiffIntervals("DWELL_TIME_3_MIN","LAST_DWELL_TIME_SENT_3_MIN",18e4)),w&&this._bufferDwellTimeIntervalsForDiffIntervals("DWELL_TIME_30_SEC","LAST_DWELL_TIME_SENT_30_SEC",3e4)},e.sendEvents=function(){this._sendEventsForDiffIntervals("DWELL_TIME","LAST_DWELL_TIME_SENT",3e5),D&&(this._sendEventsForDiffIntervals("DWELL_TIME_10_SEC","LAST_DWELL_TIME_SENT_10_SEC",1e4),this._sendEventsForDiffIntervals("DWELL_TIME_1_MIN","LAST_DWELL_TIME_SENT_1_MIN",6e4),this._sendEventsForDiffIntervals("DWELL_TIME_2_MIN","LAST_DWELL_TIME_SENT_2_MIN",12e4),this._sendEventsForDiffIntervals("DWELL_TIME_3_MIN","LAST_DWELL_TIME_SENT_3_MIN",18e4)),w&&this._sendEventsForDiffIntervals("DWELL_TIME_30_SEC","LAST_DWELL_TIME_SENT_30_SEC",3e4)},e.logInitialPageLoadEvent=function(t){t&&s.Engagement.withContext(e._getAriaEventContext(e.sessionId,t.extraPageData)).logData({name:"DwellTime_InitialPageLoad",currentPage:t.pageId,extraData:{pageType:t.pageType,dwellLibVersion:2,uniqueKeyIdentifier:e._getUniqueKeyIdentifier(e.sessionId,e.initializationTimestamp,t.pageId),incognitoBrowser:e.isIncognitoBrowser,sessionInitTime:e.initializationTimestamp,startTime:performance.now()}})},e._getPageActivity=function(e,t,n,a){var i=t.page.extraPageData,r=n&&n[n.length-1].stop||0;return{sharepointIds:{siteId:i&&i.siteId&&i.siteId.toString()||"",webId:i&&i.webId&&i.webId.toString()||"",listId:i&&i.listId&&i.listId.toString()||"",listItemUniqueId:t.page.pageId},webTemplateId:i&&i.webTemplateId&&i.webTemplateId.toString()||"",operation:"PageActivities",pageType:t.page.pageType||"",totalDwellTimeMs:O.calculateTotalDwellTimeFromIntervals(n),totalTimeMs:O.calculateTotalTimeFromIntervals(n),dwellFrequency:n&&n.length||0,pageReadPercentage:t.page.percentageRead,clientSessionId:e,pageMode:a,lastActivityDateTime:new Date(r).toISOString()}},e._sendAriaEvent=function(t,n,i,r,o,l){var c=n.page.extraPageData,d=i&&i[i.length-1].stop||0;s.Engagement.withContext(e._getAriaEventContext(t,n.page&&c)).logData({name:e.ariaKeyPrefix+a.PageActivities+o,currentPage:n.page.pageId,extraData:{intervals:JSON.stringify(i),totalDwellTime:O.calculateTotalDwellTimeFromIntervals(i),pageType:n.page.pageType,pageReadPercentage:n.page.percentageRead,totalTime:O.calculateTotalTimeFromIntervals(i),dwellFrequency:i&&i.length||0,pageMode:r,lastActivityDateTime:d?new Date(d).toISOString():"",dwellLibVersion:2,uniqueKeyIdentifier:e._getUniqueKeyIdentifier(t,l,n.page.pageId),incognitoBrowser:e.isIncognitoBrowser,sessionInitTime:l}})},e._getAriaEventContext=function(e,t){var n={"AppInfo.Session":e};return t&&(t.siteId&&(n.SiteId=t.siteId.toString()),t.webId&&(n.WebId=t.webId.toString()),t.webTemplateId&&(n.WebTemplateId=t.webTemplateId.toString()),t.listId&&(n.ListId=t.listId.toString())),n},e._validateStorgeSizeAndCleanup=function(t,n,a){var i=localStorage.getItem(t);i&&2*i.length>=51200&&e._sendEventsForDiffIntervals(t,n,a,!0)},e._initializeForDiffIntervals=function(t,n){var a=new m.Qos({name:"DwellLocalStorageSet"+t});if(!e.initializeLocalStorage&&!localStorage.getItem(t)){var i=O.getDwellTimeSettings()&&O.getDwellTimeSettings().page&&O.getDwellTimeSettings().page.pageId;s.Engagement.logData({name:"Dwell_Time_LocalStorage_Cleared",currentPage:i,extraData:{key:t,dwellLibVersion:2,uniqueKeyIdentifier:e._getUniqueKeyIdentifier(e.sessionId,e.initializationTimestamp,i),incognitoBrowser:e.isIncognitoBrowser,sessionInitTime:e.initializationTimestamp}})}var r=localStorage.getItem(t)||"{}",o=JSON.parse(r);o[e.sessionId]||(o[e.sessionId]={},o[e.sessionId].initializationTimestamp=e.initializationTimestamp,e._localStorageSetItem(t,JSON.stringify(o))),localStorage.getItem(n)||e._localStorageSetItem(n,Date.now().toString()),a.end({resultType:m.ResultTypeEnum.Success})},e._bufferDwellTimeIntervalsForDiffIntervals=function(t,n,a,i){e._validateStorgeSizeAndCleanup(t,n,a),e._initializeForDiffIntervals(t,n);var r=localStorage.getItem(t);if(r){var s=JSON.parse(r);s[e.sessionId][O.getPageId()]||(s[e.sessionId][O.getPageId()]={readIntervals:[],editIntervals:[],page:O.getDwellTimeSettings().page});var o=s[e.sessionId][O.getPageId()].percentageRead;o&&O.getPageReadPercentage()>o&&(s[e.sessionId][O.getPageId()].percentageRead=O.getPageReadPercentage()),O.isEditMode()?Array.prototype.push.apply(s[e.sessionId][O.getPageId()].editIntervals,O.getDwellTimeEditIntervals()):Array.prototype.push.apply(s[e.sessionId][O.getPageId()].readIntervals,O.getDwellTimeReadIntervals()),e._localStorageSetItem(t,JSON.stringify(s))||i||(e._sendEventsForDiffIntervals(t,n,a,!0),e._bufferDwellTimeIntervalsForDiffIntervals(t,n,a,!0))}},e._sendEventsForDiffIntervals=function(t,n,a,i){var r=new m.Qos({name:"DwellSendEvents"+t}),s=localStorage.getItem(n);if(Date.now()-(s?parseInt(s,10):0)>a||i){var o=localStorage.getItem(t);if(o){this._sendStorageSizeEvent(a,o);var l=JSON.parse(o),c=[],d=e.pageContext&&3e5===a;for(var u in l)if(l.hasOwnProperty(u)){var g=l[u];if(g){var v=g.initializationTimestamp;for(var _ in g)if(g.hasOwnProperty(_)&&"initializationTimestamp"!==_){var I=g[_],T=I.page.pageType;if(this._isAriaEnabled(T)){var f=3e5===a?"":"."+a/1e3+"s";I.editIntervals&&I.editIntervals.length>0&&e._sendAriaEvent(u,I,I.editIntervals,M.EDIT,f,v),I.readIntervals&&I.readIntervals.length>0&&e._sendAriaEvent(u,I,I.readIntervals,M.READ,f,v)}d&&this._isSPOEnabled(T)&&(I.editIntervals&&I.editIntervals.length>0&&c.push(e._getPageActivity(u,I,I.editIntervals,M.EDIT)),I.readIntervals&&I.readIntervals.length>0&&c.push(e._getPageActivity(u,I,I.readIntervals,M.READ)))}}}c.length>0&&e.PageActivitiesDatSource.postPageActivities(c)}e._localStorageSetItem(t,"{}"),e._localStorageSetItem(n,Date.now().toString())}r.end({resultType:m.ResultTypeEnum.Success})},e._sendStorageSizeEvent=function(t,n){if(S&&3e5===t){var a=2*n.length,i=O.getDwellTimeSettings()&&O.getDwellTimeSettings().page&&O.getDwellTimeSettings().page.pageId;s.Engagement.logData({name:"Dwell_Storage_Size",currentPage:i,extraData:{storageSize:a,dwellLibVersion:2,uniqueKeyIdentifier:e._getUniqueKeyIdentifier(e.sessionId,e.initializationTimestamp,i),incognitoBrowser:e.isIncognitoBrowser,sessionInitTime:e.initializationTimestamp}})}},e._isAriaEnabled=function(e){switch(e){case i.NewsPage:case i.HomePage:return h;case i.ArticlePage:return y;default:return!1}},e._isSPOEnabled=function(e){switch(e){case i.NewsPage:case i.HomePage:return L;case i.ArticlePage:return P;default:return!1}},e._localStorageSetItem=function(t,n){try{return localStorage.setItem(t,n),!0}catch(c){var a=2*n.length/1024,i=e._getLocalStorageSize(),r=O.getDwellTimeSettings()&&O.getDwellTimeSettings().page,o=r&&r.extraPageData,l=r&&r.pageId;return s.Engagement.withContext(e._getAriaEventContext(e.sessionId,o)).logData({name:"Dwell_Time_SetItem_Failed",currentPage:l,extraData:{key:t,dwellKeySize:a,localStorageSize:i,message:c&&c.message,dwellLibVersion:2,uniqueKeyIdentifier:e._getUniqueKeyIdentifier(e.sessionId,e.initializationTimestamp,l),incognitoBrowser:e.isIncognitoBrowser,sessionInitTime:e.initializationTimestamp}}),!1}},e._getLocalStorageSize=function(){var e="";for(var t in window.localStorage)window.localStorage.hasOwnProperty(t)&&(e+=t+window.localStorage[t]);return e?2*e.length/1024:0},e._getUniqueKeyIdentifier=function(t,n,a){var i=t;return e.userId&&(i=i+"_"+e.userId),n&&(i=i+"_"+n),a&&(i=i+"_"+a),i},e._isIncognitoBrowser=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return"storage"in navigator&&"estimate"in navigator.storage?[4,navigator.storage.estimate()]:[3,2];case 1:return void 0!==(e=t.sent().quota)&&e<12e7?[2,!0]:[2,!1];case 2:return[2,!1];case 3:return[2]}})})},e._handleException=function(t){var n=O.getDwellTimeSettings()&&O.getDwellTimeSettings().page,a=n&&n.extraPageData,i=n&&n.pageId;s.Engagement.withContext(e._getAriaEventContext(e.sessionId,a)).logData({name:"Dwell_Time_Exception",currentPage:i,extraData:{message:t,dwellLibVersion:2,uniqueKeyIdentifier:e._getUniqueKeyIdentifier(e.sessionId,e.initializationTimestamp,i),incognitoBrowser:e.isIncognitoBrowser,sessionInitTime:e.initializationTimestamp}})},e}(),A=n("P1BV"),C=T.a.isFeatureEnabled({ODB:674});!function(e){e.READ="READ",e.EDIT="EDIT"}(M||(M={}));var R=["scroll","resize"],N=["keyup","keydown","touchstart","click","contextmenu"],O=function(){function e(){}return e.initialize=function(t){var n=new m.Qos({name:"DwellTimeLibraryInitialization"});e.reset(),e.running=!1,e.pageReadPercentage=0,e.idle=!1,e.readIntervals=[],e.editIntervals=[],e.currentIdleTimeMs=0,e.dwellTimeSettings=t,e.mouseInactiveTime=t.mouseInactiveTime||3e4,e.checkCallbacksIntervalMs=100,e.totalEditDwellTime=0,e.totalReadDwellTime=0,e.historyPushState=history.pushState,e.historyReplaceState=history.replaceState,e.extraPageData=t.page.extraPageData,e._registerEventListeners(),e.startTimer(),x.logInitialPageLoadEvent(t.page),n.end({resultType:m.ResultTypeEnum.Success})},e.isRunning=function(){return this.running},e.startTimer=function(){e.checkCallbackIntervalId||e._checkCallbacksOnInterval();var t=e._getIntervals(),n=t[t.length-1];n&&null===n.stop||(t.push({start:Date.now(),stop:null}),e.running=!0)},e.stopTimer=function(){var t=e._getIntervals();t.length&&(t[t.length-1].stop=Date.now(),e.running=!1,(e.dwellTimeSettings.sendAriaEvents||e.dwellTimeSettings.sendSPOEvents)&&(x.bufferDwellTimeIntervals(),e._updateTotalEditDwellTime(),e._updateTotalReadDwellTime(),e.readIntervals=[],e.editIntervals=[],x.sendEvents()))},e.getTimeInMilliseconds=function(){return e.getEditDwellTimeInMilliseconds()+e.getReadDwellTimeInMilliseconds()},e.getEditDwellTimeInMilliseconds=function(){return e.totalEditDwellTime+e.calculateTotalDwellTimeFromIntervals(e.editIntervals)},e.getReadDwellTimeInMilliseconds=function(){return e.totalReadDwellTime+e.calculateTotalDwellTimeFromIntervals(e.readIntervals)},e.calculateTotalDwellTimeFromIntervals=function(e){return e.length>0?e.reduce(function(e,t){return t.stop?e+=t.stop-t.start:e+=Date.now()-t.start,e},0):0},e.calculateTotalTimeFromIntervals=function(e){if(e&&e.length>0){var t=e[e.length-1],n=e[0];if(t.stop)return t.stop-n.start}return 0},e.getTimeInSeconds=function(t){return t?Number((e.getTimeInMilliseconds()/1e3).toFixed(t)):e.getTimeInMilliseconds()/1e3},e.isEditMode=function(){return!e.isEditDwellTimeKSActivated()&&Boolean(e.extraPageData&&e.extraPageData.pageMode&&e.extraPageData.pageMode===M.EDIT)},e.getDwellTimeEditIntervals=function(){return e.editIntervals},e.reset=function(){e.isRunning()&&e.stopTimer(),e.readIntervals=[],e.editIntervals=[],e._destroy()},e.getDwellTimeReadIntervals=function(){return e.readIntervals},e.getPageId=function(){return e.dwellTimeSettings.page.pageId},e.getPageReadPercentage=function(){return e.pageReadPercentage},e.getDwellTimeSettings=function(){return e.dwellTimeSettings},e.registerScrollListener=function(t){if(t){e.scrollDivClass=t;var n=document.getElementsByClassName(t);n&&n[0]&&(n[0].addEventListener("scroll",e._findPageReadPercentage,{passive:!0}),n[0].addEventListener("scroll",e._onBrowserTabInactive,{passive:!0}))}},e.updatePageMode=function(t){e.stopTimer(),e.extraPageData||(e.extraPageData={}),e.extraPageData.pageMode=t,e.startTimer()},e.isEditDwellTimeKSActivated=function(){return A.Killswitch.isActivated("87c86ec7-dbf9-4e8e-9999-49d980ed96fd","09/11/2019","Edit mode dwell time")},e._getIntervals=function(){return e.isEditMode()?e.editIntervals:e.readIntervals},e._updateTotalEditDwellTime=function(){e.totalEditDwellTime=e.getEditDwellTimeInMilliseconds()},e._updateTotalReadDwellTime=function(){e.totalReadDwellTime=e.getReadDwellTimeInMilliseconds()},e._onBrowserTabInactive=function(t){e.running&&e.stopTimer()},e._onBrowserTabActive=function(t){e.running||e.startTimer()},e._resetIdleTime=function(t){e.idle&&e.startTimer(),e.idle=!1,e.currentIdleTimeMs=0},e._resetIdleTimeWithStartTimer=function(t){e._resetIdleTime(t),e.running||e.startTimer()},e._registerEventListeners=function(){var t={passive:!0};window.addEventListener("blur",e._onBrowserTabInactive,t),window.addEventListener("focus",e._onBrowserTabActive,t),window.addEventListener("unload",e._onBrowserTabInactive,t),R.forEach(function(n){window.addEventListener(n,e._resetIdleTime,t)}),document.body.addEventListener("mouseleave",e._onBrowserTabInactive,t),document.addEventListener("mousemove",e._resetIdleTimeWithStartTimer,t),N.forEach(function(n){document.addEventListener(n,e._resetIdleTime,t)}),e._addLocationChangeListener()},e._dwellPushState=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=e.historyPushState.apply(history,t);if(e.isRunning()){var i=document.createEvent("Event");i.initEvent("locationChange",!0,!0),window.dispatchEvent(i)}return a},e._dwellReplaceState=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var a=e.historyReplaceState.apply(history,t);if(e.isRunning()){var i=document.createEvent("Event");i.initEvent("locationChange",!0,!0),window.dispatchEvent(i)}return a},e._addLocationChangeListener=function(){var t={passive:!0};C&&(history.pushState=e._dwellPushState,history.replaceState=e._dwellReplaceState),window.addEventListener("popstate",e._onBrowserTabInactive,t),window.addEventListener("locationChange",e._onBrowserTabInactive,t)},e._checkCallbacksOnInterval=function(){e.checkCallbackIntervalId=window.setInterval(function(){e.currentIdleTimeMs>=e.mouseInactiveTime&&e.running?(e.idle=!0,e.stopTimer()):e.currentIdleTimeMs+=e.checkCallbacksIntervalMs},e.checkCallbacksIntervalMs)},e._destroy=function(){e._unregisterEventListeners(),e.checkCallbackIntervalId&&(window.clearInterval(e.checkCallbackIntervalId),e.checkCallbackIntervalId=0),C&&e.historyPushState&&e.historyReplaceState&&(history.pushState===e._dwellPushState&&(history.pushState=e.historyPushState),history.replaceState===e._dwellReplaceState&&(history.replaceState=e.historyReplaceState))},e._unregisterEventListeners=function(){if(window.removeEventListener("blur",e._onBrowserTabInactive),window.removeEventListener("popstate",e._onBrowserTabInactive),window.removeEventListener("locationChange",e._onBrowserTabInactive),window.removeEventListener("unload",e._onBrowserTabInactive),window.removeEventListener("focus",e._onBrowserTabActive),R.forEach(function(t){window.removeEventListener(t,e._resetIdleTime)}),document.body.removeEventListener("mouseleave",e._onBrowserTabInactive),document.removeEventListener("mousemove",e._resetIdleTimeWithStartTimer),N.forEach(function(t){document.removeEventListener(t,e._resetIdleTime)}),e.scrollDivClass){var t=document.getElementsByClassName(e.scrollDivClass);t&&t[0]&&(t[0].removeEventListener("scroll",e._findPageReadPercentage),t[0].removeEventListener("scroll",e._onBrowserTabInactive))}},e._findPageReadPercentage=function(t){var n=t.target,a=n.clientHeight,i=n.scrollHeight-a,r=n.scrollTop;if(0===r&&0===i)return 100;var s=Math.floor(r/i*100);return s>e.pageReadPercentage&&(e.pageReadPercentage=s),s},e}()},O88D:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var a,i=n("17wl"),r=n("gcRq"),s=n.n(r),o=n("extd"),l=n.n(o),c=n("uN8c"),d=n("4xRo"),u=n.n(d),g=n("cJM/"),v=(a=function(e){return u.a.isFeatureEnabled(e)},Object(g.b)(a)?n.e(94).then(n.bind(null,"VfMv")).then(function(e){return function(t){return e.getDataSyncClient(t,a)}}):Promise.resolve(function(e){}));function _(e){var t=e.options,n=t.url,a=t.authToken,r=t.telemetryHandler,o=t.useExactAuthToken,l=e.dataSyncClient,d=e.aadUserId,u=e.getData,g=function(){return u({url:n,telemetryHandler:r,authToken:a,useExactAuthToken:o})};return d?s.a.resolve(l).then(function(e){return e||v.then(function(e){return e(d)})}).then(function(e){return e?function(e){var t=function(e,t){return function(n,a){var r=n.eventData,s=r.extraData,o={performanceEntry:s&&s.performanceEntry,httpStatus:s&&s.HttpStatus,correlationId:s&&s.CorrelationId,succeeded:r&&r.resultType===c.ResultTypeEnum.Success||!1,resultCode:r&&r.resultCode,endpoint:a},l=t&&t(n),d=e.onRequestComplete(o);return s.dataSyncQos=e.getQosInfo(),Object(i.__assign)(Object(i.__assign)({},l||{}),{eventData:Object(i.__assign)(Object(i.__assign)({},l?l.eventData:r),{extraData:Object(i.__assign)(Object(i.__assign)({},l?l.eventData.extraData:r.extraData),e.getQosInfo())}),canRetry:d&&(!l||l.canRetry)})}}(e,r);return e.getData({url:n},function(e){return u({url:e.url,authToken:e.authToken,telemetryHandler:function(n){return t(n,e)},useExactAuthToken:!0})},g)}(e):g()}):g()}var I=n("P1BV"),T=function(){var e=function(e){return u.a.isFeatureEnabled(e)};return Object(g.b)(e)?n.e(94).then(n.bind(null,"VfMv")).then(function(t){return function(n){return t.getDataSyncClient(n,e)}}):s.a.resolve(function(e){})}(),m=function(){function e(e,t){var n=this._pageContext=t.pageContext,a=t.tokenProvider,r=t.dataRequestorType,o=void 0===r?function(e){function t(t){return e.call(this,t,Object(i.__assign)({pageContext:n,tokenProvider:a},Object(I.getKillSwitch)(n).isActivated("68FFDA86-24A1-4A87-A304-0B53C0058679","11/5/2020","Factor Nucleus support into DataRequestor plugin")?{}:{dataSyncClient:s.a.resolve(c),getDataWithSyncClient:_}))||this}return Object(i.__extends)(t,e),t}(l.a):r,c=t.dataSyncClient,d=e.dataSourceName,u=void 0===d?"DataSource":d;this.dataSyncClient=c,this.dataRequestor=new o({qosName:u})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,l,c,d,u,g,v,_){var m=this;void 0===i&&(i="POST");var f=e(),p=a&&a(),E=this.needsRequestDigest(f);if(!Object(I.getKillSwitch)(this._pageContext).isActivated("68FFDA86-24A1-4A87-A304-0B53C0058679","11/5/2020","Factor Nucleus support into DataRequestor plugin"))return this.dataRequestor.getData({url:f,parseResponse:t,qosName:n,additionalPostData:p,method:i,additionalHeaders:r,contentType:l,maxRetries:c,noRedirect:d,crossSiteCollectionCall:u,telemetryHandler:g,qosExtraData:v,needsRequestDigest:E,authToken:_});var D=function(){return m.dataRequestor.getData({url:f,parseResponse:t,qosName:n,additionalPostData:p,method:i,additionalHeaders:r,contentType:l,maxRetries:c,noRedirect:d,crossSiteCollectionCall:u,telemetryHandler:g,qosExtraData:v,needsRequestDigest:m.needsRequestDigest(f),authToken:_})};if(!this._pageContext.aadUserId)return D();var w=function(e){var a=Object(o.getSyncTelemetryHandler)(e,g);return e.getData({url:f},function(e){return m.dataRequestor.getData({url:e.url,authToken:e.authToken,parseResponse:t,qosName:n,additionalPostData:p,method:i,additionalHeaders:r,contentType:l,maxRetries:c,noRedirect:d,crossSiteCollectionCall:u,telemetryHandler:function(t){return a(t,e)},qosExtraData:v,needsRequestDigest:m.needsRequestDigest(e.url),useExactAuthToken:!0})},D)};return this.dataSyncClient?s.a.wrap(w(this.dataSyncClient)):s.a.wrap(T).then(function(e){var t=e(m._pageContext.aadUserId);return t?w(t):D()})},e}();t.b=m},"cJM/":function(e,t,n){"use strict";var a;n.d(t,"a",function(){return r}),n.d(t,"b",function(){return s}),function(e){e.SharePointList="SharePointList"}(a||(a={}));var i={ODB:1620},r={ODB:60063};function s(e,t){return e(i)&&(window.localStorage&&"true"===window.localStorage.NucleusPreviewEnabled||/[?&]enableNucleusPreview=true/.test(location.search))}},extd:function(e,t,n){var a=n("K9kD");for(var i in e.exports={},a)a.hasOwnProperty(i)&&(e.exports[i]=a[i]);e.exports.default=a.DataRequestor,Object.defineProperty(e.exports,"__esModule",{value:!0})},gcRq:function(e,t,n){var a=n("K9kD");for(var i in e.exports={},a)a.hasOwnProperty(i)&&(e.exports[i]=a[i]);e.exports.default=a.Promise,Object.defineProperty(e.exports,"__esModule",{value:!0})},"q/yJ":function(e,t,n){var a=n("K9kD");for(var i in e.exports={},a)a.hasOwnProperty(i)&&(e.exports[i]=a[i]);e.exports.default=a.Uri,Object.defineProperty(e.exports,"__esModule",{value:!0})},uN8c:function(e,t,n){var a=n("K9kD");for(var i in e.exports={},a)a.hasOwnProperty(i)&&(e.exports[i]=a[i]);e.exports.default=a.Qos,Object.defineProperty(e.exports,"__esModule",{value:!0})}}]);