(window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0=window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0||[]).push([[6],{"+ky/":function(e,t,n){"use strict";n.d(t,"a",function(){return P});var o=n("J7xF"),i=n("17wl"),r=n("cDcd"),a=n("yCth"),s=n("fj7e"),c=n("4xRo"),u=n.n(c),l=n("P1BV"),d=n("mVz8"),p=n("qIay"),h=n("q/yJ"),g=n.n(h),m=n("3ufC"),f=n("S7CW"),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"_containerMaxWidth",{get:function(){var e=this.props.columnWidth||300;return void 0!==this.props.maxColumnCount?e*this.props.maxColumnCount+"px":void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_containerFixedWidth",{get:function(){var e=this.props.columnWidth||300,t=this.props.gridSpacingFromEdge?window.innerWidth-2*this.props.gridSpacingFromEdge:window.innerWidth,n=this.props.children.length,o=this.props.maxColumnCount?Math.min(this.props.maxColumnCount,Math.floor(t/e)):Math.floor(t/e);return Math.min(o,n)*e+"px"},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.children,n=e.columnWidth||300,i={maxWidth:this._isMaxWidthKSActive()||!this._isEnhancedMegaMenuFlightEnabled()?this._containerMaxWidth||"auto":void 0,width:!this._isMaxWidthKSActive()&&this._isEnhancedMegaMenuFlightEnabled()&&this.props.enforceGridWidth?this._containerFixedWidth:void 0,backgroundSize:n+1};return r.createElement("div",{className:Object(o.css)("ms-MegaMenu-gridLayout",{withDivider:e.showDivider,"ms-MegaMenu-gridLayout-enhanced":this._isEnhancedMegaMenuFlightEnabled(),"ms-MegaMenu-gridLayout-noBottomPadding":Object(f.b)()&&!this._isEnhancedMegaMenuFlightEnabled()}),style:i},t.map(function(e,t){return r.createElement("div",{className:"ms-MegaMenu-gridLayoutItem",key:"gridLayoutItem"+t,style:{width:n},"data-is-focusable":"true"},e)}))},t.prototype._isEnhancedMegaMenuFlightEnabled=function(){return u.a.isFeatureEnabled({ODB:1811})},t.prototype._isMaxWidthKSActive=function(){return l.Killswitch.isActivated("1d9f71f7-9bc4-471c-a23b-e29524adac78","4/9/2020","Take browser window size into consideration when calculating MegaMenu max width")},t}(o.BaseComponent),v=n("qqkQ"),b=n("mcHn"),y=Object(o.memoizeFunction)(function(e){return Object(b.mergeStyleSets)({wrapper:{display:"inline-flex",height:"100%",alignItems:"center"},divider:{width:1,height:"100%",backgroundColor:e.palette.neutralTertiaryAlt}})}),k=Object(b.getScreenSelector)(0,b.ScreenWidthMaxMedium),x=Object(o.memoizeFunction)(function(){var e;return{selectors:(e={},e[b.HighContrastSelector]={backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText",MsHighContrastAdjust:"none"},e)}}),S=Object(o.memoizeFunction)(function(e){var t,n,o,r,a,s,c,u=e.semanticColors,l=e.fonts,d=e.palette,p=u.menuItemBackgroundHovered,h=u.menuItemTextHovered,g=u.menuItemBackgroundPressed,m=u.bodyDivider,f={item:[l.medium,{color:u.bodyText,position:"relative",boxSizing:"border-box"}],divider:{display:"block",height:"1px",backgroundColor:m,position:"relative"},root:[Object(b.getFocusStyle)(e),l.medium,{color:u.bodyText,backgroundColor:"transparent",border:"none",width:"100%",height:36,lineHeight:36,display:"block",cursor:"pointer",padding:"0px 8px 0 4px",textAlign:"left"}],rootDisabled:{color:u.disabledBodyText,cursor:"default",pointerEvents:"none",selectors:Object(i.__assign)((t={},t[b.HighContrastSelector]={color:"GrayText",opacity:1},t),Object(b.getEdgeChromiumNoHighContrastAdjustSelector)())},rootHovered:Object(i.__assign)({backgroundColor:p,color:h,selectors:{".ms-ContextualMenu-icon":{color:d.themeDarkAlt},".ms-ContextualMenu-submenuIcon":{color:d.neutralPrimary}}},x()),rootFocused:Object(i.__assign)({backgroundColor:d.white},x()),rootChecked:Object(i.__assign)({selectors:{".ms-ContextualMenu-checkmarkIcon":{color:d.neutralPrimary}}},x()),rootPressed:Object(i.__assign)({backgroundColor:g,selectors:{".ms-ContextualMenu-icon":{color:d.themeDark},".ms-ContextualMenu-submenuIcon":{color:d.neutralPrimary}}},x()),rootExpanded:Object(i.__assign)({backgroundColor:g,color:u.bodyTextChecked},x()),linkContent:{whiteSpace:"nowrap",height:"inherit",display:"flex",alignItems:"center",maxWidth:"100%"},anchorLink:{padding:"0px 8px 0 4px",textRendering:"auto",color:"inherit",letterSpacing:"normal",wordSpacing:"normal",textTransform:"none",textIndent:"0px",textShadow:"none",textDecoration:"none",boxSizing:"border-box"},label:{margin:"0 4px",verticalAlign:"middle",display:"inline-block",flexGrow:"1",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},secondaryText:{color:e.palette.neutralSecondary,paddingLeft:"20px",textAlign:"right"},icon:{display:"inline-block",minHeight:"1px",maxHeight:36,fontSize:b.IconFontSizes.medium,width:b.IconFontSizes.medium,margin:"0 4px",verticalAlign:"middle",flexShrink:"0",selectors:(n={},n[k]={fontSize:b.IconFontSizes.large,width:b.IconFontSizes.large},n)},iconColor:{color:u.menuIcon,selectors:(o={},o[b.HighContrastSelector]={color:"inherit"},o["$root:hover &"]={selectors:(r={},r[b.HighContrastSelector]={color:"HighlightText"},r)},o["$root:focus &"]={selectors:(a={},a[b.HighContrastSelector]={color:"HighlightText"},a)},o)},iconDisabled:{color:u.disabledBodyText},checkmarkIcon:{color:u.bodySubtext,selectors:(s={},s[b.HighContrastSelector]={color:"HighlightText"},s)},subMenuIcon:{height:36,lineHeight:36,color:d.neutralSecondary,textAlign:"center",display:"inline-block",verticalAlign:"middle",flexShrink:"0",fontSize:b.IconFontSizes.small,selectors:(c={":hover":{color:d.neutralPrimary},":active":{color:d.neutralPrimary}},c[k]={fontSize:b.IconFontSizes.medium},c[b.HighContrastSelector]={color:"HighlightText"},c)},splitButtonFlexContainer:[Object(b.getFocusStyle)(e),{display:"flex",height:36,flexWrap:"nowrap",justifyContent:"center",alignItems:"flex-start"}]};return Object(b.concatStyleSets)(f)}),w=Object(b.getScreenSelector)(0,b.ScreenWidthMaxMedium),C=(Object(o.memoizeFunction)(function(e){var t;return Object(b.mergeStyleSets)(y(e),{wrapper:{position:"absolute",right:28,selectors:(t={},t[w]={right:32},t)},divider:{height:16,width:1}})}),{item:"ms-ContextualMenu-item",divider:"ms-ContextualMenu-divider",root:"ms-ContextualMenu-link",isChecked:"is-checked",isExpanded:"is-expanded",isDisabled:"is-disabled",linkContent:"ms-ContextualMenu-linkContent",linkContentMenu:"ms-ContextualMenu-linkContent",icon:"ms-ContextualMenu-icon",iconColor:"ms-ContextualMenu-iconColor",checkmarkIcon:"ms-ContextualMenu-checkmarkIcon",subMenuIcon:"ms-ContextualMenu-submenuIcon",label:"ms-ContextualMenu-itemText",secondaryText:"ms-ContextualMenu-secondaryText",splitMenu:"ms-ContextualMenu-splitMenu",screenReaderText:"ms-ContextualMenu-screenReaderText"}),O=Object(o.memoizeFunction)(function(e,t,n,i,r,a,s,c,u,l,d,p){var h,g,m,f,_=S(e),v=Object(b.getGlobalClassNames)(C,e);return Object(b.mergeStyleSets)({item:[v.item,_.item,s],divider:[v.divider,_.divider,c],root:[v.root,_.root,i&&[v.isChecked,_.rootChecked],r&&_.anchorLink,n&&[v.isExpanded,_.rootExpanded],t&&[v.isDisabled,_.rootDisabled],!t&&!n&&[{selectors:(h={":hover":_.rootHovered,":active":_.rootPressed},h["."+o.IsFocusVisibleClassName+" &:focus, ."+o.IsFocusVisibleClassName+" &:focus:hover"]=_.rootFocused,h["."+o.IsFocusVisibleClassName+" &:hover"]={background:"inherit;"},h)}],p],splitPrimary:[_.root,{width:"calc(100% - 28px)"},i&&["is-checked",_.rootChecked],(t||d)&&["is-disabled",_.rootDisabled],!(t||d)&&!i&&[{selectors:(g={":hover":_.rootHovered},g[":hover ~ ."+v.splitMenu]=_.rootHovered,g[":active"]=_.rootPressed,g["."+o.IsFocusVisibleClassName+" &:focus, ."+o.IsFocusVisibleClassName+" &:focus:hover"]=_.rootFocused,g["."+o.IsFocusVisibleClassName+" &:hover"]={background:"inherit;"},g)}]],splitMenu:[v.splitMenu,_.root,{flexBasis:"0",padding:"0 8px",minWidth:"28px"},n&&["is-expanded",_.rootExpanded],t&&["is-disabled",_.rootDisabled],!t&&!n&&[{selectors:(m={":hover":_.rootHovered,":active":_.rootPressed},m["."+o.IsFocusVisibleClassName+" &:focus, ."+o.IsFocusVisibleClassName+" &:focus:hover"]=_.rootFocused,m["."+o.IsFocusVisibleClassName+" &:hover"]={background:"inherit;"},m)}]],anchorLink:_.anchorLink,linkContent:[v.linkContent,_.linkContent],linkContentMenu:[v.linkContentMenu,_.linkContent,{justifyContent:"center"}],icon:[v.icon,a&&_.iconColor,_.icon,u,t&&[v.isDisabled,_.iconDisabled]],iconColor:_.iconColor,checkmarkIcon:[v.checkmarkIcon,a&&_.checkmarkIcon,_.icon,u],subMenuIcon:[v.subMenuIcon,_.subMenuIcon,l,n&&{color:e.palette.neutralPrimary},t&&[_.iconDisabled]],label:[v.label,_.label],secondaryText:[v.secondaryText,_.secondaryText],splitContainer:[_.splitButtonFlexContainer,!t&&!i&&[{selectors:(f={},f["."+o.IsFocusVisibleClassName+" &:focus, ."+o.IsFocusVisibleClassName+" &:focus:hover"]=_.rootFocused,f)}]],screenReaderText:[v.screenReaderText,_.screenReaderText,b.hiddenContentStyle,{visibility:"hidden"}]})}),D=function(e){var t=e.theme;return{section:{backgroundColor:t.semanticColors.bodyBackground,margin:"18px 24px",listStyleType:"none"},heading:{lineHeight:"1.41em",paddingBottom:"10px"},item:{lineHeight:"2.29em"},itemLink:{color:t.semanticColors.bodyText,textDecoration:"none",selectors:{":hover":{textDecoration:"underline"}}},itemLinkMenuHeading:{color:t.semanticColors.menuItemText,textDecoration:"none",selectors:{":hover":{textDecoration:"underline"}}}}},N=n("jOlS");Object(N.loadStyles)([{rawString:".ms-MegaMenu-gridLayout{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row wrap;flex-flow:row wrap;padding-bottom:12px}.ms-MegaMenu-gridLayout.withDivider{background-image:linear-gradient(to right, "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:" 1px, transparent 1px)}.ms-MegaMenu-gridLayout-enhanced{padding-bottom:24px}.ms-MegaMenu-gridLayout-noBottomPadding{padding-bottom:0px}.ms-MegaMenu-gridLayoutItem{width:300px}.ms-Menu-section{margin:24px;padding:0;background-color:transparent}.ms-Menu-section-enhanced{margin-bottom:0px}.ms-Menu-heading{font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:"},{theme:"largeFontWeight",defaultValue:"400"},{rawString:";font-weight:600;line-height:1.41em;padding-bottom:10px;margin:0 4px;color:"},{theme:"bodyText",defaultValue:"#323130"},{rawString:";white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.isFluent .ms-Menu-heading{font-weight:600}.ms-Menu-item{font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";line-height:36px}.isFluent .ms-Menu-item{line-height:19px;padding-bottom:8px}.ms-Menu-item:last-child{padding-bottom:0px}.ms-Menu-item .ms-ContextualMenu-itemText{color:"},{theme:"bodyText",defaultValue:"#323130"},{rawString:";width:244px}.ms-Menu-item .ms-Nav-link{-webkit-text-decoration-color:"},{theme:"bodyText",defaultValue:"#323130"},{rawString:";text-decoration-color:"},{theme:"bodyText",defaultValue:"#323130"},{rawString:";display:block}.ms-Menu-item .ms-Nav-link:focus{outline:-webkit-focus-ring-color auto 5px}.ms-MegaMenu-Callout{position:absolute;z-index:299;border:none;background-color:transparent;padding-top:12px;min-width:302px}.ms-MegaMenu-Callout-NoHover{margin-top:12px;position:absolute;z-index:299;border:none;background-color:"},{theme:"bodyBackground",defaultValue:"#ffffff"},{rawString:"}\n"}]);var E=n("zK8O"),L=function(e){function t(t){var n=e.call(this,t)||this;return n._root=Object(r.createRef)(),n._classNames=Object(o.classNamesFunction)()(D,{theme:n.props.theme}),n}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.shouldFocusOnMount&&Object(o.focusFirstChild)(this._root.current)},t.prototype.shouldComponentUpdate=function(e,t){return this.props.heading!==e.heading||this.props.items!==e.items},t.prototype.render=function(){var e=this;return r.createElement(m.FocusZone,{handleTabKey:m.FocusZoneTabbableElements.none,direction:m.FocusZoneDirection.vertical},r.createElement("ul",{className:Object(o.css)("ms-Menu-section",this._classNames.section,{"ms-Menu-section-enhanced":this._isEnhancedMegaMenuFlightEnabled()}),ref:this._root},r.createElement("h3",{className:Object(o.css)("ms-Menu-heading",this._classNames.heading),onMouseOver:this._onHeaderMouseOver.bind(this,this.props.heading.name)},this._renderMenuHeading(this.props.heading)),this.props.items&&this.props.items.map(function(t,n){var i=t.getItemClassNames||O,a=e._getIconProps(t),s=i(e.props.theme,!(!t.isDisabled&&!t.disabled),!1,!1,!!t.href,"None"!==a.iconName,t.className,t.itemType===v.ContextualMenuItemType.Divider?t.className:void 0,a.className,t.submenuIconProps?t.submenuIconProps.className:""),c=!!t.href&&"http://linkless.header/"!==t.href;return r.createElement("li",{className:Object(o.css)("ms-Menu-item",e._classNames.item),key:"megaMenuItem"+n},c?r.createElement("a",{className:Object(o.css)("ms-Nav-link",e._classNames.itemLink),href:t.href,target:t.target,onMouseOver:e._onItemMouseOver.bind(e,t.name),ref:function(n){n&&n.addEventListener("click",function(n){return e._itemOnClick(n,t)})},"data-navigationcomponent":Object(E.b)(e.props.navigationSource),"data-interception":e._isLinkPropagateKSActive()?void 0:"propagate"},r.createElement(v.ContextualMenuItem,{item:t,index:n,hasIcons:!1,classNames:s})):r.createElement("div",{onMouseOver:e._onItemMouseOver.bind(e,t.name)},r.createElement("span",{className:s.label},t.title||t.name)))})))},t.prototype._itemOnClick=function(e,t){var n=this.props.pageContext;d.Engagement.logData({name:this._getEngagementEventName(),extraData:{siteId:n&&n.siteId}}),t.onClick&&t.onClick(e,t),!this._isLinkPropagateKSActive()&&this.props.onItemClick&&this.props.onItemClick()},t.prototype._getEngagementEventName=function(){return Object(E.b)(this.props.navigationSource)+".MegaMenu.Link.Click"},t.prototype._renderMenuHeading=function(e){return e.url&&"http://linkless.header/"!==e.url?r.createElement("a",{className:this._classNames.itemLinkMenuHeading,href:e.url,target:e.target,ref:function(t){t&&e.onClick&&t.addEventListener("click",function(t){return e.onClick(t,e)})},"data-navigationcomponent":Object(E.b)(this.props.navigationSource),"data-interception":this._isLinkPropagateKSActive()?void 0:"propagate"},e.name):r.createElement("span",{"data-is-focusable":!0},e.name)},t.prototype._onItemMouseOver=function(e,t){var n=t.currentTarget,o=n&&n.getElementsByClassName("ms-ContextualMenu-itemText");if(o&&o.length>0){var i=o.item(0);e&&i&&i.offsetWidth<i.scrollWidth&&(i.title=e)}},t.prototype._onHeaderMouseOver=function(e,t){var n=t.currentTarget;e&&n&&n.offsetWidth<n.scrollWidth&&(n.title=e)},t.prototype._getIconProps=function(e){return e.iconProps?e.iconProps:{iconName:e.icon}},t.prototype._isEnhancedMegaMenuFlightEnabled=function(){return u.a.isFeatureEnabled({ODB:1811})},t.prototype._isLinkPropagateKSActive=function(){return l.Killswitch.isActivated("b798b890-31a4-4e7e-a48d-3036c677510a","8/12/2020","allow link propagation for MegaMenu links")},Object(i.__decorate)([Object(o.customizable)("Menu",["theme"])],t)}(o.BaseComponent),T=Object(o.styled)(L,D),F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onKeyDown=function(e){e.which===o.KeyCodes.escape&&(t.props.onDismiss(),t._previousActiveElement&&t._previousActiveElement!==document.body&&t._previousActiveElement.focus(),e.preventDefault(),e.stopPropagation())},t}return Object(i.__extends)(t,e),t.prototype.UNSAFE_componentWillMount=function(){this._previousActiveElement=document.activeElement},t.prototype.render=function(){var e=this;return r.createElement(m.FocusZone,{direction:m.FocusZoneDirection.horizontal,handleTabKey:m.FocusZoneTabbableElements.all,isCircularNavigation:!0,isInnerZoneKeystroke:this._innerZoneKeystroke,tabIndex:0,onKeyDown:this._onKeyDown,"data-sp-a11y-skipkeys":o.KeyCodes.escape.toString()},r.createElement(_,Object(i.__assign)({},this.props.layoutProps),this.props.sections.map(function(t,n){return r.createElement(T,Object(i.__assign)({},t,{key:"menu"+n,shouldFocusOnMount:e.props.shouldFocusOnMount&&0===n,pageContext:e.props.pageContext,navigationSource:e.props.navigationSource,onItemClick:e.props.onItemClick}))})))},t.prototype._innerZoneKeystroke=function(e){return e.which===o.KeyCodes.up||e.which===o.KeyCodes.down},t}(o.BaseComponent),A=function(e){var t=e.sections,n=e.theme,o=n.fonts,r=n.semanticColors,a=u.a.isFeatureEnabled({ODB:1248,Fallback:!1});return{megaFooterContainer:Object(i.__assign)(Object(i.__assign)({alignItems:"flex-start",backgroundColor:r.bodyBackground,color:r.bodyText,display:"flex",flexWrap:"wrap"},o.medium),{height:"auto",justifyContent:"space-between",padding:"14px 24px 8px",zIndex:13,selectors:{a:{color:r.actionLink,textDecoration:"none",selectors:{":hover":{cursor:"pointer",textDecoration:"underline",selectors:{".ms-ContextualMenu-itemText":{color:r.actionLinkHovered}}}}}}}),megaFooterLogo:{color:r.bodyText,display:"flex",marginBottom:t&&t.length>0?24:0,selectors:{span:{fontSize:a?o.mediumPlus.fontSize:16,fontWeight:a?Object(f.a)(n).semibold.fontWeight:600,margin:"auto"},img:{maxHeight:32,marginRight:8,width:"auto"}}},megaFooterSectionsContainer:{display:"flex",flexWrap:"wrap",selectors:{".ms-MegaMenu-gridLayout":{justifyContent:"flex-start"},".ms-MegaMenu-gridLayoutItem":{marginRight:24,selectors:{":last-child":{marginRight:0}}},".ms-Menu-section":{margin:0,padding:0,marginBottom:"24px"},".ms-Menu-heading":{color:r.bodyText,fontSize:o.medium.fontSize,fontWeight:a?Object(f.a)(n).semibold.fontWeight:600,lineHeight:19,margin:0,padding:0,marginBottom:a?"8px":0},".ms-Menu-item":Object(i.__assign)(Object(i.__assign)({},o.medium),{lineHeight:a?24:19,paddingTop:a?0:8,selectors:{".ms-ContextualMenu-itemText":{color:r.bodyText,margin:0,overflow:"hidden",textOverflow:"ellipsis",width:"100%",whiteSpace:"nowrap"}}}),".ms-Menu-itemLink":{color:r.bodyText,fontSize:b.FontSizes.medium}}},megaFooterEditLinksButton:{background:"none",border:"none",color:r.link,cursor:"pointer",fontSize:o.medium.fontSize,margin:"0 24px 24px 0",padding:0,textDecoration:"none",selectors:{":hover":{color:r.linkHovered,textDecoration:"underline"}}}}},M=Object(o.classNamesFunction)(),I=function(e){function t(t){var n=e.call(this,t)||this;return n._onEditLinksClicked=function(){d.Engagement.logData({name:"FooterLinks.Edit.Click"}),n.props.onEditNavClicked&&n.props.onEditNavClicked(n._navLinkGroup,void 0,n._updateFooterDisplayLink)},n._updateFooterDisplayLink=function(e,t){n.props.onFooterLinksUpdated&&n.props.onFooterLinksUpdated(),t&&t()},n._onLogoError=function(){n.setState({hasLogoLoadError:!0})},n._itemOnClick=function(e,t){var o=n.props.pageContext,i=n.props.sections.length?n.props.sections.length:0;setTimeout(function(){return d.Engagement.logData({name:"Footer.Link.Click",extraData:{siteId:o&&o.siteId,numFooterSections:i,layout:"MegaFooter"}})},0),n._isItemOnClickFixKSActive()&&t.onClick&&t.onClick(e,t)},n._getItemClickCallback=function(e){return!n._isItemOnClickFixKSActive()&&e?function(t,o){n._itemOnClick(t,o),e(t,o)}:n._itemOnClick},n._isItemOnClickFixKSActive=function(){return l.Killswitch.isActivated("f5134b79-36ed-4d23-a7c8-4e7a9bbf08fe","4/13/2020","fix onClick callback for Extended Footer links")},n.state={hasLogoLoadError:!1},n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.footerStrings,n=e.logo,o=e.sections,a=e.theme,s=Object(i.__assign)(Object(i.__assign)({},this.props.layoutProps),{columnWidth:160});return this._classNames=M(A,{theme:a,sections:o}),r.createElement("div",{className:this._classNames.megaFooterContainer,role:"contentinfo","data-automationid":"MegaFooter"},r.createElement("div",{className:this._classNames.megaFooterLogo},!!n&&this._renderLogo(n)),r.createElement("div",{className:this._classNames.megaFooterSectionsContainer},this._showEditLink&&this._renderEditButton(),o?this._renderSections(o,s):this._isRemoveMobileAppButtonActive()&&r.createElement("div",null,r.createElement("a",{href:this._getMobileUpsellLink(),target:"_blank"},t.mobileUpsell))))},t.prototype._isMicrosoft=function(){return Object(p.doesStringStartWith)(window.location.href,"https://microsoft.sharepoint.com")||Object(p.doesStringStartWith)(window.location.href,"https://microsoft.sharepoint-df.com")||Object(p.doesStringStartWith)(window.location.href,"https://msft.spoppe.com")},t.prototype._getMobileUpsellLink=function(){return this._isMicrosoft()?"https://aka.ms/getspmobilemsit":"https://aka.ms/getspmteamcommsite"},t.prototype._renderEditButton=function(){var e=this.props.footerStrings;return r.createElement("div",{"data-automation-id":"MegaFooter-edit"},r.createElement("button",{id:"FooterEditLink",className:this._classNames.megaFooterEditLinksButton,onClick:this._onEditLinksClicked,"aria-label":this.props.footerStrings.editAriaLabel?this.props.footerStrings.editAriaLabel:""},e.edit))},Object.defineProperty(t.prototype,"_showEditLink",{get:function(){if(!this.props.pageContext||"portals"===window.teamsCustomAppType)return!1;var e=this.props.pageContext,t=e.isAnonymousGuestUser||e.isExternalGuestUser;return a.a.hasPermission(e.webPermMasks,a.a.manageLists)&&!t&&this._isEditNavInFooterFlightOn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_isEditNavInFooterFlightOn",{get:function(){return u.a.isFeatureEnabled({ODB:1560})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_navLinkGroup",{get:function(){return{name:u.a.isFeatureEnabled({ODB:1539})?"3a94b35f-030b-468e-80e3-b75ee84ae0ad":"47a59018-dcc3-4e98-a14e-146bc4001628",links:this.props.sections?this.props.sections.map(function(e){return{name:e.heading.name,links:e.items,key:e.linkKey,url:e.heading.url}}):[]}},enumerable:!0,configurable:!0}),t.prototype._renderLogo=function(e){var t=e.destinationUrl,n=e.name,o=e.srcImgUrl,i=[],a=!!l.Killswitch.isActivated("d0c75a93-542a-4abc-ab67-cf128b08990f","10/2/2019","Hide image on image error")||!this.state.hasLogoLoadError,c=!!t&&t.length>0,u=this._islinkTargetKSActive()||!c?"_blank":s.a.shouldLinkOpenInSameWindow(t)?"_self":"_blank";return a&&o&&i.push(c?r.createElement("a",{key:"companyLogo",href:new g.a(t).toString(),target:u,"data-navigationcomponent":Object(E.b)(E.a.Footer)},r.createElement("img",{src:new g.a(o).toString(),onError:this._onLogoError})):r.createElement("img",{key:"companyLogo",src:new g.a(o).toString(),onError:this._onLogoError})),n&&i.push(r.createElement("span",{key:"companyName"},c?r.createElement("a",{href:t,target:u,"data-navigationcomponent":Object(E.b)(E.a.Footer)},n):n)),i},t.prototype._renderSections=function(e,t){var n=this;if(e){var o=e.map(function(e){return{heading:Object(i.__assign)(Object(i.__assign)({},e.heading),{onClick:n._getItemClickCallback(e.heading.onClick),target:n._islinkTargetKSActive()||void 0===e.heading.url?void 0:s.a.shouldLinkOpenInSameWindow(e.heading.url)?"_self":"_blank"}),items:e.items?e.items.map(function(e){return{name:e.name,href:e.url,onClick:n._getItemClickCallback(e.onClick),target:n._islinkTargetKSActive()||void 0===e.url?void 0:s.a.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank"}}):void 0}});return r.createElement(F,{sections:o,layoutProps:t,navigationSource:E.a.Footer})}},t.prototype._islinkTargetKSActive=function(){return l.Killswitch.isActivated("e2657949-d82e-4521-8087-e46b9f22c7c6","4/14/2020","Keep consistent link targets with header")},t.prototype._isRemoveMobileAppButtonActive=function(){return l.Killswitch.isActivated("509594bb-1aed-4f48-b5a7-3a516630857d","09/14/2020","Remove mobile upsell button")},t}(o.BaseComponent),P=Object(o.styled)(I,A)},"0/Fd":function(e,t,n){"use strict";n.d(t,"b",function(){return _}),n.d(t,"a",function(){return v});var o=n("17wl"),i=n("cDcd"),r=n("yCth"),a=n("fj7e"),s=n("4xRo"),c=n.n(s),u=n("P1BV"),l=n("mVz8"),d=n("qIay"),p=n("q/yJ"),h=n.n(p),g=n("J7xF"),m=n("zK8O"),f=Object(g.classNamesFunction)();function _(e,t,n,i){var r={footerStrings:t,pageContext:i};if(n&&(r.theme=n),e&&Array.isArray(e))for(var a=0,s=e;a<s.length;a++){var c=s[a];c&&("2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100"===c.name?r.logo=Object(o.__assign)(Object(o.__assign)({},r.logo),{srcImgUrl:c.url}):"7376cd83-67ac-4753-b156-6a7b3fa0fc1f"===c.name?c.links&&c.links.length&&(r.logo=Object(o.__assign)(Object(o.__assign)({},r.logo),{name:c.links[0].name})):"3a94b35f-030b-468e-80e3-b75ee84ae0ad"===c.name&&(r.links=c.links))}return r}var v=function(e){function t(t){var n=e.call(this,t)||this;return n._onLogoError=function(){n.setState({hasLogoLoadError:!0})},n._onEditLinksClicked=function(){if(l.Engagement.logData({name:"FooterLinks.Edit.Click"}),n.props.onEditNavClicked){var e={links:n.props.links||[],name:"3a94b35f-030b-468e-80e3-b75ee84ae0ad"};n.props.onEditNavClicked(e,void 0,n._updateFooterDisplayLink)}},n._updateFooterDisplayLink=function(e,t){n.props.onFooterLinksUpdated&&n.props.onFooterLinksUpdated(),t&&t()},n.state={hasLogoLoadError:!1},n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.styles,o=void 0===n?this.props.getStyles:n,r=t.theme;return this._classNames=f(o,{theme:r}),i.createElement("div",{className:this._classNames.simpleFooterContainer,role:"contentinfo","data-automationid":"SimpleFooter"},i.createElement("div",{className:this._classNames.simpleFooterLogoSlot},this.props.logo&&this._renderLogo(this.props.logo)),i.createElement("div",{className:this._classNames.simpleFooterLinkSlots},this._showEditNavLink&&this._renderEditLink(),this.props.links&&this.props.links.map(function(t,n){return e._renderNavLink(t,n)})))},t.prototype._renderEditLink=function(){return this.props.footerStrings.edit?i.createElement("div",{className:this._classNames.simpleFooterItem,"data-automationid":"SimpleFooter-edit"},i.createElement("button",{className:this._classNames.simpleFooterEditItem,id:"FooterEditLink",onClick:this._onEditLinksClicked,"aria-label":this.props.footerStrings.editAriaLabel?this.props.footerStrings.editAriaLabel:""},this.props.footerStrings.edit)):null},Object.defineProperty(t.prototype,"_showEditNavLink",{get:function(){if(!this.props.pageContext||"portals"===window.teamsCustomAppType)return!1;var e=this.props.pageContext.isAnonymousGuestUser||this.props.pageContext.isExternalGuestUser;return r.a.hasPermission(this.props.pageContext.webPermMasks,r.a.manageLists)&&!e&&this._isEditNavInFooterFlightOn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_isEditNavInFooterFlightOn",{get:function(){return c.a.isFeatureEnabled({ODB:1560})},enumerable:!0,configurable:!0}),t.prototype._isMicrosoft=function(){return Object(d.doesStringStartWith)(window.location.href,"https://microsoft.sharepoint.com")||Object(d.doesStringStartWith)(window.location.href,"https://microsoft.sharepoint-df.com")||Object(d.doesStringStartWith)(window.location.href,"https://msft.spoppe.com")},t.prototype._getMobileUpsellLink=function(){return this._isMicrosoft()?"https://aka.ms/getspmobilemsit":"https://aka.ms/getspmteamcommsite"},t.prototype._getCreateSiteLink=function(){return h.a.concatenate(window.location.origin,"_layouts/15/createGroup.aspx?siteTemplate=68")},t.prototype._renderLogo=function(e){var t=!!u.Killswitch.isActivated("d0c75a93-542a-4abc-ab67-cf128b08990f","10/2/2019","Hide image on image error")||!this.state.hasLogoLoadError,n=e.destinationUrl&&e.destinationUrl.length>0?new h.a(e.destinationUrl).toString():void 0,o=this._islinkTargetKSActive()||void 0===n?"_blank":a.a.shouldLinkOpenInSameWindow(n)?"_self":"_blank";if(e.name&&e.srcImgUrl){var r=[];return t&&r.push(i.createElement("div",{className:Object(g.css)(this._classNames.simpleFooterItem,"simpleFooterLogoItem"),key:"logo"},e.destinationUrl&&e.destinationUrl.length>0?i.createElement("a",{href:n,"data-interception":"propagate",target:o,"data-navigationcomponent":Object(m.b)(m.a.Footer)},i.createElement("img",{className:this._classNames.simpleFooterLogoImage,src:new h.a(e.srcImgUrl).toString(),onError:this._onLogoError,alt:e.name})):i.createElement("img",{className:this._classNames.simpleFooterLogoImage,src:new h.a(e.srcImgUrl).toString(),onError:this._onLogoError,alt:e.name}))),r.push(i.createElement("div",{className:Object(g.css)(this._classNames.simpleFooterItem,"simpleFooterNameItem"),key:"name"},e.destinationUrl&&e.destinationUrl.length?i.createElement("a",{href:n,"data-interception":"propagate",target:o},e.name):e.name)),r}return e.name?i.createElement("div",{className:Object(g.css)(this._classNames.simpleFooterItem,"simpleFooterNameItem")},e.destinationUrl&&e.destinationUrl.length?i.createElement("a",{href:n,"data-interception":"propagate",target:o,"data-navigationcomponent":Object(m.b)(m.a.Footer)},e.name):e.name):t&&e.srcImgUrl?i.createElement("div",{className:Object(g.css)(this._classNames.simpleFooterItem,"simpleFooterLogoItem")},e.destinationUrl&&e.destinationUrl.length>0?i.createElement("a",{href:n,"data-interception":"propagate",target:o},i.createElement("img",{className:this._classNames.simpleFooterLogoImage,src:new h.a(e.srcImgUrl).toString(),onError:this._onLogoError,alt:this.props.footerStrings.companyLogoAlt?this.props.footerStrings.companyLogoAlt:""})):i.createElement("img",{className:this._classNames.simpleFooterLogoImage,src:new h.a(e.srcImgUrl).toString(),onError:this._onLogoError,alt:this.props.footerStrings.companyLogoAlt?this.props.footerStrings.companyLogoAlt:""})):void 0},t.prototype._renderNavLink=function(e,t){var n=this;if(this._isRemoveMobileAppButtonActive()&&"defaultGetMobileAppNode"===e.key)return i.createElement("div",{key:"footerLinkDiv"+t,className:this._classNames.simpleFooterItem,"data-automationid":"simpleFooter-defaultGetMobileAppNode"},i.createElement("a",{href:this._getMobileUpsellLink(),"data-interception":"propagate",target:"_blank"},this.props.footerStrings.mobileUpsell));if("defaultPoweredBySharePointNode"===e.key)return i.createElement("div",{key:"footerLinkDiv"+t,className:this._classNames.simpleFooterItem,"data-automationid":"simpleFooter-defaultPoweredBySharePointNode"},i.createElement("span",null,this.props.footerStrings.poweredBy+" ",i.createElement("a",{href:this._getCreateSiteLink(),"data-interception":"propagate",target:this._islinkTargetKSActive()?"_blank":"_self",onClick:e.onClick},this.props.footerStrings.createSite)));var o=this._islinkTargetKSActive()?"_blank":a.a.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank";return i.createElement("div",{className:this._classNames.simpleFooterItem,key:"footerLinkDiv"+t},e.url&&e.url.length&&"http://linkless.header/"!==e.url?i.createElement("a",{href:e.url,"data-interception":"propagate",key:"footerLink"+t,target:o,onClick:function(t){return n._itemOnClick(t,e)},"data-navigationcomponent":Object(m.b)(m.a.Footer)},e.name):e.name)},t.prototype._itemOnClick=function(e,t){var n=this.props.pageContext,o=this.props.links?this.props.links.length:0;setTimeout(function(){return l.Engagement.logData({name:"Footer.Link.Click",extraData:{siteId:n&&n.siteId,numFooterLinks:o,layout:"SimpleFooter"}})},0),t.onClick&&t.onClick(e,t)},t.prototype._islinkTargetKSActive=function(){return u.Killswitch.isActivated("e2657949-d82e-4521-8087-e46b9f22c7c6","4/14/2020","Keep consistent link targets with header")},t.prototype._isRemoveMobileAppButtonActive=function(){return u.Killswitch.isActivated("8d38d290-4b6a-48c9-83f6-4ae1365db35c","9/14/2020","Remove mobile APP button")},t}(g.BaseComponent)},"3ufC":function(e,t,n){var o=n("KL1q");for(var i in e.exports={},o)o.hasOwnProperty(i)&&(e.exports[i]=o[i]);Object.defineProperty(e.exports,"__esModule",{value:!0})},"4xRo":function(e,t,n){var o=n("K9kD");for(var i in e.exports={},o)o.hasOwnProperty(i)&&(e.exports[i]=o[i]);e.exports.default=o.FeatureOverrides,Object.defineProperty(e.exports,"__esModule",{value:!0})},"6TMO":function(e,t,n){var o=n("K9kD");for(var i in e.exports={},o)o.hasOwnProperty(i)&&(e.exports[i]=o[i]);e.exports.default=o.DataStoreCachingType,Object.defineProperty(e.exports,"__esModule",{value:!0})},S7CW:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var o=n("4xRo"),i=n.n(o),r=function(){return i.a.isFeatureEnabled({ODB:1248,Fallback:!1})};function a(e){return{regular:{fontWeight:400},semibold:{fontWeight:600},bold:{fontWeight:700}}}},U6GQ:function(e,t,n){"use strict";n.d(t,"a",function(){return x});var o=n("17wl"),i=n("gcRq"),r=n.n(i),a=n("P1BV");function s(e){for(var t="";t.length<e;){var n=16*Math.random();t+=(n|=0).toString(16)}return t}function c(){var e=[];e.push(s(8)),e.push(s(4));var t="4"+s(3);e.push(t);var n=s(4),o=parseInt(n[0],16);return o&=3,n=(o|=8).toString(16)+n.substr(1),e.push(n),e.push(s(12)),e.join("-")}var u,l="undefined"==typeof window?self:window,d=n("uN8c");!function(e){e.success="success",e.error="error"}(u||(u={}));var p=(new function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var n,i=e,r=e.toLowerCase(),a=function(e){var t;function n(n){return t=RegExp(n+"(\\d+)([\\d.]*)").exec(e)}e=e.toLowerCase();var o=n("msie ")||n("trident.*rv:"),i=t&&"9"===t[1],r=!t&&n("edge/"),a=!t&&n("edg/"),s=!t&&n("fxios|firefox/"),c=!t&&n("(?:chrome|crios)/"),u=!t&&/safari\/(\d+)/.test(e);return u&&n("version/"),{browserName:o?"IE":r?"Edge":a?"EdgeChromium":s?"Firefox":c?"Chrome":u?"Safari":"NA",isChrome:!!c,isEdge:!!r,isEdgeChromium:!!a,isFirefox:!!s,isIE:!!o,isIE9:!!i,isSafari:!!u,matchedBrowser:t}}(r),s={browserMajor:(n=a.matchedBrowser)&&parseInt(n[1],10)||0,browserMinor:n&&n[2]&&n[2].slice(1)||"0"},c=function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),n=t||/ipad|iphone|ipod|android/.exec(e),o=n&&n[0],i="android"===o,r="ipad"===o,a=!!o&&!i,s=!n&&e.indexOf("macintosh")>-1,c=!n&&e.indexOf("windows nt")>-1;return{isAndroid:i,isIOS:a,isIPad:r,isMac:s,isWindows:c,isWinPhone:!!t,isMobile:!!n,osName:c?"Windows":t?"Windows Phone":s?"OSX":a?"IOS":i?"Android":"NA"}}(r),u=c.isMobile,l=/electron\/\\d+[\\d.]*/.test(r),d=r.indexOf("winappwipenabled")>-1,p=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),h=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(r),g=!1,m=!1,f=!1,_=!1;if(t&&t.document){var v=document.createElement("style");v.type="text/css",g=!v.styleSheet,m="addBehavior"in HTMLDivElement.prototype;var b=document.createElement("input");b.type="file";var y=t.File,k=y&&y.prototype;_=!(!k||!(k.slice||k.mozSlice||k.webkitSlice)),f="webkitdirectory"in b&&!l}return Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},a),s),c),{isElectron:l,osVersion:h?h[2]:"NA",isWindows81:!u&&/windows (?:8\.1|nt 6\.3)/.test(r),isWindows10:!u&&r.indexOf("windows nt 10")>-1,isWindows7:!u&&r.indexOf("windows nt 6.1")>-1,isWinAppWipEnabled:d,isPWA:p,areCSS3TransitionsSupported:!a.isIE||s.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:f,isHtml5FileUploadSupported:_,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:g,isWebDavSupported:m,userAgent:i})}).isFirefox,h=function(){function e(t){if(!("indexedDB"in l)||!l.indexedDB)throw new Error("indexedDB is not supported");this._logger=t,e._openDBPromise||(e._openDBPromise=this._openIndexedDB().then(function(t){return e._db=t,t}))}return e.prototype.freeSpace=function(t,n){return Object(o.__awaiter)(this,void 0,void 0,function(){var i,r,a,s=this;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return r=e,(a=e._db)?[3,2]:[4,e._openDBPromise];case 1:a=o.sent(),o.label=2;case 2:return i=r._db=a,[2,new Promise(function(e,o){var r=i.transaction(["ODSP_DB_TABLE"],"readwrite").objectStore("ODSP_DB_TABLE").index("app_lastRead").openCursor();r.onsuccess=function(o){var i=r.result;i?(i.value.app===t&&n>0&&(n-=i.value.size,i.delete()),n>0?i.continue():e()):e()},r.onerror=function(e){s._errorHandling(e,o)}})]}})})},e.prototype.read=function(e){return Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(t){return[2,this._readInternal("ODSP_DB_TABLE",function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return Object(o.__awaiter)(this,void 0,void 0,function(){var n,i,r,a,s,c,u,l,d,p,h,g,m,f=this;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return n={},r=e,(a=e._db)?[3,2]:[4,e._openDBPromise];case 1:a=o.sent(),o.label=2;case 2:return i=r._db=a,s=i.transaction(["ODSP_DB_TABLE"],"readonly"),c=s.objectStore("ODSP_DB_TABLE"),u=[],l=t.index,d=t.range,p=t.direction,h=t.count,g=c.index(l),(m=g.openKeyCursor(d,p)).onerror=function(e){f._errorHandling(e,n.reject)},m.onsuccess=function(e){var t=e.target.result;t?(u.push(t.primaryKey),u.length>=h?n.resolve(u):t.continue()):n.resolve(u)},[2,new Promise(function(e,t){n.resolve=e,n.reject=t})]}})})},e.prototype.write=function(e){return Object(o.__awaiter)(this,void 0,void 0,function(){var t;return Object(o.__generator)(this,function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:"ODSP_DB_TABLE",key:t,row:Object(o.__assign)(Object(o.__assign)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:"ODSP_DB_TABLE",key:t,row:void 0})]})})},e.prototype.statistics=function(){return Object(o.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(o.__generator)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate("ODSP_DB_TABLE",function(e){return e.size})];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,o){if(e._db)n(e._db);else{var i=p?indexedDB.open("ODSP_DB",{version:4,storage:"temporary"}):indexedDB.open("ODSP_DB",4);i.onerror=function(e){t._errorHandling(e,o)},i.onsuccess=function(t){var o=e._db=i.result;n(o)},i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,o)};var r=e.oldVersion;t._handleDBUpgrade(i,n,r)}}})},e.prototype._handleDBUpgrade=function(e,t,n){var o;n<1&&((o=t.createObjectStore("ODSP_DB_TABLE",{keyPath:"key"})).createIndex("lastModified","lastModified",{unique:!1}),o.createIndex("reads","reads",{unique:!1}),t.createObjectStore("ODSP_DB_METADATA_TABLE",{keyPath:"key"})),n<2&&((o=o||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("app","app",{unique:!1}),o.createIndex("lastRead","lastRead",{unique:!1}),o.createIndex("app_lastRead",["app","lastRead"],{unique:!1})),n<3&&((o=o||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("app_lastModified",["app","lastModified"],{unique:!1}),o.createIndex("app_reads",["app","reads"],{unique:!1})),n<4&&((o=o||e.transaction.objectStore("ODSP_DB_TABLE")).createIndex("parentKey","parentKey",{unique:!1}),o.createIndex("parentKey_app",["parentKey","app"],{unique:!1}),o.createIndex("parentKey_app_lastModified",["parentKey","app","lastModified"],{unique:!1}),o.createIndex("parentKey_app_lastRead",["parentKey","app","lastRead"],{unique:!1}),o.createIndex("parentKey_app_reads",["parentKey","app","reads"],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal("ODSP_DB_METADATA_TABLE",function(e){return e.get("database_metadata")}).then(function(t){if(t)return t.data;var n={id:c(),created:Date.now(),cacheType:1};return e._writeInternal({tableName:"ODSP_DB_METADATA_TABLE",key:"database_metadata",row:{key:"database_metadata",data:n}}).then(function(){return n})})},e.prototype._readInternal=function(t,n){return Object(o.__awaiter)(this,void 0,void 0,function(){var i,r,a,s=this;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return r=e,(a=e._db)?[3,2]:[4,e._openDBPromise];case 1:a=o.sent(),o.label=2;case 2:return i=r._db=a,[2,new Promise(function(e,o){var r=s._logger({name:"PersistentCacheIDB.readInternal"}),a=Date.now(),c=i.transaction([t],"readonly").objectStore(t),u=n(c);u.onsuccess=function(t){r({resultType:d.ResultTypeEnum.Success,extraData:{io:Math.round(Date.now()-a)}}),e(u.result)},u.onerror=function(e){r({resultType:d.ResultTypeEnum.Failure,extraData:{io:Math.round(Date.now()-a)}}),s._errorHandling(e,o)}})]}})})},e.prototype._iterate=function(t,n){return Object(o.__awaiter)(this,void 0,void 0,function(){var i,r,a,s,c=this;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return r=e,(a=e._db)?[3,2]:[4,e._openDBPromise];case 1:a=o.sent(),o.label=2;case 2:return i=r._db=a,s=[],[2,new Promise(function(e,o){var r=i.transaction([t],"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var o=r.result;o?(s.push(n(o.value)),o.continue()):e(s)},r.onerror=function(e){c._errorHandling(e,o)}})]}})})},e.prototype._writeInternal=function(t){return Object(o.__awaiter)(this,void 0,void 0,function(){var n,i,r,a,s,c,u=this;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return n=t.tableName,i=t.key,r=t.row,s=e,(c=e._db)?[3,2]:[4,e._openDBPromise];case 1:c=o.sent(),o.label=2;case 2:return a=s._db=c,[2,new Promise(function(e,t){try{var o=a.transaction([n],"readwrite"),s=o.objectStore(n);o.oncomplete=function(){},o.onerror=function(e){u._errorHandling(e,t)};var c=r?s.put(r):s.delete(i);c.onsuccess=function(t){e()},c.onerror=function(e){u._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return Object(o.__awaiter)(this,void 0,void 0,function(){var t,n=this;return Object(o.__generator)(this,function(o){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:"parentKey",range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:"ODSP_DB_TABLE",key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===u.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),g=function(){function e(){try{if("localStorage"in l&&l.localStorage&&(this._localStorage=l.localStorage,!this._localStorage.getItem("PersistentCache_metadata"))){var e={id:c(),created:Date.now(),cacheType:0};this._localStorage.setItem("PersistentCache_metadata",JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=Object(o.__assign)(Object(o.__assign)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(t)},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf("PersistentCache")){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem("PersistentCache_metadata")),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"PersistentCache_"+e},e}(),m=0,f=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],o=!0,i=[];n.length>0&&(n[0].schedule?(i=n.slice(1),this._queue[e]=[n[0]],o=!1):(i=this._queue[e],this._queue[e]=[]));var r=this._createUpateTask(e,t);return i.length>0&&(r.signal=i[0].signal),this._queue[e].push(r),o&&this._scheduleTask(e),r},e.prototype._createUpateTask=function(e,t){var n=this,i={};i.promise=new Promise(function(e,t){i.resolve=e,i.reject=t});var r={execute:function(){return Object(o.__awaiter)(n,void 0,void 0,function(){var e;return Object(o.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),r.error=e,[3,4];case 3:return this._completeTask(r),[7];case 4:return[2]}})})},schedule:0,id:m++,key:e,signal:i};return r},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=l.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,o=this._queue[n],i=o[0],r=o.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=r,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function _(){return l.performance&&performance.now?Math.round(performance.now()):Date.now()}var v=n("WKW7"),b=function(){function e(e){var t=e.cacheType,n=void 0===t?1:t,i=Object(o.__rest)(e,["cacheType"]);if(this._config=Object(o.__assign)(Object(o.__assign)({},i),{cacheType:n}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new f,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!0,configurable:!0}),e.prototype.read=function(t){return Object(o.__awaiter)(this,void 0,void 0,function(){var n,i,r,a,s,c,u,l,d,p,h,g,m,f,b,y,k,x,S,w;return Object(o.__generator)(this,function(o){switch(o.label){case 0:n=this._logQos({name:"PersistentCache.read"}),s=_(),c=Date.now(),o.label=1;case 1:return o.trys.push([1,12,,13]),l=this._getCacheKey(t),d=!1,p={lastModified:NaN,lastRead:c,reads:1},h=void 0,l?(g=_(),[4,this._storage.read(l)]):[3,11];case 2:return u=o.sent(),a=Math.round(_()-g),u?(m=u.data,p={lastModified:u.lastModified,lastRead:c,reads:u.reads+1},(i=e._buffer[l])&&i.cacheStats.lastModified===u.lastModified?(i.app=u.app||this._app,i.key={original:t,encoded:u.key||l},i.cacheStats.lastRead=c,i.cacheStats.reads++,i.performance={total:Math.round(_()-s)},[3,11]):[3,3]):[3,11];case 3:if(i=void 0,void 0===m)return[3,11];if(!this._dataIsEncrypted)return[3,10];f=m,b=this._cacheSecret,y=b.CurrentKey.Key,k=b.PreviousKey.Key,x=_(),o.label=4;case 4:return o.trys.push([4,6,,9]),[4,this._crypto.decrypt({encryptedData:f,encryptionSecret:y})];case 5:return h=o.sent(),[3,9];case 6:return(S=o.sent())&&S.message&&S.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:f,encryptionSecret:k})]:[3,8];case 7:h=o.sent(),d=void 0!==h,n({resultType:v.ResultTypeEnum.ExpectedFailure,error:S.message,extraData:{cacheResult:"hit"}}),o.label=8;case 8:return[3,9];case 9:return r=Math.round(_()-x),[3,11];case 10:h=m,o.label=11;case 11:return i=i||{key:{original:t,encoded:u&&u.key||l},app:u&&u.app||this._app,data:h,cacheStats:p,cacheType:this._cacheType,performance:{crypto:r,io:a,total:Math.round(_()-s)}},e._buffer[l]=i,d&&this.update(t,h),[3,13];case 12:throw w=o.sent(),n({resultType:v.ResultTypeEnum.Failure,error:w.message?w.message:w.toString(),extraData:{cacheResult:"miss"}}),w;case 13:return n({resultType:v.ResultTypeEnum.Success,extraData:{cacheResult:void 0!==i.data?"hit":"miss"}}),[2,Promise.resolve(i)]}})})},e.prototype.rangeQuery=function(e){return Object(o.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,a,s,c,u=this;return Object(o.__generator)(this,function(o){if(1!==this._cacheType)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,i=_(),r=Date.now(),s={lastModified:NaN,lastRead:r,reads:1};try{c=_(),a=this._storage.rangeQuery(e).then(function(e){return n=Math.round(_()-c),{key:void 0,app:void 0,data:e.map(function(e){return{original:u._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:s,cacheType:u._cacheType,performance:{io:n,total:Math.round(_()-i)}}})}catch(e){throw t({resultType:v.ResultTypeEnum.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:v.ResultTypeEnum.Success}),[2,a||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:s,cacheType:this._cacheType,performance:{io:n,total:Math.round(_()-i)}})]})})},e.prototype.update=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,function(){var n,i=this;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return n=this._getCacheKey(e),[4,this._cacheUpdateTaskManager.enqueue(n,function(){return i._doCacheUpdate(e,t)}).signal.promise];case 1:return o.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){return Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(t){return[2,this.update(e,void 0)]})})},e.prototype.freeSpace=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,function(){var n,i,r,a,s,c,u=this;return Object(o.__generator)(this,function(o){switch(o.label){case 0:n=_(),i=Date.now(),r=this._logQos({name:"PersistentCache.readAndUpdate"}),a=t().then(function(t){var o={app:u._app,key:{original:e,encoded:u._getCacheKey(e)},data:t,cacheType:2,cacheStats:{lastModified:void 0,lastRead:i,reads:1},performance:{total:Math.round(_()-n)}};return u.update(e,t),o}),o.label=1;case 1:o.trys.push([1,8,,9]),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,Promise.race([this.read(e),a])];case 3:return s=o.sent(),[3,5];case 4:return o.sent(),[3,5];case 5:return!s||2!==s.cacheType&&void 0===s.data?[4,a]:[3,7];case 6:s=o.sent(),o.label=7;case 7:return[3,9];case 8:throw c=o.sent(),r({resultType:v.ResultTypeEnum.Failure,error:c.message?c.message:c.toString()}),c;case 9:return r({resultType:v.ResultTypeEnum.Success}),[2,s]}})})},e.prototype._initLocalStorage=function(e){switch(e){case 0:this._storage=new g;break;case 1:default:try{this._storage=new h(this._logQos.bind(this))}catch(e){"indexedDB is not supported"===e.message&&(this._storage=new g,this._cacheType=0)}}},e.prototype._getCacheKey=function(e){var t=encodeURIComponent(e.key+(e.user?"_____"+e.user:""));return"_odspcache_"+(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace("_odspcache_",""),n=this._dataIsEncrypted?atob(t):t,o=decodeURIComponent(n);if(o.indexOf("_____")>=0){var i=o.split("_____");return{key:i[0],user:i[1]}}return{key:o}},e.prototype._doCacheUpdate=function(t,n){return Object(o.__awaiter)(this,void 0,void 0,function(){var i,r,a,s,c,u,l;return Object(o.__generator)(this,function(d){switch(d.label){case 0:i=this._logQos({name:"PersistentCache.update"}),d.label=1;case 1:return d.trys.push([1,9,,10]),r=this._getCacheKey(t),void 0===n?[3,6]:((a=e._buffer[r]=Object(o.__assign)(Object(o.__assign)({},e._buffer[r]),{data:n,cacheType:this._cacheType})).cacheStats||(a.cacheStats={lastModified:NaN,lastRead:_(),reads:1}),s=n,c=NaN,this._dataIsEncrypted?(u=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:u,data:n,doSerialize:0===this._cacheType})]):[3,3]);case 2:return s=d.sent(),c=s.cipherText?s.cipherText.byteLength:0,[3,4];case 3:try{c="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}d.label=4;case 4:return[4,this._storage.write({app:this._app,key:r,data:s,lastRead:a.cacheStats.lastRead,parentKey:t.parentKey,reads:a.cacheStats.reads,size:c})];case 5:return d.sent(),[3,8];case 6:return delete e._buffer[r],[4,this._storage.write({key:r,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:d.sent(),d.label=8;case 8:return[3,10];case 9:throw l=d.sent(),i({resultType:v.ResultTypeEnum.Failure,error:l.message?l.message:l.toString()}),l;case 10:return i({resultType:v.ResultTypeEnum.Success}),[2]}})})},e.prototype._logCacheStats=function(){return Object(o.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(o.__generator)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return Object(o.__awaiter)(e,void 0,void 0,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}(),y=n("wQUy"),k=n("lgIK"),x=function(){function e(e,t){this._getDataPromises={};var n=e.id,i=e.dataSourceName,r=e.cacheType,a=void 0===r?1:r,s=(t.pageContext||{}).aadUserId;this._id=n,this._userId=s;var c=i||n,u=y.Qos.withData(function(e){return e.name&&c&&!e.name.startsWith(c)?Object(o.__assign)(Object(o.__assign)({},e),{name:c+"."+e.name}):e});this._cache=new b({cacheType:a,telemetry:{qos:u}})}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e.cacheRequestKey,o=e.cachingStrategy,i=void 0===o?0:o,s=e.cacheTimeoutTime,c=void 0===s?k.c:s,u=e.getData,l=e.returnStatistics,d=void 0!==l&&l,p={key:n,user:this._userId},h=function(){return S()||t._getDataPromises[n]||(t._getDataPromises[n]=u().then(function(e){return delete t._getDataPromises[n],e})),(S()?u():t._getDataPromises[n]).then(function(e){return t._cache.update(p,e),d?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})};return a.Killswitch.isActivated("19cec8a5-4f79-4d4c-ae7e-f272ba265abb")||2!==i?r.a.resolve(this._cache.read(p)).then(function(e){var n=e.data,o=e.cacheStats;if(null==n)return h();var r=d?{data:n,cacheStats:o}:n,a=t._isCacheExpired(o.lastModified,c);switch(i){case 2:return r;case 0:return a&&h(),r;case 1:return a?h():r;case 3:default:return h()}}).catch(function(){return h()}):r.a.resolve(this._cache.read(p)).then(function(e){var t=e.data,n=e.cacheStats;return null==t?null:d?{data:t,cacheStats:n}:t}).catch(function(){return null})},e.prototype.getRequestKey=function(e,t,n){var o=[];return o.push(e),o.push(t),n&&o.push(n.toString()),o.join(",")},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0}),e.prototype.flushCache=function(e){var t={key:e,user:this._userId};delete this._cache[e],this._cache.remove(t)},e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t},e}();function S(){return a.Killswitch.isActivated("0b1fbce0-bb51-41da-a09b-8d1686398bb7")}},UITg:function(e,t,n){var o=n("K9kD");for(var i in e.exports={},o)o.hasOwnProperty(i)&&(e.exports[i]=o[i]);e.exports.default=o.DataStore,Object.defineProperty(e.exports,"__esModule",{value:!0})},WKW7:function(e,t,n){var o=n("K9kD");for(var i in e.exports={},o)o.hasOwnProperty(i)&&(e.exports[i]=o[i]);Object.defineProperty(e.exports,"__esModule",{value:!0})},"cJM/":function(e,t,n){"use strict";var o;n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),function(e){e.SharePointList="SharePointList"}(o||(o={}));var i={ODB:1620},r={ODB:60063};function a(e,t){return e(i)&&(window.localStorage&&"true"===window.localStorage.NucleusPreviewEnabled||/[?&]enableNucleusPreview=true/.test(location.search))}},extd:function(e,t,n){var o=n("K9kD");for(var i in e.exports={},o)o.hasOwnProperty(i)&&(e.exports[i]=o[i]);e.exports.default=o.DataRequestor,Object.defineProperty(e.exports,"__esModule",{value:!0})},fj7e:function(e,t,n){"use strict";n.d(t,"a",function(){return M});var o,i=n("17wl"),r=n("P1BV"),a=n("gcRq"),s=n.n(a),c=n("extd"),u=n.n(c),l=n("uN8c"),d=n("4xRo"),p=n.n(d),h=n("cJM/"),g=(o=function(e){return p.a.isFeatureEnabled(e)},Object(h.b)(o)?n.e(5).then(n.bind(null,"VfMv")).then(function(e){return function(t){return e.getDataSyncClient(t,o)}}):Promise.resolve(function(e){}));function m(e){var t=e.options,n=t.url,o=t.authToken,r=t.telemetryHandler,a=t.useExactAuthToken,c=e.dataSyncClient,u=e.aadUserId,d=e.getData,p=function(){return d({url:n,telemetryHandler:r,authToken:o,useExactAuthToken:a})};return u?s.a.resolve(c).then(function(e){return e||g.then(function(e){return e(u)})}).then(function(e){return e?function(e){var t=function(e,t){return function(n,o){var r=n.eventData,a=r.extraData,s={performanceEntry:a&&a.performanceEntry,httpStatus:a&&a.HttpStatus,correlationId:a&&a.CorrelationId,succeeded:r&&r.resultType===l.ResultTypeEnum.Success||!1,resultCode:r&&r.resultCode,endpoint:o},c=t&&t(n),u=e.onRequestComplete(s);return a.dataSyncQos=e.getQosInfo(),Object(i.__assign)(Object(i.__assign)({},c||{}),{eventData:Object(i.__assign)(Object(i.__assign)({},c?c.eventData:r),{extraData:Object(i.__assign)(Object(i.__assign)({},c?c.eventData.extraData:r.extraData),e.getQosInfo())}),canRetry:u&&(!c||c.canRetry)})}}(e,r);return e.getData({url:n},function(e){return d({url:e.url,authToken:e.authToken,telemetryHandler:function(n){return t(n,e)},useExactAuthToken:!0})},p)}(e):p()}):p()}var f=function(){var e=function(e){return p.a.isFeatureEnabled(e)};return Object(h.b)(e)?n.e(5).then(n.bind(null,"VfMv")).then(function(t){return function(n){return t.getDataSyncClient(n,e)}}):s.a.resolve(function(e){})}(),_=function(){function e(e,t){var n=this._pageContext=t.pageContext,o=t.tokenProvider,a=t.dataRequestorType,c=void 0===a?function(e){function t(t){return e.call(this,t,Object(i.__assign)({pageContext:n,tokenProvider:o},Object(r.getKillSwitch)(n).isActivated("68FFDA86-24A1-4A87-A304-0B53C0058679","11/5/2020","Factor Nucleus support into DataRequestor plugin")?{}:{dataSyncClient:s.a.resolve(l),getDataWithSyncClient:m}))||this}return Object(i.__extends)(t,e),t}(u.a):a,l=t.dataSyncClient,d=e.dataSourceName,p=void 0===d?"DataSource":d;this.dataSyncClient=l,this.dataRequestor=new c({qosName:p})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,o,i,a,u,l,d,p,h,g,m){var _=this;void 0===i&&(i="POST");var v=e(),b=o&&o(),y=this.needsRequestDigest(v);if(!Object(r.getKillSwitch)(this._pageContext).isActivated("68FFDA86-24A1-4A87-A304-0B53C0058679","11/5/2020","Factor Nucleus support into DataRequestor plugin"))return this.dataRequestor.getData({url:v,parseResponse:t,qosName:n,additionalPostData:b,method:i,additionalHeaders:a,contentType:u,maxRetries:l,noRedirect:d,crossSiteCollectionCall:p,telemetryHandler:h,qosExtraData:g,needsRequestDigest:y,authToken:m});var k=function(){return _.dataRequestor.getData({url:v,parseResponse:t,qosName:n,additionalPostData:b,method:i,additionalHeaders:a,contentType:u,maxRetries:l,noRedirect:d,crossSiteCollectionCall:p,telemetryHandler:h,qosExtraData:g,needsRequestDigest:_.needsRequestDigest(v),authToken:m})};if(!this._pageContext.aadUserId)return k();var x=function(e){var o=Object(c.getSyncTelemetryHandler)(e,h);return e.getData({url:v},function(e){return _.dataRequestor.getData({url:e.url,authToken:e.authToken,parseResponse:t,qosName:n,additionalPostData:b,method:i,additionalHeaders:a,contentType:u,maxRetries:l,noRedirect:d,crossSiteCollectionCall:p,telemetryHandler:function(t){return o(t,e)},qosExtraData:g,needsRequestDigest:_.needsRequestDigest(e.url),useExactAuthToken:!0})},k)};return this.dataSyncClient?s.a.wrap(x(this.dataSyncClient)):s.a.wrap(f).then(function(e){var t=e(_._pageContext.aadUserId);return t?x(t):k()})},e}(),v=n("U6GQ"),b=n("UITg"),y=n.n(b),k=n("6TMO"),x=n.n(k),S=n("lgIK"),w=function(){function e(e,t){var n=e.id,o=e.cacheType,i=void 0===o?x.a.session:o,r=t.cacheIdPrefix,a=void 0===r?S.a:r,s=t.pageContext;this._id=n,this._version=s?s.siteClientTag+"_"+s.userDisplayName:"",this._store=new y.a(a,i),this._storeDefaultCacheType=i,this._initCache()}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e.cacheRequestKey,o=e.useStale,i=void 0!==o&&o,r=e.bypassCache,a=void 0!==r&&r,c=e.onlyCache,u=void 0!==c&&c,l=e.checkForInvalidation,d=e.setInvalidated,p=e.getData,h=e.cacheTimeoutTime,g=void 0===h?S.b:h,m=e.returnStatistics,f=void 0!==m&&m,_=this._cache,v=_[n],b=function(){return f?{data:v._value,cacheStats:{lastModified:NaN,lastRead:v._fetched,reads:NaN}}:v._value};if(u)return v?s.a.resolve(b()):s.a.resolve(void 0);l=l&&!a&&this._storeDefaultCacheType!==x.a.local;var y=v&&this._isCacheExpired(v,n,l,g);return a||!v||y&&!i?p().then(function(e){var o=(new Date).valueOf();return _[n]={_fetched:o,_value:e},d&&t._store.setValue(n,o-1,x.a.local),t._updateCache(),f?{data:e,cacheStats:{lastModified:NaN,lastRead:o,reads:NaN}}:e}):s.a.resolve(b())},e.prototype.getRequestKey=function(e,t,n){var o=[];return o.push(e),o.push(t),n&&o.push(n.toString()),o.join(",")},e.prototype.isCachedDataInvalidated=function(e){var t=this._cache[e];return this._isCachedDataInvalidated(t,e)},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0}),e.prototype.flushCache=function(e){e?(delete this._cache[e],this._updateCache()):this._clearCache()},e.prototype._initCache=function(){this._version!==this._store.getValue(this.cacheVersionId,void 0,!1)?(this._clearCache(),this._store.setValue(this.cacheVersionId,this._version,void 0,!1)):this._cache=this._store.getValue(this.cacheId,void 0,!1)||{}},e.prototype._updateCache=function(){this._store.setValue(this.cacheId,this._cache,void 0,!1)},e.prototype._clearCache=function(){this._cache={},this._updateCache()},e.prototype._isCacheExpired=function(e,t,n,o){if(n&&this._isCachedDataInvalidated(e,t))return!0;var i=(new Date).valueOf()-o;return e._fetched<=i},e.prototype._isCachedDataInvalidated=function(e,t){var n=Number(this._store.getValue(t,x.a.local));return!!(e&&n&&e._fetched<n)},e}(),C=function(e){function t(t,n){var o=e.call(this,t,n)||this,r=n.pageContext;o._legacyRequestCache=new w(t,{pageContext:r}),t.cacheType;var a=Object(i.__rest)(t,["cacheType"]);return o._persistentRequestCache=new v.a(a,{pageContext:r}),o}return Object(i.__extends)(t,e),t.prototype.getDataUtilizingLegacyCache=function(e){var t=this,n=e,o=n.getUrl,r=n.getAdditionalPostData,a=n.cacheRequestKey,s=n.cacheTimeoutTime,c=Object(i.__rest)(n,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime"]);(c=Object(i.__assign)({url:o&&o(),additionalPostData:r&&r(),method:"POST"},c)).url=c.url||o&&o(),"needsRequestDigest"in c||(c.needsRequestDigest=this.needsRequestDigest(c.url)),c.additionalPostData=c.additionalPostData||r&&r(),a=a||this.getRequestKey(c.url,c.method,c.additionalPostData);var u=e.useStale,l=void 0!==u&&u,d=e.bypassCache,p=void 0!==d&&d,h=e.onlyCache,g=void 0!==h&&h,m=e.checkForInvalidation,f=void 0!==m&&m,_=e.setInvalidated,v=void 0!==_&&_;return this._legacyRequestCache.getDataUtilizingCache({cacheRequestKey:a,useStale:l,bypassCache:p,onlyCache:g,checkForInvalidation:f,setInvalidated:v,cacheTimeoutTime:s,getData:function(){return t.dataRequestor.getData(c)}})},t.prototype.getDataUtilizingPersistentCache=function(e){var t=this,n=e,o=n.getUrl,r=n.getAdditionalPostData,a=n.cacheRequestKey,s=n.cacheTimeoutTime,c=n.returnStatistics,u=Object(i.__rest)(n,["getUrl","getAdditionalPostData","cacheRequestKey","cacheTimeoutTime","returnStatistics"]);(u=Object(i.__assign)({url:o&&o(),additionalPostData:r&&r(),method:"POST"},u)).url=u.url||o&&o(),"needsRequestDigest"in u||(u.needsRequestDigest=this.needsRequestDigest(u.url)),u.additionalPostData=u.additionalPostData||r&&r(),a=a||this.getRequestKey(u.url,u.method,u.additionalPostData);var l=e.cachingStrategy;return this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:l,cacheRequestKey:a,cacheTimeoutTime:s,getData:function(){return t.dataRequestor.getData(u)},returnStatistics:c})},t.prototype.isCachedDataInvalidated=function(e){return this._legacyRequestCache.isCachedDataInvalidated&&this._legacyRequestCache.isCachedDataInvalidated(e)},t.prototype.getRequestKey=function(e,t,n){return this._legacyRequestCache.getRequestKey(e,t,n)},Object.defineProperty(t.prototype,"cacheId",{get:function(){return this._legacyRequestCache.cacheId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cacheVersionId",{get:function(){return this._legacyRequestCache.cacheVersionId},enumerable:!0,configurable:!0}),t.prototype.flushCache=function(e){this._legacyRequestCache.flushCache(e),this._persistentRequestCache.flushCache(e)},t}(_),O=n("rmH8"),D=n.n(O),N=n("q/yJ"),E=n.n(N),L=n("iuY3"),T=n("mVz8"),F={ODB:1447},A={links:void 0,name:"",startingNodeKey:"",isAudienceEnabled:!1,isAudienceTargeted:!1,isAudienceAffected:!1},M=function(e){function t(t,n){var o=e.call(this,{id:"ViewNavDataSource"},{pageContext:t})||this;return o._mapProviderName=n,R()&&!t||(o._audiencesDataSource=L.a.getInstance(t)),o}return Object(i.__extends)(t,e),t.isRelativeUrl=function(e){return!!e&&!/^[a-z0-9+-.]+:\/\//i.test(e)&&-1===e.indexOf("/_layouts/15/groupstatus.aspx?")},t.shouldLinkOpenInSameWindow=function(e){if(!e)return!1;var t=new E.a(e),n=t.getScheme()+"://"+t.getAuthority();return(""===t.getScheme()&&""===t.getAuthority()||n===window.location.origin)&&-1===e.indexOf("/_layouts/15/groupstatus.aspx?")},t.transformNodesToLinks=function(e,t,n){var o=function(e,i){return n&&(e=e.filter(function(e){return n(e,i)})),e.map(function(e){return{name:e.Title,key:e.Id.toString(),url:e.Url,onClick:t,isDocLib:e.IsDocLib,links:e.Children&&e.Children.length?o(e.Children,i+1):void 0,audiences:e.AudienceIds||void 0,currentLCID:e.CurrentLCID}})};return o(e=e||[],0)},t.getAreaNavigationSettingsUrl=function(e){return e.webAbsoluteUrl+"/_layouts/15/AreaNavigationSettings.aspx"},t.prototype.setGlobalNavEnabled=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/navigation/SetGlobalNavEnabled?isEnabled="+e;return this.dataRequestor.getData({url:t,qosName:"SetGlobalNavEnabled",method:"POST",noRedirect:!0})},t.prototype.getGlobalNavEnabled=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return e._pageContext.webAbsoluteUrl+"/_api/navigation/GlobalNavEnabled"},parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.GlobalNavEnabled},qosName:"getGlobalNavEnabled",method:"GET",noRedirect:!0})},t.prototype.getGlobalNav=function(e,n){var o=this,i=new l.Qos({name:"GlobalNavigation"}),r=this._pageContext.webAbsoluteUrl+"/_api/navigation/GlobalNav";n&&(r+="?source='"+n+"'");var a={url:r,qosName:"GetGlobalNavigation",parseResponse:function(e){var t=JSON.parse(e);return o._transformToNavLinkGroup(t,!1,i,!0)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1,crossSiteCollectionCall:!0,cachingStrategy:e?3:0,noRedirect:!0};return this.getDataUtilizingPersistentCache(a).then(function(e){return(!P()||e)&&e.isAudienceEnabled&&e.isAudienceTargeted?o._audiencesDataSource.filter("GlobalNav",e.links,"links").then(function(n){var o=t.checkIfLinksAffected(e.links,n);return e.links=n||[],e.isAudienceAffected=o,e}):e})},t.prototype.isNavAudienceTargetedEnabled=function(){var e;return Boolean(this._pageContext.webPropertyFlags2?this._pageContext.webPropertyFlags2&t.NAV_AUDIENCE_TARGET_FLAG:null===(e=this._pageContext.navigationInfo)||void 0===e?void 0:e.isAudienceTargeted)},t.prototype.getMenuState=function(e){var n=this;void 0===e&&(e={});var o=new l.Qos({name:"NavigationGetMenuState"}),i=e.providerName,r=void 0===i?this._mapProviderName:i,a=e.isGlobalNav,s=e.useCache,c=e.forceRefresh,u=e.menuNodeKey,d=e.maxRetries,p=void 0===d?1:d,h=e.depth,g=void 0===h?3:h,m=e.skipAudienceFiltering,f=e.audienceFilterNodeKey,_=s?"getMenuStateUsingCache":"getMenuState",v="";r=r||this._mapProviderName,u?(v+="?menuNodeKey='"+u+"'",r&&(v+="&mapProviderName='"+r+"'")):(a||r)&&(v+="?menuNodeKey="+(a?"1002":""),r&&(v+="&mapProviderName='"+r+"'")),D.a.isFeatureEnabled(F)&&v&&v.length>0&&(v+="&depth='"+g+"'");var b,y={url:this._pageContext.webAbsoluteUrl+"/_api/navigation/MenuState"+v,qosName:_,parseResponse:function(e){var t=JSON.parse(e);return n._transformToNavLinkGroup(t,Boolean(m),o)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:p,crossSiteCollectionCall:!0,cachingStrategy:c?3:0,noRedirect:!0};return b=s?this.getDataUtilizingPersistentCache(y).then(function(e){return P()?e:e||A}):this.dataRequestor.getData(y),P()?m||R()&&!this._audiencesDataSource||!(j()?this._audiencesDataSource.isAudienceTargetedNavEnabledBasedOnWebProperty():this.isNavAudienceTargetedEnabled())?b:b.then(function(e){return e&&n._isGroupAudienceTargeted(e)?("13b7c916-4fea-4bb2-8994-5cf274aeb530"===e.name&&e.links&&f&&(R()?L.a.containsAudienceTargetedNode(e.links.filter(function(e){return e.name===f})):n._audiencesDataSource.containsAudiences(e.links.filter(function(e){return e.name===f}),"links"))&&T.Engagement.logData({name:"FooterNav.AudienceTargeting"}),(R()?n._audiencesDataSource.filterLinks(e.links):n._audiencesDataSource.filter("SiteNav",e.links,"links")).then(function(t){return e.links=t||[],e})):e}):b.then(function(e){return e.isAudienceEnabled&&e.isAudienceTargeted?(R()?n._audiencesDataSource.filterLinks(e.links):n._audiencesDataSource.filter("SiteNav",e.links,"links")).then(function(n){var o=t.checkIfLinksAffected(e.links,n);return e.links=n||[],e.isAudienceAffected=o,e}):e})},t.checkIfLinksAffected=function(e,t){return I(e)!==I(t)},t.prototype.clearCache=function(){this.flushCache()},t.prototype._transformToNavLinkGroup=function(e,t,n,o){if(!e||!e.Nodes||0===e.Nodes.length)return n.end({resultType:l.ResultTypeEnum.ExpectedFailure,error:"getMenuState empty MenuState"}),P()?void 0:A;try{var i=this._getLinksFromNodes(e.Nodes,e.FriendlyUrlPrefix),r={isAudienceEnabled:!P()&&!t&&(o?e.IsAudienceTargetEnabledForGlobalNav:j()?this._audiencesDataSource.isAudienceTargetedNavEnabledBasedOnWebProperty():this.isNavAudienceTargetedEnabled()),isAudienceTargeted:(P()||!t)&&(R()?L.a.containsAudienceTargetedNode(i):this._audiencesDataSource.containsAudiences(i,"links")),isAudienceAffected:!1,name:e.StartingNodeTitle||"",links:i,startingNodeKey:e.StartingNodeKey};return n.end({resultType:l.ResultTypeEnum.Success}),r}catch(e){return n.end({resultType:l.ResultTypeEnum.Failure,error:e?e.toString():"getMenuState failed"}),P()?void 0:A}},t.prototype._getLinksFromNodes=function(e,n){var o=this,i=function(e,r,a){e=e.filter(function(e){return"1033"!==e.Key&&-1===e.Key.indexOf("SPNavigationNodeId=1033")&&!e.IsDeleted&&!e.IsHidden});var s=a?a+"/":"";return e.map(function(e){var a=r&&s+r.FriendlyUrlSegment,c=o._getUrl(e,!!r,n,a);return{name:e.Title,url:c,key:e.Key,ariaLabel:e.Title,isExpanded:!1,hasChildLinks:e.CustomProperties?"True"===o._getCustomPropertyValue(e.CustomProperties,"HasChildNodes"):void 0,target:t.shouldLinkOpenInSameWindow(c)?"":"_blank",links:e.Nodes&&e.Nodes.length?i(e.Nodes,e,a):void 0,audiences:e.AudienceIds&&e.AudienceIds.length>0?e.AudienceIds:void 0,currentLCID:e.CurrentLCID}})};return i(e||[])},t.prototype._getCustomPropertyValue=function(e,t){for(var n=e.length-1;n>0;n--)if(e[n].Key===t)return e[n].Value;return""},t.prototype._getUrl=function(e,t,n,o){return e.SimpleUrl?e.SimpleUrl:(1===e.NodeType&&e.FriendlyUrlSegment&&(i=(i=t?n+(o?"/"+o:"")+"/"+e.FriendlyUrlSegment:n+e.FriendlyUrlSegment).replace("//","/")),i);var i},t.prototype._isGroupAudienceTargeted=function(e){return!!e.isAudienceTargeted||!("13b7c916-4fea-4bb2-8994-5cf274aeb530"!==e.name||!e.links)&&(R()?L.a.containsAudienceTargetedNode(e.links):this._audiencesDataSource.containsAudiences(e.links,"links"))},t.NAV_AUDIENCE_TARGET_FLAG=8388608,t}(C);function I(e){if(!e)return 0;for(var t=e.length,n=0,o=e;n<o.length;n++)t+=I(o[n].links);return t}function P(){return r.Killswitch.isActivated("1cd2d1c9-fdc8-4110-a71e-e8125063dd90","2020-09-01","Refine the audience targeting logging")}function j(){return r.Killswitch.isActivated("0f107c60-6b6a-448f-9a43-4ff118ed3900","2020-09-15","Leverage the check nav audience target method from ViewNavDataSource")}function R(){return r.Killswitch.isActivated("9133138a-4936-4249-b925-7a3825c5d068")}},gcRq:function(e,t,n){var o=n("K9kD");for(var i in e.exports={},o)o.hasOwnProperty(i)&&(e.exports[i]=o[i]);e.exports.default=o.Promise,Object.defineProperty(e.exports,"__esModule",{value:!0})},iuY3:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var o=n("17wl"),i=n("gcRq"),r=n.n(i);function a(){if(!window||!window.localStorage)throw new Error("localStorage is not supported")}function s(e){return"MembershipsCache_"+e}var c=function(){function e(e){this._getData=e}return e.getInstance=function(t){return e._instance||(e._instance=new e(t)),e._instance},e.prototype.filter=function(e,t,n,o,i){var a=this;return o?this.getCurrentUserMemberships(e,t,n).then(function(e){return a.filterWithMembership(e,o,i)}).catch(function(){return a.filterWithMembership([],o,i)}):r.a.resolve(void 0)},e.prototype.filterWithMembership=function(e,t,n){var i=this;if(!t)return t;var r=t.filter(function(t){return!function(e){return Boolean(e.audiences&&e.audiences.length>0&&"00000000-0000-0000-0000-000000000000"!==e.audiences[0])}(t)||function(e,t){var n=e.audiences;if(!n)return!1;for(var o=0;o<n.length;o++)if(-1!==t.indexOf(n[o]))return!0;return!1}(t,e)});return n&&(r=r.map(function(t){var r;return Object(o.__assign)(Object(o.__assign)({},t),((r={})[n]=i.filterWithMembership(e,t[n],n),r))})),r},e.prototype.getCurrentUserMemberships=function(e,t,n){var o=this,i=function(e){a();var t=window.localStorage.getItem(s(e));if(t){var n=JSON.parse(t);if(n&&n.lastModified&&Date.now()-n.lastModified<=72e5)return n.data}}(e);if(i)return r.a.resolve(i);if(!this._getMembershipsPromise){var c=t+"/_api/SP.Publishing.SitePageService.GetCurrentUserMemberships"+(n?"?scenario='"+n+"'":"");this._getMembershipsPromise=this._getData(c,n).then(function(t){return o._getMembershipsPromise=void 0,t&&function(e,t){if(a(),t){var n={data:t,lastModified:Date.now()};window.localStorage.setItem(s(e),JSON.stringify(n))}else window.localStorage.removeItem(e)}(e,t),t})}return this._getMembershipsPromise},e}(),u=n("68aR"),l=n.n(u),d=n("P1BV"),p=n("U6GQ"),h=n("extd"),g=function(){function e(e){var t=this;this._getDataFromAPI=function(e,n){var o={url:e,qosName:n?"getUserMembershipsForAudienceTargeting."+n:"getUserMembershipsForAudienceTargeting",cacheRequestKey:t._cacheRequestKey,parseResponse:function(e){return e&&JSON.parse(e).value||[]},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1};return t._dataRequestor.getData(o)},this._pageContext=e,this._dataRequestor=new h.DataRequestor({qosName:"AudiencesDataSource"},{pageContext:e}),this._cache=new p.a({id:"AudiencesDataSource",cacheType:0},{pageContext:e}),this._cacheRequestKey=e.aadUserId||e.userLoginName}return e.getInstance=function(t){if(d.Killswitch.isActivated("f7fd618b-1552-46ab-a5ed-482958f81075"))return new e(t);var n=t.aadUserId||t.userLoginName;return e._instances[n]||(e._instances[n]=new e(t)),e._instances[n]},e.linkContainsAudiences=function(e){return m(e)},e.prototype.containsAudiences=function(e,t){if(!e)return!1;if(e.filter(m).length>0)return!0;if(t)for(var n=0,o=e;n<o.length;n++){var i=o[n];if(this.containsAudiences(i[t],t))return!0}return!1},e.containsAudienceTargetedNode=function(e){var t=this;return!!e&&(e.filter(m).length>0||e.filter(function(e){return t.containsAudienceTargetedNode(e.links)}).length>0)},e.prototype.saveAudienceTargetSetting=function(e){var t=this,n={bypassCache:!0,url:this._pageContext.webAbsoluteUrl+"/_api/web",qosName:"saveNavAudienceTargetingEnabled",method:"POST",additionalHeaders:{"X-HTTP-Method":"MERGE"},additionalPostData:JSON.stringify({NavAudienceTargetingEnabled:e,__metadata:{type:"SP.Web"}})};return this._cache.getDataUtilizingCache({cacheRequestKey:this._cacheRequestKey,cachingStrategy:0,cacheTimeoutTime:f()?void 0:72e5,getData:function(){return t._dataRequestor.getData(n)}})},e.prototype.isAudienceTargetedNavEnabledBasedOnWebProperty=function(){return this._pageContext&&void 0===this._pageContext.webPropertyFlags2?Boolean(this._pageContext&&this._pageContext.navigationInfo&&this._pageContext.navigationInfo.isAudienceTargeted):Boolean(this._pageContext&&this._pageContext.webPropertyFlags2&&0!=(this._pageContext.webPropertyFlags2&e.NAV_AUDIENCE_TARGETING_ENABLED))},e.prototype.filterLinks=function(t){return t?this.getCurrentUserMemberships("SiteNav").then(function(n){return e.filterLinksWithMemberships(t,n)}).catch(function(n){return e.filterLinksWithMemberships(t,[])}):r.a.resolve(void 0)},e.prototype.filter=function(e,t,n){var o=this;return _()?t?this.getCurrentUserMemberships(e).then(function(e){return o.filterWithMembership(e,t,n)}).catch(function(){return o.filterWithMembership([],t,n)}):r.a.resolve(void 0):c.getInstance(this._getDataFromAPI).filter(this._cacheRequestKey,this._pageContext.webAbsoluteUrl,e,t,n)},e.filterItemsWithMemberships=function(t,n){return e._filterRecursively(new Set(n),t)},e.prototype.filterWithMembership=function(e,t,n){var i=this;if(_()){if(!t)return t;var r=t.filter(function(t){return!m(t)||function(e,t){var n=e.audiences;if(!n)return!1;for(var o=0;o<n.length;o++)if(-1!==t.indexOf(n[o]))return!0;return!1}(t,e)});return n&&(r=r.map(function(t){var r;return Object(o.__assign)(Object(o.__assign)({},t),((r={})[n]=i.filterWithMembership(e,t[n],n),r))})),r}return c.getInstance(this._getDataFromAPI).filterWithMembership(e,t,n)},e.filterLinksWithMemberships=function(t,n){return e._filterRecursively(new Set(n),t,function(e){return e.links},function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{links:t})})},e.getGroupObjectId=function(e){return e.userId&&e.userId.length>=36?e.userId.substr(e.userId.length-36):void 0},e.prototype.getCurrentUserMemberships=function(e){var t=this,n=this._pageContext.webAbsoluteUrl;if(window&&window.location&&window.location.origin&&-1===n.indexOf(window.location.origin)&&(n=window.location.origin),_()){var o={url:n+"/_api/SP.Publishing.SitePageService.GetCurrentUserMemberships"+(e?"?scenario='"+e+"'":""),qosName:e?"getUserMembershipsForAudienceTargeting."+e:"getUserMembershipsForAudienceTargeting",cacheRequestKey:this._cacheRequestKey,parseResponse:function(e){return e&&JSON.parse(e).value||[]},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1};return this._cache.getDataUtilizingCache({cacheRequestKey:this._cacheRequestKey,cachingStrategy:0,cacheTimeoutTime:f()?void 0:72e5,getData:function(){return t._dataRequestor.getData(o)}})}return c.getInstance(this._getDataFromAPI).getCurrentUserMemberships(this._cacheRequestKey,n,e)},e._filterRecursively=function(t,n,o,i){if(!n)return n;var r=n.filter(function(e){var n;return!m(e)||(null===(n=e.audiences)||void 0===n?void 0:n.some(function(e){return t.has(e)}))});return o&&i&&(r=r.map(function(n){var r=o(n),a=e._filterRecursively(t,r,o,i);return i(n,a)})),r},e.NAV_AUDIENCE_TARGETING_ENABLED=8388608,e._instances={},e}();function m(e){return Boolean(e.audiences&&e.audiences.length>0&&e.audiences[0]!==l.a.Empty)}function f(){return d.Killswitch.isActivated("463ac4ec-c850-4547-aaf4-9b4c8992d79e")}function _(){return d.Killswitch.isActivated("45b0162c-3bdb-469a-888b-cf1a1961187f")}},lgIK:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a});var o,i=3e5,r=864e5,a="odsp-ds-";!function(e){e[e.useCacheAndUpdateInTheBackground=0]="useCacheAndUpdateInTheBackground",e[e.useCacheIfNotExpired=1]="useCacheIfNotExpired",e[e.onlyCache=2]="onlyCache",e[e.bypassCache=3]="bypassCache"}(o||(o={}))},mVz8:function(e,t,n){var o=n("K9kD");for(var i in e.exports={},o)o.hasOwnProperty(i)&&(e.exports[i]=o[i]);e.exports.default=o.Engagement,Object.defineProperty(e.exports,"__esModule",{value:!0})},mY0q:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var o=n("J7xF"),i=n("0/Fd"),r=n("17wl"),a=n("4xRo"),s=n.n(a),c=n("S7CW"),u=Object(o.styled)(i.a,function(e){var t=e.theme,n=t.fonts,o=t.semanticColors,i=s.a.isFeatureEnabled({ODB:1248,Fallback:!1});return{simpleFooterContainer:{backgroundColor:o.bodyBackground,zIndex:13,minHeight:48,display:"flex",flexWrap:"wrap",justifyContent:"space-between",height:"auto",overflow:"hidden",padding:"0 24px"},simpleFooterLogoSlot:{display:"flex",fontWeight:Object(c.a)(t).semibold.fontWeight,selectors:{".simpleFooterNameItem":{fontSize:i?n.medium.fontSize:16,fontWeight:Object(c.a)(t).semibold.fontWeight,margin:i?"14px 0 10px 0":"14px 0",lineHeight:i?"1.4em":"18px"},".simpleFooterLogoItem":{margin:i?"8px 0 4px 0":"8px 0",maxHeight:32,selectors:{a:{maxHeight:32}},lineHeight:i?"1.4em":"18px"}}},simpleFooterLogoImage:{maxHeight:32,marginRight:8},simpleFooterLinkSlots:{padding:0,display:"flex",flexWrap:"wrap"},simpleFooterItem:Object(r.__assign)(Object(r.__assign)({lineHeight:i?"19px":"18px",textAlign:"left",color:o.bodyText},n.medium),{margin:"14px 24px 14px 0",display:"flex",alignItems:"center",selectors:{a:{color:"inherit",textDecoration:"none",selectors:{":hover":{color:o.actionLinkHovered,textDecoration:"underline"}}},":last-of-type":{marginRight:0}}}),simpleFooterEditItem:Object(r.__assign)(Object(r.__assign)({border:"none",background:"none",color:o.link,cursor:"pointer",padding:0,textDecoration:"none"},n.medium),{selectors:{":hover":{color:o.linkHovered,textDecoration:"underline"}},lineHeight:i?"19px":"normal"})}})},qIay:function(e,t,n){var o=n("K9kD");e.exports=o.StringHelper},qqkQ:function(e,t,n){var o=n("KL1q");for(var i in e.exports={},o)o.hasOwnProperty(i)&&(e.exports[i]=o[i]);Object.defineProperty(e.exports,"__esModule",{value:!0})},rmH8:function(e,t,n){var o=n("K9kD");for(var i in e.exports={},o)o.hasOwnProperty(i)&&(e.exports[i]=o[i]);e.exports.default=o.Features,Object.defineProperty(e.exports,"__esModule",{value:!0})},tpox:function(e,t,n){"use strict";n.r(t),n.d(t,"CompositeFooter",function(){return x});var o=n("17wl"),i=n("cDcd"),r=n("Aboe"),a=n("fj7e"),s=n("Ol9Z"),c=n("mVz8"),u=n("iuY3"),l=n("P1BV"),d=n("wQUy"),p=n("4xRo"),h=n.n(p),g=n("z/Mt"),m=n("mcHn"),f=n("J7xF"),_=n("ybkr"),v=function(e){function t(t){var n=e.call(this,t)||this;return n._deferLoadComponent=function(){!n.state.ComponentModule&&n.props.moduleLoader&&n.props.modulePath&&n.props.moduleLoader.load(n.props.modulePath,n.props.getModule).then(function(e){if(n.props.moduleLoader.parse&&(e=n.props.moduleLoader.parse(e)),!e){var t="ReactDeferredComponent: component not found when loading "+n.props.modulePath+" - check your load and parse functions";console.error(t)}n._mounted?n.setState({ComponentModule:e}):n.state={ComponentModule:e}})},n._mounted=!1,n.state={ComponentModule:void 0},n._setupDeferLoadCallback(t),n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.state.ComponentModule;return t?i.createElement(t,Object(o.__assign)({ref:function(t){t&&Object(_.hoistMethods)(e,t)}},this.props.props),this.props.children):this.props.placeHolder||null},t.prototype.componentDidMount=function(){this._mounted||(this._mounted=!0)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._setupDeferLoadCallback(e)},t.prototype._setupDeferLoadCallback=function(e){var t=e.customWaiter;t?t.then(this._deferLoadComponent):this._deferLoadComponent()},t}(i.Component),b=n("+ky/"),y=n("mY0q");function k(e,t,n,i){var r={footerStrings:t,pageContext:i};if(n&&(r.theme=n),e&&Array.isArray(e))for(var a=0,s=e;a<s.length;a++){var c=s[a];c&&("2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100"===c.name?r.logo=Object(o.__assign)(Object(o.__assign)({},r.logo),{srcImgUrl:c.url}):"7376cd83-67ac-4753-b156-6a7b3fa0fc1f"===c.name?c.links&&c.links.length&&(r.logo=Object(o.__assign)(Object(o.__assign)({},r.logo),{name:c.links[0].name})):"3a94b35f-030b-468e-80e3-b75ee84ae0ad"===c.name&&(r.links=c.links))}return r}var x=function(e){function t(t){var n=e.call(this,t)||this;return n._onEditNavClicked=function(e,t,o){var i=n._getNavNodeKey();n._getFooterNavNodes(i,!0,n.props.pageContext).then(function(e){e.name=i,e.links=e.links||[],n.props.onEditNavClicked(e,t,o)})},n._updateFooterFromServerData=function(e){void 0===e&&(e=n.props.pageContext);var t=new d.Qos({name:"CompositeFooter.GetFooterNodes"});n._getFooterNavNodes("13b7c916-4fea-4bb2-8994-5cf274aeb530",!1,e).then(function(e){var o,i,r;n.setState({footerLinks:e?e.links:void 0}),n._isFooterTitleAndLogoPreviewKSActive()&&void 0===n.state.footerLinks||(n._originalNameAndLogoLinks=n._getLogoAndNameLinks(n.state.footerLinks)),t.end({resultType:d.ResultTypeEnum.Success}),S()||c.Engagement.logData({name:"FooterNav.Render",extraData:{audienceTargetingEnabled:Boolean(null===(o=e)||void 0===o?void 0:o.isAudienceEnabled).toString(),audienceTargetingProvided:Boolean(null===(i=e)||void 0===i?void 0:i.isAudienceTargeted).toString(),audienceTargetingAffected:Boolean(null===(r=e)||void 0===r?void 0:r.isAudienceAffected).toString()}})}).catch(function(e){console.error("Error fetching footer nodes"),t.end({resultType:d.ResultTypeEnum.Failure,error:"Failed to get footer nodes: "+e})})},n._setDisplayedLinks=function(e){u.a.getInstance(n.props.pageContext).filterLinks(e).then(function(e){n.setState({footerLinks:e})})},n._isAudienceTargeted=function(e){var t=u.a.getInstance(n.props.pageContext),o=new a.a(n.props.pageContext);return u.a.containsAudienceTargetedNode(e)&&(l.Killswitch.isActivated("0f107c60-6b6a-448f-9a43-4ff118ed3900")?t.isAudienceTargetedNavEnabledBasedOnWebProperty():o.isNavAudienceTargetedEnabled())},n._isShowingPreview=!1,n._isFooterTitleAndLogoPreviewKSActive()&&void 0===n.props.footerNavigationNodes||(n._originalNameAndLogoLinks=n._getLogoAndNameLinks(n.props.footerNavigationNodes)),n.state={footerLinks:n.props.footerNavigationNodes||[],theme:Object(g.getVariant)(t.theme||Object(m.getTheme)(),n._getEmphasis(t.chromeOptions))},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.footerNavigationNodes||this._updateFooterFromServerData(),this.props.footerNavigationNodes&&this._isAudienceTargeted(this.props.footerNavigationNodes)&&this._setDisplayedLinks(this.props.footerNavigationNodes)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.footerNavigationNodes&&(this._isAudienceTargeted(e.footerNavigationNodes)?this._setDisplayedLinks(e.footerNavigationNodes):this.setState({footerLinks:e.footerNavigationNodes})),!this._isFetchLinksSiteNavigationKSActive()&&this.props.pageContext&&e.pageContext&&(this.props.pageContext.siteId===e.pageContext.siteId&&this.props.pageContext.webId===e.pageContext.webId||this._updateFooterFromServerData(e.pageContext));var t=this._isFooterTitleAndLogoPreviewKSActive()?e.footerLinks&&2===e.footerLinks.length:Boolean(e.footerLinks)||!Boolean(e.footerLinks)&&Boolean(this.props.footerLinks);(t||void 0===e.footerLinks&&this._isShowingPreview)&&(this._handleFooterNameOrLogoChange(e.footerLinks||this._originalNameAndLogoLinks),this._isShowingPreview=t),e.chromeOptions&&e.chromeOptions.footer&&this.setState({theme:Object(g.getVariant)(e.theme||Object(m.getTheme)(),this._getEmphasis(e.chromeOptions))})},t.prototype.render=function(){if(this._isFooterEnabled){var e=this.state.footerLinks,t=this._getFooterLayout(),n=t===r.b.SIMPLE,a=t===r.b.EXTENDED,s=this.state.theme;if(n&&!this.props.simpleFooterStrings)return console.error("simpleFooterStrings must not be undefined when rendering the SimpleFooter layout"),null;if(a&&!this.props.megaFooterStrings)return console.error("megaFooterStrings must not be undefined when rendering the MegaFooter layout"),null;if(a)return this._megaFooterProps=function(e,t,n){var i={footerStrings:t};if(n&&(i.theme=n),e&&Array.isArray(e))for(var r=0,a=e;r<a.length;r++){var s=a[r],c=h.a.isFeatureEnabled({ODB:1539})?"3a94b35f-030b-468e-80e3-b75ee84ae0ad":"47a59018-dcc3-4e98-a14e-146bc4001628";s&&("2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100"===s.name?i.logo=Object(o.__assign)(Object(o.__assign)({},i.logo),{srcImgUrl:s.url}):"7376cd83-67ac-4753-b156-6a7b3fa0fc1f"===s.name?s.links&&s.links.length&&(i.logo=Object(o.__assign)(Object(o.__assign)({},i.logo),{name:s.links[0].name})):s.name===c&&(i.sections=s.links?s.links.map(function(e){return{heading:{name:e.name,url:e.url},linkKey:e.key,items:e.links}}):[]))}return i}(e,this.props.megaFooterStrings,s),this._isLayoutDeferLoadingKSActive()?i.createElement(b.a,Object(o.__assign)({},this._megaFooterProps,{pageContext:this.props.pageContext,onEditNavClicked:this._onEditNavClicked,onFooterLinksUpdated:this._updateFooterFromServerData})):this._getDeferredMegaFooter(Object(o.__assign)(Object(o.__assign)({},this._megaFooterProps),{pageContext:this.props.pageContext,onEditNavClicked:this._onEditNavClicked,onFooterLinksUpdated:this._updateFooterFromServerData}));if(n)return this._simpleFooterProps={footerStrings:void 0},this._isFooterCustomized(this.state.footerLinks)?this._simpleFooterProps=k(this.state.footerLinks,this.props.simpleFooterStrings,s):this._simpleFooterProps=k(this.props.enableMobileUpsell?this._getDefaultLinks():[],this.props.simpleFooterStrings,s),this._isLayoutDeferLoadingKSActive()?i.createElement(y.a,Object(o.__assign)({},this._simpleFooterProps,{pageContext:this.props.pageContext,onEditNavClicked:this._onEditNavClicked,onFooterLinksUpdated:this._updateFooterFromServerData})):this._getDeferredSimpleFooter(Object(o.__assign)(Object(o.__assign)({},this._simpleFooterProps),{pageContext:this.props.pageContext,onEditNavClicked:this._onEditNavClicked,onFooterLinksUpdated:this._updateFooterFromServerData}))}return null},t.prototype._getDeferredMegaFooter=function(e){var t={modulePath:"../MegaFooter/index",moduleLoader:{load:function(){return n.e(0).then(n.bind(null,"Cg+y")).then(function(e){return e.MegaFooter})}},props:e};return i.createElement("div",null,i.createElement(v,Object(o.__assign)({},t)))},t.prototype._getDeferredSimpleFooter=function(e){var t={modulePath:"../SimpleFooter/index",moduleLoader:{load:function(){return n.e(2).then(n.bind(null,"97Lx")).then(function(e){return e.SimpleFooter})}},props:e};return i.createElement(v,Object(o.__assign)({},t))},t.prototype._getFooterLayout=function(){var e=r.b.SIMPLE;return this.props.chromeOptions&&this.props.chromeOptions.footer&&this.props.chromeOptions.footer.layout&&(e=this.props.chromeOptions.footer.layout),e},t.prototype._getEmphasis=function(e){if(e&&e.footer)switch(e.footer.emphasis){case r.a.Neutral:return s.a.Neutral;case r.a.Soft:return s.a.Soft;case r.a.None:return s.a.None;default:return s.a.Strong}return s.a.Strong},t.prototype._getFooterNavNodes=function(e,t,n){if(n){var o=this._getNavNodeKey();return new a.a(n).getMenuState({menuNodeKey:e,skipAudienceFiltering:t,audienceFilterNodeKey:o}).then(function(e){return S()?{links:e&&e.links}:e})}Promise.reject("no page context")},t.prototype._getNavNodeKey=function(){return h.a.isFeatureEnabled({ODB:1539})?"3a94b35f-030b-468e-80e3-b75ee84ae0ad":this._getFooterLayout()===r.b.EXTENDED?"47a59018-dcc3-4e98-a14e-146bc4001628":"3a94b35f-030b-468e-80e3-b75ee84ae0ad"},Object.defineProperty(t.prototype,"_isFooterEnabled",{get:function(){return this.props.chromeOptions&&this.props.chromeOptions.footer?!this.props.chromeOptions.footer.hidden:!this.props.isFooterInitiallyHidden},enumerable:!0,configurable:!0}),t.prototype._handleFooterNameOrLogoChange=function(e){var t=this.state.footerLinks;if(!t){if(this._isFooterTitleAndLogoPreviewKSActive())return;t=[]}for(var n=!1,o=!1,i=e?e.filter(function(e){return e?"2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100"===e.name:void 0})[0]:void 0,r=e?e.filter(function(e){return e?"7376cd83-67ac-4753-b156-6a7b3fa0fc1f"===e.name:void 0})[0]:void 0,a=0;a<t.length&&(!n||!o);a++)t[a]&&"7376cd83-67ac-4753-b156-6a7b3fa0fc1f"===t[a].name&&(this._isFooterTitleAndLogoPreviewKSActive()||r)?(t[a]=r,o=!0):t[a]&&"2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100"===t[a].name&&(this._isFooterTitleAndLogoPreviewKSActive()||i)&&(t[a]=i,n=!0);n||!this._isFooterTitleAndLogoPreviewKSActive()&&!i||t.push(i),o||!this._isFooterTitleAndLogoPreviewKSActive()&&!r||t.push(r),this.setState({footerLinks:t})},t.prototype._getLogoAndNameLinks=function(e){var t=[];if(this._isFooterTitleAndLogoPreviewKSActive())t.push(e.filter(function(e){return"2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100"===e.name})[0]),t.push(e.filter(function(e){return"7376cd83-67ac-4753-b156-6a7b3fa0fc1f"===e.name})[0]);else{var n=e?e.filter(function(e){return e?"2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100"===e.name:void 0})[0]:void 0,o=e?e.filter(function(e){return e?"7376cd83-67ac-4753-b156-6a7b3fa0fc1f"===e.name:void 0})[0]:void 0;t.push(n||this._getDefaultLogoLink()),t.push(o||this._getDefaultTitleLink())}return t},t.prototype._getDefaultLogoLink=function(){return{name:"2e456c2e-3ded-4a6c-a9ea-f7ac4c1b5100",url:""}},t.prototype._getDefaultTitleLink=function(){return{name:"7376cd83-67ac-4753-b156-6a7b3fa0fc1f",url:void 0,links:[{name:"",url:void 0}]}},t.prototype._isFooterCustomized=function(e){return!(e&&1===e.length&&"3a94b35f-030b-468e-80e3-b75ee84ae0ad"===e[0].name&&!e[0].links)&&e&&e.length>0},t.prototype._getDefaultLinks=function(){return[{name:void 0,url:void 0,links:[{name:"",url:"",key:"defaultGetMobileAppNode",automationId:"simpleFooter-defaultGetMobileAppNode"}]}]},t.prototype._isFooterTitleAndLogoPreviewKSActive=function(){return l.Killswitch.isActivated("5a79c7c8-c34b-46d1-8bcd-76cc6c52443e","5/24/2020","fix footer title and logo live preview from CTL")},t.prototype._isLayoutDeferLoadingKSActive=function(){return l.Killswitch.isActivated("e00ef3fc-dcc1-4928-804d-e3ba73875ffa","6/5/2020","defer load footer layouts")},t.prototype._isFetchLinksSiteNavigationKSActive=function(){return l.Killswitch.isActivated("40fb01c7-93d4-4b11-aa2d-fe4457728d5c","08/17/2020","refetch links after in-place navigation across sites")},Object(o.__decorate)([Object(f.customizable)("CompositeFooter",["footerLinks","theme"])],t)}(i.Component);function S(){return l.Killswitch.isActivated("1cd2d1c9-fdc8-4110-a71e-e8125063dd90","2020-09-01","Refine the audience targeting logging")}},uN8c:function(e,t,n){var o=n("K9kD");for(var i in e.exports={},o)o.hasOwnProperty(i)&&(e.exports[i]=o[i]);e.exports.default=o.Qos,Object.defineProperty(e.exports,"__esModule",{value:!0})},wQUy:function(e,t,n){var o=n("K9kD");for(var i in e.exports={},o)o.hasOwnProperty(i)&&(e.exports[i]=o[i]);e.exports.default=o.Qos,Object.defineProperty(e.exports,"__esModule",{value:!0})},yCth:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var o=function(){function e(){}return e.hasItemPermission=function(t,n){return t&&t.permissions&&e.hasPermission(t.permissions,n)},e.hasPermission=function(e,t){return!!t&&!!e&&(t.Low&e.Low)>>>0===t.Low&&(t.High&e.High)>>>0===t.High},e.hasAny=function(t,n){return(n||[]).some(function(n){return e.hasPermission(t,n)})},e.hasIdentityPermission=function(t,n){return n&&t.webPermMasks&&e.hasPermission(t.webPermMasks,n)},e.insertListItems={High:0,Low:2},e.editListItems={High:0,Low:4},e.deleteListItems={High:0,Low:8},e.approveItems={High:0,Low:16},e.openItems={High:0,Low:32},e.viewVersions={High:0,Low:64},e.deleteVersions={High:0,Low:128},e.cancelCheckout={High:0,Low:256},e.manageLists={High:0,Low:2048},e.viewFormPages={High:0,Low:4096},e.reviewListItems={High:0,Low:16384},e.viewPages={High:0,Low:131072},e.layoutsPage={High:0,Low:135168},e.addAndCustomizePages={High:0,Low:262144},e.applyThemeAndBorder={High:0,Low:524288},e.viewUsageData={High:0,Low:2097152},e.manageSubwebs={High:0,Low:8388608},e.managePermissions={High:0,Low:33554432},e.browseDirectories={High:0,Low:67108864},e.manageWeb={High:0,Low:1073741824},e.useClientIntegration={High:16,Low:0},e.manageAlerts={High:64,Low:0},e.createAlerts={High:128,Low:0},e.enumeratePermissions={High:1073741824,Low:0},e.useRemoteAPIs={High:32,Low:0},e.fullMask={High:2147483647,Low:4294967295},e}()},ybkr:function(e,t,n){var o=n("fglE");e.exports=o._Utilities},"z/Mt":function(e,t,n){var o=n("wrw2");for(var i in e.exports={},o)o.hasOwnProperty(i)&&(e.exports[i]=o[i]);Object.defineProperty(e.exports,"__esModule",{value:!0})},zK8O:function(e,t,n){"use strict";var o;function i(e){switch(e){case o.CompositeHeader:return"SiteHeader";case o.HubNav:return"HubNav";case o.Footer:return"SiteFooter";default:return"UnknownSource"}}n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i}),function(e){e[e.Unknown=0]="Unknown",e[e.CompositeHeader=1]="CompositeHeader",e[e.HubNav=2]="HubNav",e[e.Footer=3]="Footer"}(o||(o={}))}}]);