(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[36],{"/OYS":function(e,t,n){"use strict";var o=n("17wl"),i=n("cDcd"),r=n("KL1q"),a=n("Yo/j"),s=i.lazy(function(){return Promise.all([n.e(6),n.e(35)]).then(n.bind(null,"Bx+e")).then(function(e){return{default:e.default}})});function c(e){return i.createElement(i.Suspense,{fallback:!1},i.createElement(s,Object(o.__assign)({},e)))}var _=n("Rrln"),d=n("m9Fc"),l=n("y88i"),u=n("M+LP"),m=n("XdGY"),p=n("T3po"),h=n("xs0R"),f=n("q+wp"),g=n("F5rs"),C=n("xvAL"),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onChange=function(e){f.default.logUserEngagementForPage(h.b.fields,!0,e?"CommentsEnable":"CommentsDisable"),a.a.setDisabled(!e).then(function(){a.a.clearComments(),e&&a.a.getComments()})},t}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=f.default.isNewPage(),t=i.createElement(p.a,{checked:!this.props.disabled,disabled:e,onAriaLabel:g.M,onText:g.P,offAriaLabel:g.N,offText:g.O,onChanged:this._onChange,"data-automation-id":this.props.disabled?"sp-comment-toggle-disabled":"sp-comment-toggle-enabled"});return e&&(t=i.createElement(r.TooltipHost,{content:g.Z,calloutProps:{gapSpace:0}},t)),i.createElement("div",{className:C.a.spToggleWrapper},t)},t}(i.Component),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=Object(u.a)(1248)&&!m.a.commentsFluent.isActivated()?Object(r.mergeStyles)(C.a.spHeader,C.a.fluent):C.a.spHeader;return i.createElement("div",null,i.createElement("h2",{className:e,id:"sp-comments"},l.StringHelper.format(l.StringHelper.getLocalizedCountValue(g.A,g.B,this.props.count),this.props.count)),this.props.isToggleVisible&&i.createElement(y,{disabled:this.props.disabled}))},t}(i.Component),L=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n._assignCommentReplyRef=function(e){t.topLevelReply=e},n._onLoadMore=function(){f.default.logUserEngagementForPage(h.b.fields,!0,"LoadMoreComments"),a.a.getNextComments(n.props.nextLink)},n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e;return this.props.disabledAtSiteOrTenant||this.props.disabled&&!this.props.isToggleVisible?i.createElement(i.Fragment,null):i.createElement("aside",{className:C.a.spCommentSection,role:"complementary","aria-label":g.d},i.createElement(b,{count:this.props.count,isToggleVisible:this.props.isToggleVisible,disabled:this.props.disabled}),this.props.isPublished?i.createElement("div",{className:C.a.spComments},i.createElement(d.a,{disabled:_.a.instance.disableEditing||this.props.disabled,ref:this._assignCommentReplyRef}),!this.props.disabled&&(null===(e=this.props.comments)||void 0===e?void 0:e.map(function(e){return i.createElement(c,{data:e,key:e.optimisticId||e.id})})),!this.props.disabled&&this.props.nextLink&&i.createElement(r.Link,{className:C.a.spMore,onClick:this._onLoadMore},g.S)):i.createElement("div",{className:C.a.spComments},i.createElement(r.Label,null,g.c)))},t}(i.Component);t.a=L},"2G27":function(e,t,n){"use strict";t.a=function(e){this.name="LikeLimitExceeded",this.message="User liked a comment with a maximal number of likes",this.message=e}},"4SPZ":function(e,t,n){(e.exports=n("5ADk")(!1)).push([e.i,'.l_e_ada2ac09{color:"[theme:neutralSecondaryAlt, default: #8a8886]"}[dir=ltr] .l_e_ada2ac09{margin-right:11px}[dir=rtl] .l_e_ada2ac09{margin-left:11px}.l_e_ada2ac09:hover{color:"[theme:themePrimary, default: #0078d4]"}[dir=ltr] .l_e_ada2ac09:last-child{margin-right:0}[dir=rtl] .l_e_ada2ac09:last-child{margin-left:0}.m_e_ada2ac09{color:"[theme:neutralSecondaryAlt, default: #8a8886]"}[dir=ltr] .m_e_ada2ac09{margin-right:0}[dir=rtl] .m_e_ada2ac09{margin-left:0}.m_e_ada2ac09:hover{color:"[theme:themePrimary, default: #0078d4]"}.n_e_ada2ac09{font-size:14px;font-weight:400;display:-ms-flexbox;display:flex;min-height:40px;-ms-flex-pack:justify;justify-content:space-between}.o_e_ada2ac09{visibility:hidden}.p_e_ada2ac09{font-size:14px;font-weight:400;color:"[theme:neutralDark, default: #201f1e]";font-weight:700}.q_e_ada2ac09{height:32px;min-width:32px;position:relative;width:32px}.r_e_ada2ac09{border-radius:17px;height:100%;width:100%}.s_e_ada2ac09{min-height:32px}.t_e_ada2ac09{margin:20px;width:100%}.u_e_ada2ac09{margin:14px 0}[dir=ltr] .u_e_ada2ac09 .v_e_ada2ac09{margin-left:41px}[dir=rtl] .u_e_ada2ac09 .v_e_ada2ac09{margin-right:41px}.u_e_ada2ac09 .v_e_ada2ac09:first-child,.v_e_ada2ac09{margin-top:14px}.v_e_ada2ac09 .w_e_ada2ac09 .x_e_ada2ac09{max-height:75px;min-height:32px;overflow-y:auto;white-space:pre-wrap}.mobile .v_e_ada2ac09 .w_e_ada2ac09 .x_e_ada2ac09{max-height:none}@media print{.v_e_ada2ac09 .w_e_ada2ac09 .x_e_ada2ac09{max-height:none}}.y_e_ada2ac09{-ms-flex:1;flex:1;line-height:1}[dir=ltr] .y_e_ada2ac09{margin-left:11px}[dir=rtl] .y_e_ada2ac09{margin-right:11px}.z_e_ada2ac09{display:-ms-flexbox;display:flex}.aa_e_ada2ac09{background-color:"[theme:white, default: #ffffff]";border-radius:17px;height:33px;opacity:.6;position:absolute;top:0;width:33px}.ab_e_ada2ac09{margin:0 7px 30px;-ms-flex-positive:1;flex-grow:1}.ac_e_ada2ac09{display:inline-block;margin-bottom:10px;margin-top:0}.ac_e_ada2ac09.ae_e_ada2ac09{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.ac_e_ada2ac09:not(.ae_e_ada2ac09){font-size:28px;font-weight:100}.x_e_ada2ac09{border-style:solid;border-width:1px;box-sizing:border-box;cursor:text;line-height:normal;outline:0;padding:5px 14px;word-break:break-word;word-wrap:break-word;-webkit-font-smoothing:antialiased}.x_e_ada2ac09.af_e_ada2ac09{background-color:"[theme:bodyBackground, default: #ffffff]";color:"[theme:neutralPrimary, default: #323130]";border-color:"[theme:neutralSecondary, default: #605e5c]"}.x_e_ada2ac09.af_e_ada2ac09:focus{border-color:"[theme:themePrimary, default: #0078d4]"}.x_e_ada2ac09.af_e_ada2ac09[disabled]{background-color:"[theme:infoBackground, default: #f4f4f4]";border-color:"[theme:infoBackground, default: #f4f4f4]";pointer-events:none;cursor:default}.x_e_ada2ac09.af_e_ada2ac09:hover{border-color:"[theme:neutralSecondaryAlt, default: #8a8886]"}.x_e_ada2ac09:not(.af_e_ada2ac09){background-color:"[theme:bodyBackground, default: #ffffff]";border-color:"[theme:neutralTertiaryAlt, default: #c8c6c4]";color:"[theme:neutralPrimary, default: #323130]"}.x_e_ada2ac09:not(.af_e_ada2ac09):hover{border-color:"[theme:neutralSecondaryAlt, default: #8a8886]"}.x_e_ada2ac09:not(.af_e_ada2ac09):focus{border-color:"[theme:themePrimary, default: #0078d4]"}.x_e_ada2ac09:not(.af_e_ada2ac09)[disabled]{background-color:"[theme:infoBackground, default: #f4f4f4]";border-color:"[theme:infoBackground, default: #f4f4f4]";pointer-events:none;cursor:default}.x_e_ada2ac09:empty:after{color:"[theme:neutralSecondary, default: #605e5c]";content:attr(placeholder);display:block}.x_e_ada2ac09[disabled]:empty:not(:focus):before{content:""}.ag_e_ada2ac09{font-size:11px;font-weight:400;color:"[theme:neutralSecondaryAlt, default: #8a8886]";padding-top:5px}.ah_e_ada2ac09{color:"[theme:error, default: #a80000]"}.ai_e_ada2ac09{color:"[theme:themePrimary, default: #0078d4]"}.ai_e_ada2ac09:hover{cursor:pointer;color:"[theme:themeDark, default: #005a9e]"}.aj_e_ada2ac09{margin-top:6px}.aj_e_ada2ac09>a,.aj_e_ada2ac09>label{font-size:12px;font-weight:400;color:"[theme:neutralSecondaryAlt, default: #8a8886]"}.ak_e_ada2ac09{margin-bottom:14px}.w_e_ada2ac09{font-size:14px;font-weight:400;display:-ms-flexbox;display:flex}@media print{.w_e_ada2ac09{display:none}}.al_e_ada2ac09{-ms-flex-negative:0;flex-shrink:0}.am_e_ada2ac09{font-size:17px;font-weight:300;color:"[theme:neutralPrimary, default: #323130]";font-weight:400;line-height:normal;margin-top:8px;word-break:break-word;word-wrap:break-word}.am_e_ada2ac09 .an_e_ada2ac09{display:block}.am_e_ada2ac09 .an_e_ada2ac09 a[data-sp-mention-user-id]{color:"[theme:themePrimary, default: #0078d4]";font-weight:lighter;text-decoration:none}.am_e_ada2ac09 .an_e_ada2ac09 a[data-sp-mention-user-id][access-type="1"]{font-weight:700}.am_e_ada2ac09 .an_e_ada2ac09 div{display:inline}.ao_e_ada2ac09{display:inline-block;margin:0 15px;vertical-align:middle}.ap_e_ada2ac09{width:288px}.aq_e_ada2ac09{top:50px}.ar_e_ada2ac09{padding:0 25px;overflow-x:hidden;overflow-y:auto}.as_e_ada2ac09{-ms-flex-negative:0;flex-shrink:0;padding:0 25px}.as_e_ada2ac09 .at_e_ada2ac09{font-size:21px;font-weight:300;line-height:48px;margin:0}@media screen and (min-width:640px){.t_e_ada2ac09{margin:20px 36px}}',""])},"D/Gr":function(e,t,n){"use strict";var o=n("Rrln"),i=n("i8gT"),r=function(){function e(e,t,n,o,i,r,a,s,c,_,d,l,u){this._isDeleted=!1,this._date=t,this._id=n,this._nextLink=o,this._parentId=i,this._text=r,this._replies=e,this._author=a,this._likeCount=s,this._userLiked=c,this._likedBy=_,this._nextLikesLink=d,this._serverObject=l,this._mentions=u,l||(this._optimisticId=n),this.sortReplies()}return Object.defineProperty(e.prototype,"date",{get:function(){return this._date},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optimisticId",{get:function(){return this._optimisticId},set:function(e){this._optimisticId=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFromServer",{get:function(){return!!this._serverObject},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextLink",{get:function(){return this._nextLink},set:function(e){this._nextLink=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentId",{get:function(){return this._parentId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"replies",{get:function(){return this._replies},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"author",{get:function(){return this._author},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"likeCount",{get:function(){return this._likeCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"likedBy",{get:function(){return this.userLiked?[o.a.instance.user].concat(this._likedBy||[]):this._likedBy},set:function(e){this._likedBy=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextLikesLink",{get:function(){return this._nextLikesLink},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mentions",{get:function(){return this._mentions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userLiked",{get:function(){return this._userLiked},enumerable:!0,configurable:!0}),e.prototype.addReply=function(e){this._replies.push(e),this._latestDate=void 0},e.prototype.equals=function(e){return this.id===e.id},e.prototype.hasMoreLikes=function(){return Boolean(this._nextLikesLink)},e.prototype.isDeleted=function(){return this._isDeleted},e.prototype.isReply=function(){return"0"!==this._parentId},e.prototype.latestDate=function(){return this._latestDate||(this._latestDate=this._replies&&this._replies.length?this._replies[this._replies.length-1].date:this._date)},e.prototype.markDeleted=function(){this._isDeleted=!0},e.prototype.moreReplies=function(){return!!this._nextLink},e.prototype.processLikeChunk=function(e){var t=this;this._nextLikesLink=e["@odata.nextLink"],i.a.allLikesFetched(this._nextLikesLink)&&(this._nextLikesLink=void 0);var n=e.likes||[];this.userLiked&&(n=n.filter(function(e){return!o.a.isCurrentUser(e)})),n=n.filter(function(e){return!t._alreadyLiked(e)}),this._likedBy=(this._likedBy||[]).concat(n)},e.prototype.removeReply=function(e){this._replies=this._replies.filter(function(t){return!e.equals(t)}),this._latestDate=void 0},e.prototype.replaceReply=function(e,t){var n=this._replies.indexOf(e);n>-1?this._replies[n]=t:this.addReply(t)},e.prototype.sortReplies=function(){this._replies=this._replies.sort(function(e,t){return+e.latestDate()-+t.latestDate()}),this._replies=this._replies.filter(function(e,t,n){return 0===t||e.id!==n[t-1].id})},e.prototype.like=function(e){this.userLiked||(this._userLiked=!0,this._likeCount++)},e.prototype.unlike=function(e){this.userLiked&&(this._userLiked=!1,this._likeCount--)},e.prototype.unmarkDelted=function(){this._isDeleted=!1},e.prototype._alreadyLiked=function(e){return this._likedBy.some(function(t){return t.email===e.email})},e}();t.a=r},DrmC:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i}),n.d(t,"findCommentById",function(){return r});var o=n("17wl");function i(e,t){switch(void 0===e&&(e={comments:[],commentCount:0,disabled:!1,disabledAtSiteOrTenant:!0,loaded:!1}),t.type){case"COMMENTS_DISABLED":return d(e,t.actionData);case"COMMENT_CLEAR":return s(e);case"COMMENT_CHUNK":return function(e){return Object(o.__assign)(Object(o.__assign)({},e),{loaded:!0})}(function(e){return Object(o.__assign)(Object(o.__assign)({},e),{comments:e.comments.sort(function(e,t){return+t.date-+e.date}).filter(function(e,t,n){return 0===t||e.id!==n[t-1].id})})}(function(e,t){var n=e.commentCount||t.count||t.comments.length||0,i=e;return t.comments.forEach(function(e){return i=a(i,e,!1)}),i=d(i,t.disabledState),Object(o.__assign)(Object(o.__assign)({},i),{commentCount:n,nextLink:t.nextLink})}(e,t.actionData)));case"COMMENT_CREATED":return a(e,t.actionData,!0);case"COMMENT_DELETED":return function(e,t){if(t.isReply()){var n=c(e,t.parentId);n&&n.removeReply(t)}return Object(o.__assign)(Object(o.__assign)({},e),{comments:t.isReply()?e.comments:e.comments.filter(function(e){return!t.equals(e)}),commentCount:e.commentCount-1-t.replies.length})}(e,t.actionData);case"COMMENT_LIKE":return function(e,t,n){return t.like(n),Object(o.__assign)({},e)}(e,t.actionData.comment,t.actionData.user);case"COMMENT_LIKE_CHUNK":return function(e,t,n){return n.processLikeChunk(t),Object(o.__assign)({},e)}(e,t.actionData.likeChunk,t.actionData.comment);case"COMMENT_FOCUS_REPLY":return function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{focusedCommentId:t})}(e,t.actionData);case"COMMENT_MARK_DELETED":return function(e,t){return t.markDeleted(),Object(o.__assign)({},e)}(e,t.actionData);case"COMMENT_REPLACED":return function(e,t,n){var i=t&&c(e,t.parentId);if(i)return i.replaceReply(t,n),Object(o.__assign)({},e);var r=e.comments.indexOf(t);return r>-1?Object(o.__assign)(Object(o.__assign)({},e),{comments:e.comments.map(function(e,t){return t===r?n:e})}):a(e,n,!0)}(e,t.actionData.oldComment,t.actionData.newComment);case"COMMENT_REPLY_CHUNK":return function(e,t){var n=c(e,t.parentId);if(!n)throw new Error("CommentReducer: Attempted to add reply chunk but no parent was found");var o=e;return t.comments.forEach(function(e){return o=a(o,e,!1)}),n.nextLink=t.nextLink,o}(e,t.actionData);case"COMMENT_RESET":return _(e);case"COMMENT_UNLIKE":return function(e,t,n){return t.unlike(n),Object(o.__assign)({},e)}(e,t.actionData.comment,t.actionData.user);case"COMMENT_UNMARK_DELETED":return function(e,t){return r(e,t.id)?(t.unmarkDelted(),Object(o.__assign)({},e)):a(e,t,!0)}(e,t.actionData);case"PAGE_CREATE_STUB":return _(e);default:return e}}function r(e,t){return c(e,t)||function(e,t){return e.comments.reduce(function(e,n){return e||n.replies.reduce(function(e,n){return e||n.id===t?n:void 0})})}(e,t)}function a(e,t,n){var i=c(e,t.parentId);return i&&(i.addReply(t),i.sortReplies()),Object(o.__assign)(Object(o.__assign)({},e),{comments:i?e.comments:Object(o.__spreadArrays)([t],e.comments),commentCount:n?e.commentCount+1:e.commentCount})}function s(e){return Object(o.__assign)(Object(o.__assign)({},e),{comments:[],commentCount:0,nextLink:void 0,loaded:!1})}function c(e,t){return e.comments.filter(function(e){return e.id===t})[0]}function _(e){return Object(o.__assign)(Object(o.__assign)({},s(e)),{disabled:!0})}function d(e,t){var n=0!==t,i=2===t||3===t;return Object(o.__assign)(Object(o.__assign)({},e),{disabled:n,disabledAtSiteOrTenant:i})}},ECV1:function(e,t,n){"use strict";var o=n("17wl"),i=n("cDcd"),r=n("faye"),a=n("KL1q"),s=n("UWqr"),c=n("SBAr"),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){return this.parseCounter=0,i.createElement("span",{className:this.props.className},this._parse(this.props.children))},t.prototype._cloneElement=function(e){return i.cloneElement(e,{key:"parse"+ ++this.parseCounter},this._parse(e.props.children))},t.prototype._convertMatchesToReact=function(e,t){var n=this,o=0,i=[];return t.forEach(function(t,r){i.push(e.substring(o,t.index)),i.push(n._newLink(t)),o=t.lastIndex}),i.push(e.substring(o)),i.filter(function(e){return!!e})},t.prototype._getMatches=function(e){return t._linkifyIt.match(e)},t.prototype._newLink=function(e){return i.createElement("a",this._propsFor(e.url,"parse"+this.parseCounter+"match"+e.url),e.text)},t.prototype._parseString=function(e){if(""===e)return[];var t=this._getMatches(e);return t?this._convertMatchesToReact(e,t):e},t.prototype._parse=function(e){var t=this;return"string"==typeof e?this._parseString(e):i.isValidElement(e)&&"a"!==e.type?this._cloneElement(e):e instanceof Array?e.map(function(e){return t._parse(e)}):e},t.prototype._propsFor=function(e,t){var n={href:e,key:t};for(var o in this.props.properties)this.props.properties.hasOwnProperty(o)&&(n[o]=this.props.properties[o]);return n},t._linkifyIt=new c,t}(i.Component),d=n("F5rs"),l=n("xvAL"),u=n("xs0R"),m=n("q+wp"),p=n("SrEf"),h=function(e){function t(t){var n=e.call(this,t)||this;n._mentionMap=new Map,n._assignInputRef=function(e){n._root=e},n._showMore=function(){m.default.logUserEngagementForPage(u.b.fields,!0,"CommentShowMoreButton"),n.setState({expanded:!0,text:n.props.text})};var o=n._shrinkText(t.text);return n.state={expanded:o===t.text,text:o},n.props.mentions&&n.props.mentions.forEach(function(e){if(n._mentionMap.set(e.email,e.name),e.loginName){var t=e.loginName.substr(e.loginName.lastIndexOf("|")+1);n._mentionMap.set(t,e.name)}}),n}return Object(o.__extends)(t,e),t.htmlDecode=function(e){var t=e;if(DOMParser){var n=(new DOMParser).parseFromString(t||"","text/html");t=n&&n.body&&n.body.innerText?n.body.innerText:""}return t},t.prototype.render=function(){return i.createElement(_,{properties:{target:"_blank",rel:"noopener"},ref:this._assignInputRef},this.state.text&&this.state.text.split("\n").map(function(e,t,n){return i.createElement("span",{key:e+t,className:l.a.commentRichText,dangerouslySetInnerHTML:{__html:e}})}),!this.state.expanded&&i.createElement(a.Link,{className:l.a.spMore,onClick:this._showMore},d.L))},t.prototype.componentDidMount=function(){this._attachLivePersonaCard()},t.prototype.componentDidUpdate=function(e,t){t.expanded===!this.state.expanded&&(this._disposeLivePersonaCards(),this._attachLivePersonaCard())},t.prototype.componentWillUnmount=function(){this._disposeLivePersonaCards()},t.prototype._disposeLivePersonaCards=function(){this._lpcAdapters&&(this._lpcAdapters.forEach(function(e){r.unmountComponentAtNode(e)}),this._lpcAdapters=void 0)},t.prototype._attachLivePersonaCard=function(){var e=r.findDOMNode(this._root);if(e instanceof Element){var t=e.querySelectorAll("a[data-sp-mention-user-id]");this._lpcAdapters=[];for(var n=0;n<t.length;n++){var o=t[n].getAttribute("data-sp-mention-user-id"),i=t[n].innerText.replace("@","");if(t[n].setAttribute("href","mailto:"+o),this.props.mentions){var a=this._mentionMap.get(o);a?(-1===a.indexOf(i)&&(i=a),t[n].setAttribute("access-type","1")):t[n].setAttribute("access-type","0")}var c=this._linkWithLPC(o,s.Text.format(d.X,i));r.render(c,t[n]),this._lpcAdapters.push(t[n])}}},t.prototype._shrinkText=function(e){return t.htmlDecode(e).length>400?s.Text.format(d.V,e.slice(0,this._truncationPoint(e))):e},t.prototype._truncationPoint=function(e){var t=e.slice(0,350).lastIndexOf(" ");return-1===t?350:t},t.prototype._linkWithLPC=function(e,t){return i.createElement(p.a,{personaType:"User",identifier:e,lpcHoverTargetProps:{upn:e},pageContext:this.props.pageContext.legacyPageContext,moduleLoader:void 0,lpcCardBehavior:{disableHover:!0,onCardClose:void 0,onCardOpen:void 0}},i.createElement("span",null,t))},t}(i.Component);t.a=h},F5rs:function(e){e.exports=JSON.parse('{"d":"Comments","n":"Comment removed with no replies||Comment removed with {0} reply||Comment removed with {0} replies ","m":"0||1||2- ","h":"No more comments to show||Showing {0} older comment||Showing {0} older comments","i":"0||1||2-","j":"No more replies to show||Showing {0} more reply||Showing {0} more replies","g":"0||1||2-","f":"No more likes to show.||Showing {0} more like.||Showing {0} more likes.","k":"0||1||2-","l":"Comment posted","e":"Comment liked.","o":"Comment unliked.","s":"Reply","t":"Reply to {0}","p":"Delete","q":"Like the comment.","v":"Unlike the comment.","u":"Show more.","r":"More options","y":"Delete confirmation","x":"Are you sure you want to delete this comment?","z":"Couldn\\u0027t delete comment. Try again.","A":"Comments||{0} Comment||{0} Comments","B":"0||1||2-","Y":"Add a comment. Type @ to mention someone","W":"Add a comment.","F":"Post","G":"Couldn\\u0027t post comment. Try again.","C":"Couldn\\u0027t like the comment. Try again.","Q":"Couldn\\u0027t unlike the comment. Try again.","D":" Could not like the comment.  The comment has reached the maximum number of likes. ","E":"Likes","w":"Close","L":"Show more","H":"You have exceeded the limit by {0} character||You have exceeded the limit by {0} characters","I":"1||2-","J":"{0} character left||{0} characters left","K":"1||0,2-","M":"Comments on","N":"Comments off","O":"Off","P":"On","R":"Photo of {0}","S":"Show more comments","U":"Show more replies","T":"Show more likes","X":"@{0}","V":"{0}…","Z":"Save this page before enabling or disabling comments.","b":"Click this link to go to the top of the page.","a":"{0} Commented {1}.","c":"The comments section will be displayed after the page is published."}')},GW7U:function(e,t,n){"use strict";n.r(t);var o=n("17wl"),i=n("cDcd"),r=n("ut3N"),a=n("Yo/j"),s=n("Rrln"),c=n("DrmC"),_=n("xs0R"),d=function(){function e(e){var t=this;this._findAndScroll=function(){t._commentIsPresent()?t._scrollToComment():t._getNext().then(t._findAndScroll).catch(t._handleError)},this._hash=e,this._determineValidity(),this._valid&&this._extractParts()}return e.prototype.scroll=function(){this._valid&&this._findAndScroll()},Object.defineProperty(e.prototype,"_commentSlice",{get:function(){return _.b.pageReduxStore.getState().comments},enumerable:!0,configurable:!0}),e.prototype._commentIsPresent=function(){return void 0!==Object(c.findCommentById)(this._commentSlice,String(this._commentId))},e.prototype._determineValidity=function(){this._valid=e._commentIdRegex.test(this._hash)},e.prototype._extractNumber=function(e,t){var n=e.exec(t);return n?Number(n[1]):void 0},e.prototype._extractParts=function(){this._commentId=this._extractNumber(e._commentIdRegex,this._hash),this._parentCommentId=this._extractNumber(e._parentIdRegex,this._hash)},e.prototype._getNext=function(){if(this._parentCommentId){var e=Object(c.findCommentById)(this._commentSlice,String(this._parentCommentId));if(e)return e.nextLink?a.a.getNextReplies(e.nextLink,e.id):Promise.reject(new Error("Unable to find comment reply"))}return this._commentSlice.nextLink?a.a.getNextComments(this._commentSlice.nextLink):Promise.reject(new Error("Unable to find top level comment"))},e.prototype._handleError=function(t){r._TraceLogger.logError(e._logSource,t)},e.prototype._scrollToComment=function(){var t=this;setTimeout(function(){var n=document.getElementById("sp-comment-"+t._commentId);n?n.scrollIntoView():r._TraceLogger.logError(e._logSource,new Error("Comment present but could not be found in view"))},0)},e._commentIdRegex=new RegExp(/[#&]comment=(\d+)/),e._logSource=r._LogSource.create("CommentDirectScroller"),e._parentIdRegex=new RegExp(/[#&]parentComment=(\d+)/),e}(),l=n("/OYS"),u=n("PJr9"),m=n("q+wp"),p=n("XdGY"),h=function(e){function t(n){var o=e.call(this,n)||this;return o._eventLogged=!1,o._updateStateFromStore=function(){-1!==_.b.sliceUpdated.indexOf(u.a.CommentStore)?(o.props.onDisabledChange&&o.props.onDisabledChange(o._commentSlice.disabled),Object(p.n)()||o._eventLogged||!o._commentSlice.commentCount||(o._eventLogged=!0,r._EngagementLogger.logEvent("CommentModule.HasComments")),o.setState({comments:o._commentSlice.comments,count:o._commentSlice.commentCount,disabled:o._commentSlice.disabled,disabledAtSiteOrTenant:o._commentSlice.disabledAtSiteOrTenant,nextLink:o._commentSlice.nextLink})):t._commentsHasRendered&&t._onPageStoreUpdated()},o._qosMonitor=new r._QosMonitor("CommentLoadedAndRendered"),_.b.addReducer("comments",c.default),o.state={comments:o._commentSlice.comments,count:o._commentSlice.commentCount,disabled:o._commentSlice.disabled,disabledAtSiteOrTenant:o._commentSlice.disabledAtSiteOrTenant,nextLink:o._commentSlice.nextLink},o._updateCommentContext(n),o}return Object(o.__extends)(t,e),t._onPageStoreUpdated=function(){m.default.isNewPage()&&(t._refreshOnNextStoreUpdate=!0),(m.default.navigatedToNewPage(this._pageKey)||t._refreshOnNextStoreUpdate&&!m.default.isNewPage())&&(t._pageKey=m.default.getPageKey(),a.a.clearComments(),a.a.getComments(),t._refreshOnNextStoreUpdate=!1)},t.prototype.componentDidMount=function(){this._checkQoSFinished(),this._unsubscribe=_.b.addListener(this._updateStateFromStore),this._onFirstRender(),this._updateTimer=window.setInterval(this.forceUpdate.bind(this),6e4)},t.prototype.componentDidUpdate=function(){this._checkQoSFinished()},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._updateCommentContext(e)},t.prototype.componentWillUnmount=function(){this._unsubscribe(),clearInterval(this._updateTimer),t._lastTimeout&&clearTimeout(t._lastTimeout),t._commentsHasRendered=!1},t.prototype.render=function(){try{return i.createElement(l.a,{comments:this.state.comments,count:this.state.count,disabled:this.state.disabled,disabledAtSiteOrTenant:this.state.disabledAtSiteOrTenant,isToggleVisible:this.props.isToggleVisible,nextLink:this.state.nextLink,isPublished:m.default.hasPageBeenPublished()})}catch(n){var e=new Error(n);this._qosMonitor.writeUnexpectedFailure("FailedRenderTag",e),r._TraceLogger.logError(t._logSource,e)}},t.prototype._onFirstRender=function(){var e=this;(!Object(p.Z)()||!t._commentsHasRendered&&m.default.navigatedToNewPage(t._pageKey))&&(t._pageKey=m.default.getPageKey(),a.a.clearComments(),a.a.getComments().then(function(){t._commentsHasRendered=!0,e._scrollToCommentsIfNeeded()}))},t.prototype._checkQoSFinished=function(){!this._qosMonitor.hasEnded&&this._commentSlice.loaded&&this._qosMonitor.writeSuccess()},Object.defineProperty(t.prototype,"_commentSlice",{get:function(){return _.b.pageReduxStore.getState().comments},enumerable:!0,configurable:!0}),t.prototype._scrollToCommentsIfNeeded=function(){"#comments"===window.location.hash?this._scrollToCommentsSection():new d(window.location.hash).scroll()},t.prototype._scrollToCommentsSection=function(){var e=document.getElementById("sp-comments");e&&e.scrollIntoView()},t.prototype._updateCommentContext=function(e){s.a.instance.deleteAllPermission=e.deleteAllPermission,s.a.instance.disableEditing=e.disableEditing,s.a.instance.serviceScope=e.serviceScope,s.a.instance.user=e.user},t._commentsHasRendered=!1,t._refreshOnNextStoreUpdate=!1,t._logSource=r._LogSource.create("CommentContainer"),t}(i.Component);t.default=h},"J4/A":function(e,t,n){"use strict";n.r(t);var o=n("ut3N"),i=n("2q6Q"),r=n("vlQI"),a=n("y88i"),s=n("Yo/j"),c=n("i8gT"),_=n("2G27"),d=n("xs0R"),l=n("onFi"),u=n("q+wp"),m=function(){function e(e,t){this._loggedLoadSource=!1,this._pageContext=e,this._spHttpClient=t}return e.prototype.createComment=function(e,t){var n=this,o=new i._QosMonitor("CreateCommentAPI");return new Promise(function(i,r){n._createCommentRequest(e,t).then(function(e){n._checkForErrors("CreateCommentAPI",o,e),e.json().then(function(e){i(c.a.toCommentItem(e)),o.writeSuccess()})}).catch(function(e){o.writeUnexpectedFailure("CreateCommentAPI",e),r(e)})})},e.prototype.deleteComment=function(e){var t=this,n=new i._QosMonitor("DeleteCommentAPI");return new Promise(function(o,i){t._deleteCommentRequest(e).then(function(e){t._checkForErrors("DeleteCommentAPI",n,e),o(),n.writeSuccess()}).catch(function(e){n.writeUnexpectedFailure("DeleteCommentAPI",e),i(e)})})},e.prototype.getComments=function(){return window._spCommentsData?(this._deferClearPageData(),this._logLoadSource("Prefetch"),Promise.resolve(this._convertDataToItemChunk(window._spCommentsData,this._getPageDisabledState()))):Promise.race([this._getCommentsDataFromAPI(),this._getCommentsFromPage()])},e.prototype.getDisabled=function(e){var t=this,n=new i._QosMonitor("GetCommentsDisabledScopeAPI");return new Promise(function(o,i){t._getCommentsDisabledScopeRequest(e).then(function(e){t._checkForErrors("GetCommentsDisabledScopeAPI",n,e),e.json().then(function(e){o(e.value),n.writeSuccess()})}).catch(function(e){n.writeUnexpectedFailure("GetCommentsDisabledScopeAPI",e),i(e)})})},e.prototype.getNext=function(e,t){var n=this;void 0===t&&(t=!1);var o=new i._QosMonitor("LoadMoreCommentsAPI");return new Promise(function(i,r){n._nextCommentsRequest(e,t).then(function(e){n._checkForErrors("LoadMoreCommentsAPI",o,e),e.json().then(function(e){i(n._convertDataToItemChunk(e)),o.writeSuccess()})}).catch(function(e){o.writeUnexpectedFailure("LoadMoreCommentsAPI",e),r(e)})})},e.prototype.getNextLikes=function(e){var t=this,n=new i._QosMonitor("GetCommentLikesAPI");return this._nextLikesRequest(e).then(function(e){return t._checkForErrors("GetPageUrlAPI",n,e),e.json()}).then(function(e){return n.writeSuccess(),Promise.resolve(t._convertServerLikesResponse(e))}).catch(function(e){return n.writeUnexpectedFailure("GetCommentLikesAPI",e),Promise.reject(e)})},e.prototype.likeComment=function(e){var t=this,n=new i._QosMonitor("LikeCommentAPI");return this._likeCommentRequest(e).then(function(e){t._checkLikeResponse("LikeCommentAPI",n,e),n.writeSuccess()}).catch(function(e){return n.writeUnexpectedFailure("LikeCommentAPI",e),Promise.reject(e)})},e.prototype.setDisabled=function(e){var t=this,n=new i._QosMonitor("DisableCommentsAPI");return new Promise(function(o,i){t._disabledRequest(e).then(function(e){t._checkForErrors("DisableCommentsAPI",n,e),o(),n.writeSuccess()}).catch(function(e){n.writeUnexpectedFailure("DisableCommentsAPI",e),i(e)})})},e.prototype.unlikeComment=function(e){var t=this,n=new i._QosMonitor("UnlikeCommentAPI");return this._unlikeCommentRequest(e).then(function(e){t._checkForErrors("UnlikeCommentAPI",n,e),n.writeSuccess()}).catch(function(e){return n.writeUnexpectedFailure("UnlikeCommentAPI",e),Promise.reject(e)})},e.prototype._checkForErrors=function(e,t,n){n||this._throwEmptyResponseError(e,t),u.default.isResponseSuccessful(n.status)||this._throwHttpError(t,n)},e.prototype._checkLikeResponse=function(e,t,n){return n?u.default.isResponseSuccessful(n.status)?void 0:this._throwLikeError(t,n):this._throwEmptyResponseError(e,t)},e.prototype._createCommentRequest=function(e,t){return this._spHttpClient.post(a.Uri.concatenate(this._getCommentsUrl(t),t?"/replies":""),r.SPHttpClient.configurations.v1,{body:JSON.stringify({text:e})})},e.prototype._convertDataToItemChunk=function(e,t){return void 0===t&&(t=0),{comments:e.value.map(function(e){return c.a.toCommentItem(e)}),disabledState:t,count:e["@odata.count"],nextLink:e["@odata.nextLink"]}},e.prototype._convertServerLikesResponse=function(e){return e.value?{likes:e.value,"@odata.nextLink":e["@odata.nextLink"]}:void 0},e.prototype._deferClearPageData=function(){setTimeout(function(){window._spCommentsData=void 0},0)},e.prototype._deleteCommentRequest=function(e){return this._spHttpClient.fetch(a.Uri.concatenate(this._getCommentsUrl(e.id)),r.SPHttpClient.configurations.v1,{method:"delete"})},e.prototype._disabledRequest=function(e){return this._spHttpClient.post(a.Uri.concatenate(this._getPageUrl(),"/SetCommentsDisabled"),r.SPHttpClient.configurations.v1,{body:JSON.stringify({value:e})})},e.prototype._failedResponseFromStatus=function(e){var t={403:"FailedResponseForbidden",404:"FailedResponseNotFound",406:"FailedResponseNotAcceptable"};return t[e]?t[e]:"FailedResponseStatus"},e.prototype._getCommentsDataFromAPI=function(){var t=this,n=this._spHttpClient.beginBatch(),i=[this._getCommentsFromAPI(n),this.getDisabled(n)];return this._resolveBatch(n,i).then(function(e){return t._logLoadSource("API"),t._convertDataToItemChunk(e[0],e[1])}).catch(function(t){return o._TraceLogger.logError(e._logSource,t),t})},e.prototype._getCommentsFromAPI=function(e){var t=this,n=new i._QosMonitor("LoadCommentsFromAPI");return new Promise(function(o,i){t._getCommentsRequest(e).then(function(e){t._checkForErrors("LoadCommentsFromAPI",n,e),e.json().then(function(e){o(e),n.writeSuccess()})}).catch(function(e){n.writeUnexpectedFailure("LoadCommentsFromAPI",e),i(e)})})},e.prototype._getCommentsFromPage=function(){var e=this;return new Promise(function(t,n){window._spCommentsDataLoaded=function(){t(e._convertDataToItemChunk(window._spCommentsData,e._getPageDisabledState())),e._deferClearPageData(),e._logLoadSource("PrefetchCallback")}})},e.prototype._fields=function(){return d.b.fields},e.prototype._getCommentsDisabledScopeRequest=function(e){return e?e.get(a.Uri.concatenate(this._getPageUrl(),"/CommentsDisabledScope"),r.SPHttpClientBatch.configurations.v1):this._spHttpClient.get(a.Uri.concatenate(this._getPageUrl(),"/CommentsDisabledScope"),r.SPHttpClient.configurations.v1)},e.prototype._getCommentsRequest=function(e){return e.get(this._getCommentsUrl()+"?$expand=replies,likedBy,replies/likedBy&$top=10&$inlineCount=AllPages",r.SPHttpClientBatch.configurations.v1)},e.prototype._getCommentsUrl=function(e){return a.Uri.concatenate(this._getPageUrl(),"/Comments"+(e?"("+e+")":""))},e.prototype._getPageDisabledState=function(){if(window._spCommentsDisabledScope)return window._spCommentsDisabledScope.value;var e=3;return window._spCommentsData.value&&window._spCommentsData.value.length&&(e=0),s.a.getDisabledScope(),e},e.prototype._getPageUrl=function(){return a.Uri.concatenate(this._pageContext.legacyPageContext.webServerRelativeUrl||"","/_api/web/lists('"+u.default.listId()+"')","/GetItemById("+this._itemId()+")")},e.prototype._itemId=function(){return this._fields().Id||u.default.spPageContextInfo.pageItemId},e.prototype._likeCommentRequest=function(e){return this._toggleLikeCommentRequest(e,!0)},e.prototype._logLoadSource=function(e){this._loggedLoadSource||(this._loggedLoadSource=!0,i._EngagementLogger.logEvent("CommentsLoad."+e))},e.prototype._nextCommentsRequest=function(e,t){return this._spHttpClient.get(e+(t?"&$expand=likedBy":""),r.SPHttpClient.configurations.v1)},e.prototype._nextLikesRequest=function(e){return this._spHttpClient.get(e,r.SPHttpClient.configurations.v1)},e.prototype._resolveBatch=function(e,t){return e.execute().then(function(){return Promise.all(t)})},e.prototype._throwEmptyResponseError=function(e,t){var n=new Error("Response is null, undefined or empty");throw t.writeUnexpectedFailure("FailedResponseStatus",n),n},e.prototype._throwHttpError=function(e,t){var n=new l.a(u.default.getStatusMessage(t),t.status);throw e.writeUnexpectedFailure(this._failedResponseFromStatus(t.status),n),n},e.prototype._throwLikeError=function(e,t){507===t.status?this._throwLikeLimitExceededError(e):this._throwHttpError(e,t)},e.prototype._throwLikeLimitExceededError=function(t){throw t.writeExpectedFailure("LikeCommentAPI",e.likeLimitExceededError),e.likeLimitExceededError},e.prototype._toggleLikeCommentRequest=function(e,t){return this._spHttpClient.fetch(a.Uri.concatenate(this._getCommentsUrl(e),t?"/like":"/unlike"),r.SPHttpClient.configurations.v1,{method:"post",body:JSON.stringify({})})},e.prototype._unlikeCommentRequest=function(e){return this._toggleLikeCommentRequest(e,!1)},e.likeLimitExceededError=new _.a,e._logSource=o._LogSource.create("CommentsDataProvider"),e}();t.default=m},Mrrk:function(e,t,n){var o=n("4SPZ"),i=n("jOlS");"string"==typeof o&&(o=[[e.i,o]]);for(var r=0;r<o.length;r++)i.loadStyles(o[r][1],!0);o.locals&&(e.exports=o.locals)},RPce:function(e,t,n){"use strict";var o=n("17wl"),i=n("cDcd"),r=n("SrEf"),a=n("y88i"),s=n("X+PM"),c=n("wLiO"),_=n.n(c),d=n("hiL/"),l=n("Rrln"),u=n("F5rs"),m=n("xvAL"),p=function(e){function t(t){var n=e.call(this,t)||this;return n._lpcAdapterRefresh=n._lpcAdapterRefresh.bind(n),n.state={},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this._mounted=!0},t.prototype.componentWillUnmount=function(){this._mounted=!1},t.prototype.render=function(){var e=l.a.instance.serviceScope.consume(s.PageContext.serviceKey),t=i.createElement(r.a,{personaType:"User",identifier:this.props.user.email,lpcHoverTargetProps:{upn:this._getUserUpn(this.props.user)},pageContext:e.legacyPageContext,moduleLoader:void 0,lpcCardBehavior:{disableHover:!0,onCardClose:void 0,onCardOpen:void 0}},i.createElement("div",null,this._imageComponent()));return i.createElement("div",{className:m.a.spAvatar},t)},t.prototype._lpcAdapterRefresh=function(e){var t=this;!this._lpcAdapterPromise&&e&&(this._lpcAdapterPromise=this.state.lpcAdapter.ensureInitializeLPC(e.makeAdapterConfig()).then(function(){return t._mounted&&t.setState(t.state)}))},t.prototype._imageComponent=function(){return i.createElement(_.a,{key:this.props.user.email,dimensions:{width:32,height:32},displayName:this.props.user.name},i.createElement("img",{alt:a.StringHelper.format(u.R,this.props.user.name),className:m.a.spAvatarImage,src:d.SPUtility.getUserPhotoUrl(this.props.user.email)}),this.props.disabled&&i.createElement("div",{className:m.a.spDisabledAvatarOverlay}))},t.prototype._getUserUpn=function(e){return e.loginName?e.loginName.slice(e.loginName.lastIndexOf("|")+1):e.email},t}(i.Component);t.a=p},Rrln:function(e,t,n){"use strict";var o=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return this._instance||this._createInstance()},enumerable:!0,configurable:!0}),e.isCurrentUser=function(t){var n=e.instance.user;return n&&t&&n.id===t.id},e._createInstance=function(){return this._instance=new e},e.DEFAULT_LIKE_COUNT=0,e}();t.a=o},"Yo/j":function(e,t,n){"use strict";var o=n("ut3N"),i=n("Cgdb"),r=n("jyrw"),a=n("D/Gr"),s=n("J4/A"),c=n("7plR"),_=n("n1SJ"),d=n("F5rs"),l=n("q+wp"),u=function(){function e(){}return e.clearComments=function(){e._dispatch("clear")},e.createComment=function(t,n,o){var i=this._createOptimisticComment(t,n,o);c.a.instance.commentsDataProvider().then(function(e){return e.createComment(n,o)}).then(function(t){t.optimisticId=i.optimisticId,e._dispatch("replace",{newComment:t,oldComment:i})}).catch(function(t){e._dispatch("delete",i),_.a.showError(d.G),e._logError(t)})},e.deleteComment=function(t){e._dispatch("markDelete",t);var n=window.setTimeout(function(){e._dispatch("delete",t)},200);c.a.instance.commentsDataProvider().then(function(e){return e.deleteComment(t)}).catch(function(o){clearTimeout(n),e._dispatch("unmarkDelete",t),_.a.showError(d.z),e._logError(o)})},e.getComments=function(){return c.a.instance.commentsDataProvider().then(function(e){return e.getComments()}).then(function(t){e._dispatch("loaded",t)}).catch(e._logError)},e.getDisabledScope=function(){c.a.instance.commentsDataProvider().then(function(e){return e.getDisabled()}).then(function(t){e._dispatch("getDisabled",t)}).catch(e._logError)},e.getNextComments=function(t){return c.a.instance.commentsDataProvider().then(function(e){return e.getNext(t)}).then(function(t){e._dispatch("moreComments",t),l.default.alertScreenreader(d.h,d.i,t.comments.length)}).catch(e._logError)},e.getNextLikes=function(t){c.a.instance.commentsDataProvider().then(function(e){return e.getNextLikes(t.nextLikesLink)}).then(function(n){e._dispatch("moreLikes",{comment:t,likeChunk:n}),l.default.alertScreenreader(d.f,d.g,n.likes.length)}).catch(e._logError)},e.getNextReplies=function(t,n){return c.a.instance.commentsDataProvider().then(function(e){return e.getNext(t,!0)}).then(function(t){t.parentId=n,e._dispatch("moreReplies",t),l.default.alertScreenreader(d.j,d.k,t.comments.length)}).catch(e._logError)},e.focusReply=function(t){e._dispatch("focus",t)},e.likeComment=function(e,t){var n=this;this._dispatch("likeComment",{comment:e,user:t}),c.a.instance.commentsDataProvider().then(function(t){return t.likeComment(e.id)}).then(function(){c.a.instance.a11yManager.alert(d.e)}).catch(function(o){n._dispatch("unlikeComment",{comment:e,user:t}),n._processLikeError(o)})},e.reset=function(){e._dispatch("reset")},e.setDisabled=function(t){return e._dispatch("setDisabled",t?1:0),c.a.instance.commentsDataProvider().then(function(e){return e.setDisabled(t)}).catch(function(n){e._dispatch("setDisabled",t?0:1),e._logError(n)})},e.unlikeComment=function(t,n){this._dispatch("unlikeComment",{comment:t,user:n}),c.a.instance.commentsDataProvider().then(function(e){return e.unlikeComment(t.id)}).then(function(){c.a.instance.a11yManager.alert(d.o)}).catch(function(o){e._dispatch("likeComment",{comment:t,user:n}),_.a.showError(d.Q),e._logError(o)})},e._createOptimisticComment=function(t,n,o){var i=new a.a([],new Date,"optimistic_"+Math.random(),void 0,o||"0",n,t,0,!1);return e._dispatch("create",i),i},e._dispatch=function(t,n){r.a.dispatch(new i.a(e._actionTypes[t],e._logEntryFor(t),n))},e._logEntryFor=function(t){return new o._LogEntry(e._moduleName,e._logFeatures[t],o._LogType.Event)},e._logError=function(t){o._TraceLogger.logError(e._logSource,t)},e._processLikeError=function(t){var n=t.name===s.default.likeLimitExceededError.name?d.D:d.C;_.a.showError(n),e._logError(t)},e._logSource=o._LogSource.create("CommentActionCreator"),e._moduleName="[CommentActionCreator]",e._logFeatures={clear:"SPPageCommentsCleared",create:"SPPageCommentCreated",delete:"SPPageCommentDeleted",focus:"SPPageCommentReplyFocused",getDisabled:"SPPageCommentsGetDisabled",likeComment:"SPPageCommentLiked",loaded:"SPPageCommentsLoaded",markDelete:"SPPageCommentMarkDeleted",moreComments:"SPPageCommentsMoreCommentsLoaded",moreLikes:"SPPageCommentMoreLikesLoaded",moreReplies:"SPPageCommentsMoreRepliesLoaded",replace:"SPPageCommentReplaced",reset:"SPPageCommentsReset",setDisabled:"SPPageCommentsSetDisabled",unlikeComment:"SPPageCommentUnliked",unmarkDelete:"SPPageCommentMarkUndeleted"},e._actionTypes={clear:"COMMENT_CLEAR",create:"COMMENT_CREATED",delete:"COMMENT_DELETED",focus:"COMMENT_FOCUS_REPLY",getDisabled:"COMMENTS_DISABLED",likeComment:"COMMENT_LIKE",loaded:"COMMENT_CHUNK",markDelete:"COMMENT_MARK_DELETED",moreComments:"COMMENT_CHUNK",moreLikes:"COMMENT_LIKE_CHUNK",moreReplies:"COMMENT_REPLY_CHUNK",replace:"COMMENT_REPLACED",reset:"COMMENT_RESET",setDisabled:"COMMENTS_DISABLED",unlikeComment:"COMMENT_UNLIKE",unmarkDelete:"COMMENT_UNMARK_DELETED"},e}();t.a=u},i8gT:function(e,t,n){"use strict";var o=n("D/Gr"),i=n("Rrln"),r=function(){function e(){}return e.allLikesFetched=function(e){return e&&-1===e.indexOf("skiptoken")},e.toCommentItem=function(t){return e._toCommentItemWithLikes(t)},e._toCommentItemWithLikes=function(t){var n=t.replies?t.replies.map(function(t){return e._toCommentItemWithLikes(t)}):[],r=t.likedBy&&t.likedBy.filter(function(e){return e&&!i.a.isCurrentUser(e)}),a=t["likedBy@odata.nextLink"];return e.allLikesFetched(a)&&(a=void 0),new o.a(n,new Date(t.createdDate),t.id,t["replies@odata.nextLink"],t.parentId,t.text,t.author,t.likeCount,t.isLikedByUser,r,a,t,t.mentions)},e}();t.a=r},m9Fc:function(e,t,n){"use strict";var o=n("17wl"),i=n("cDcd"),r=n("faye"),a=n("2q6Q"),s=n("ut3N"),c=n("I6O9"),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype._internalLoad=function(){return c.SPComponentLoader.loadComponentById("44f2ec7c-d082-4660-956e-5e3cd760e6ad").then(function(e){return e.AtMentionControl})},t}(n("qjmy")._DeferredComponent),d=n("KL1q"),l=n("y88i"),u=n("UWqr"),m=n("Yo/j"),p=n("RPce"),h=n("Rrln"),f=n("ECV1"),g=n("SBAr"),C=function(){function e(){this._addingPreNodes=!0,this._postNodes=[],this._preNodes=[]}return e.prototype.addNode=function(e){(this._addingPreNodes?this._preNodes:this._postNodes).push(e)},e.prototype.addText=function(e,t){t>0&&t<e.length?(this.addNode(document.createTextNode(e.substr(0,t))),this._startAddingPostNodes(),this.addNode(document.createTextNode(e.substr(t)))):this.addNode(document.createTextNode(e))},Object.defineProperty(e.prototype,"postNodes",{get:function(){return this._postNodes.filter(this._nonBlankNode)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preNodes",{get:function(){return this._preNodes.filter(this._nonBlankNode)},enumerable:!0,configurable:!0}),e.prototype._nonBlankNode=function(e){return"A"===e.nodeName||!!e.nodeValue},e.prototype._startAddingPostNodes=function(){this._addingPreNodes=!1},e}(),y=function(){function e(e,t){this._element=e,this._requireSpace=t}return e.replaceLinks=function(t,n){new e(t,n).replaceLinks()},e.prototype.replaceLinks=function(){var e=this;[].forEach.call(this._element.childNodes,function(t){t.nodeValue?e._findAndReplaceMatches(t,t.nodeValue):e._replaceChildLinks(t)})},e.prototype._findAndReplaceMatches=function(e,t){var n=this._matchesForText(e,t);if(n.length){var o=this._newNodesForMatches(e,n,t);this._pushNodes(o,e)}},e.prototype._getCursorPosition=function(e){var t,n=0,o=e.ownerDocument||e.document,i=o.defaultView||o.parentWindow;if(void 0!==i.getSelection){if((t=i.getSelection()).rangeCount>0){var r=t.getRangeAt(0),a=r.cloneRange();a.selectNodeContents(e),a.setEnd(r.endContainer,r.endOffset),n=a.toString().length}}else if((t=o.selection)&&"Control"!==t.type){var s=t.createRange(),c=o.body.createTextRange();c.moveToElementText(e),c.setEndPoint("EndToEnd",s),n=c.text.length}return n},e.prototype._lastCharacterShouldBreak=function(e,t,n){var o=this._getCursorPosition(e)-1||t.lastIndex;return o>n.length||void 0!==n[o]&&"  \n\r".indexOf(n[o])>-1},e.prototype._linkNodeFor=function(e){var t=document.createElement("a");return t.appendChild(document.createTextNode(e.text)),t.setAttribute("contentEditable","false"),t.href=e.url,t.rel="noopener",t.target="_blank",t},e.prototype._matchesForText=function(t,n){return this._removeUnfinishedMatches(t,e._linkifyIt.match(n)||[],n)},e.prototype._newNodesForMatches=function(e,t,n){var o=this,i=this._getCursorPosition(e)||n.length,r=new C,a=0;return t.forEach(function(e){r.addText(n.substr(a,e.index-a),i-a),r.addNode(o._linkNodeFor(e)),a=e.lastIndex}),r.addText(n.substr(a),i-a),r},e.prototype._pushNodes=function(e,t){var n=this;e.preNodes.forEach(function(e){n._element.insertBefore(e,t)}),e.postNodes.forEach(function(e){n._element.insertBefore(e,t.nextSibling)}),t.nodeValue=""},e.prototype._readyToReplace=function(e,t,n){return!this._requireSpace||this._lastCharacterShouldBreak(e,t,n)},e.prototype._removeUnfinishedMatches=function(e,t,n){var o=this;return t.filter(function(t){return o._readyToReplace(e,t,n)})},e.prototype._replaceChildLinks=function(t){"DIV"===t.nodeName&&e.replaceLinks(t,this._requireSpace)},e._linkifyIt=new g,e}(),b=n("7plR"),L=n("xs0R"),x=n("q+wp"),E=n("F5rs"),v=n("xvAL"),k=function(e){function t(t){var n=e.call(this,t)||this;return n._a11yManager=b.a.instance.a11yManager,n._mentionsWithAccess=0,n._mentionsWithoutAccess=0,n._mentionsTotal=0,n._assignInputElementRef=function(e){n._inputElement=e},n._handleBlur=function(){n._updateText()},n._convertPasteToPlainText=function(e){if(!x.default.isIE11()){e.preventDefault();var t="";e.clipboardData||e.originalEvent.clipboardData?t=(e.originalEvent||e).clipboardData.getData("text/plain"):window.clipboardData&&(t=window.clipboardData.getData("Text")),document.queryCommandSupported("insertText")?document.execCommand("insertText",!1,t):document.execCommand("paste",!1,t)}},n._onReply=function(){x.default.logUserEngagementForPage(L.b.fields,!0,"CommentReplyPostButton"),m.a.createComment(h.a.instance.user,n._textContent(),n.props.commentId),n.setState({commentValue:""}),n._logMentionTotal(),n._a11yManager.alert(E.l),n._inputElement&&n._a11yManager.focusTo(n._inputElement)},n._updateText=function(e){e&&e.ctrlKey&&13===e.keyCode?n._onReply():(n._inputElement&&(y.replaceLinks(n._inputElement,e&&13!==e.keyCode),n.setState({commentValue:n._inputElement.innerHTML})),n._handleAtMention())},n._handleAtMention=function(){if(n._inputElement&&!n._atMention){var e=document.createElement("div"),t=i.createElement(_,{deferredProps:{editorElement:n._inputElement,serviceScope:b.a.instance.serviceScope}});n._atMention=r.render(t,e)}},u.Validate.isNotNullOrUndefined(n._a11yManager,"A11yManager"),n._allowTags(["a"]),n.state={commentValue:""},n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=E.Y;return i.createElement("form",{className:v.a.spReply},i.createElement(p.a,{disabled:this.props.disabled,user:h.a.instance.user}),i.createElement("div",{className:v.a.spField},i.createElement("div",Object(o.__assign)({"aria-label":E.W,className:Object(d.css)(v.a.spInput,v.a.spInputContrastRatioOverwrite),contentEditable:!this.props.disabled},{disabled:this.props.disabled,placeholder:e},{id:this._isRootReply()?"sp-comment-input":"sp-comment-input-reply-"+this.props.commentId,onBlur:this._handleBlur,onKeyUp:this._updateText,onPaste:this._convertPasteToPlainText,ref:this._assignInputElementRef,role:"textbox"})),this._textLength()>1800&&i.createElement("div",{"aria-atomic":"true","aria-live":"polite",className:Object(d.css)(v.a.spInputLimit,this._inputExceededStyle())},this._charactersRemainingText())),i.createElement("div",{className:v.a.spReplyButtonBlock},i.createElement(d.PrimaryButton,{ariaLabel:E.F,className:v.a.spButton,"data-automation-id":this._isRootReply()?"sp-comment-post":"sp-comment-reply-post-"+this.props.commentId,disabled:!this.commentInputValid()||this.props.disabled,onClick:this._onReply,text:E.F})))},t.prototype.commentInputValid=function(){return this._textLength()>0&&this._textLength()<=2e3},t.prototype.componentDidMount=function(){this.props.autoFocus&&this._inputElement&&this._a11yManager.focusTo(this._inputElement)},t.prototype.componentWillUnmount=function(){this._inputElement&&(r.unmountComponentAtNode(this._inputElement),this._inputElement=void 0)},t.prototype.componentDidUpdate=function(){""===this.state.commentValue&&this._inputElement&&(this._inputElement.innerHTML="")},t.prototype.focus=function(){this._inputElement&&this._a11yManager.focusTo(this._inputElement)},t.prototype._charactersRemainingText=function(){return this._textLength()<=2e3?u.Text.format(l.StringHelper.getLocalizedCountValue(E.J,E.K,2e3-this._textLength()),2e3-this._textLength()):u.Text.format(l.StringHelper.getLocalizedCountValue(E.H,E.I,-2e3+this._textLength()),-2e3+this._textLength())},t.prototype._inputExceededStyle=function(){return this._textLength()>2e3?v.a.spInputLimitExceeded:""},t.prototype._isRootReply=function(){return!this.props.commentId},t.prototype._limitConsecutiveNewlines=function(e){return e.replace(/\n{3,}/gm,"\n\n")},t.prototype._removeAllTags=function(e){return this._regexWithException?e.replace(this._regexWithException,""):e.replace(/<(?:.|\n)*?>/gm,"")},t.prototype._allowTags=function(e){for(var t=e[0],n=1;n<e.length;n++)t+="|"+e[n];this._regexWithException=new RegExp("<(?!/?("+t+")(?=>|\\s.*>))/?.*?>","gm")},t.prototype._replaceDivsWithNewLines=function(e){return e.replace(/<div>/gi,"\n").replace(/<\/div>/gi,"")},t.prototype._textLength=function(){return this._inputElement&&0!==this.state.commentValue.length?this._textLengthCache&&this._lastHTML===this._inputElement.innerHTML?this._textLengthCache:(this._lastHTML=this._inputElement.innerHTML,this._textLengthCache=this._textContent().length):0},t.prototype._textContent=function(){var e=this._inputElement?this._inputElement.innerHTML:"";return e=this._replaceDivsWithNewLines(e),e=this._limitConsecutiveNewlines(e),e=this._trimSurroundingWhitespace(e),e=this._removeAllTags(e),this._regexWithException||(e=f.a.htmlDecode(e)),e},t.prototype._trimSurroundingWhitespace=function(e){return e.replace(/^\s+|\s+$/g,"")},t.prototype._updateMentionTotal=function(){if(this._inputElement){var e=this._inputElement.querySelectorAll("a[data-sp-mention-user-id]");this._mentionsTotal=e.length,this._mentionsWithAccess=0,this._mentionsWithoutAccess=0;for(var t=0;t<e.length;t++){var n=e[t].getAttribute("access-type");"1"===n?this._mentionsWithAccess+=1:"0"===n&&(this._mentionsWithoutAccess+=1)}}},t.prototype._logMentionTotal=function(){this._updateMentionTotal();var e=new s._LogEntry("CommentsAtMention","CommentsPost",s._LogType.Event,{mentionTotal:this._mentionsTotal.toString(),mentionWithPermission:this._mentionsWithAccess.toString(),mentionWithoutPermission:this._mentionsWithoutAccess.toString()});a._EngagementLogger.logEventWithLogEntry(e)},t}(i.Component);t.a=k},xvAL:function(e,t,n){"use strict";n("Mrrk"),t.a={spAction:"l_e_ada2ac09",spActionLike:"m_e_ada2ac09",spActions:"n_e_ada2ac09",spActionsHidden:"o_e_ada2ac09",spAuthor:"p_e_ada2ac09",spAvatar:"q_e_ada2ac09",spAvatarImage:"r_e_ada2ac09",spButton:"s_e_ada2ac09",spCommentSection:"t_e_ada2ac09",spComment:"u_e_ada2ac09",spComments:"v_e_ada2ac09",spReply:"w_e_ada2ac09",spInput:"x_e_ada2ac09",spContent:"y_e_ada2ac09",spContentRegion:"z_e_ada2ac09",spDisabledAvatarOverlay:"aa_e_ada2ac09",spField:"ab_e_ada2ac09",spHeader:"ac_e_ada2ac09",fluent:"ae_e_ada2ac09",spInputContrastRatioOverwrite:"af_e_ada2ac09",spInputLimit:"ag_e_ada2ac09",spInputLimitExceeded:"ah_e_ada2ac09",spMore:"ai_e_ada2ac09",spMetadata:"aj_e_ada2ac09",spMoreBlock:"ak_e_ada2ac09",spReplyButtonBlock:"al_e_ada2ac09",spText:"am_e_ada2ac09",commentRichText:"an_e_ada2ac09",spToggleWrapper:"ao_e_ada2ac09",spLikesList:"ap_e_ada2ac09",spLikesPanel:"aq_e_ada2ac09",spLikesPanelContent:"ar_e_ada2ac09",spLikesPanelHeader:"as_e_ada2ac09",spLikesPanelHeaderText:"at_e_ada2ac09"}}}]);