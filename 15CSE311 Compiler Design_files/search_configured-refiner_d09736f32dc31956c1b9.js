(window.msfast_searchux_search_jsonp=window.msfast_searchux_search_jsonp||[]).push([[12],{1149:function(e,t,n){"use strict";n.r(t),n.d(t,"refinerConfigurations",function(){return S}),n.d(t,"setRefinerConfigurations",function(){return h}),n.d(t,"attachOrRemoveReducer",function(){return R});var i=n(1),r=n(3),a=n(74),s=n(911),o=n(610),u=n(209),l=n(323),c=n(1616),f=n(986),d=n(1617),v=n(743),g=n(1111),b=n(1611),m=n(1849),p=n(430),O=n(1028),j=function(e){var t=Object(i.__assign)({},e);return Object(r.keys)(t).forEach(function(e){var n=t[e];t[e]=Object(i.__assign)(Object(i.__assign)({},n),{values:n.values.reduce(function(e,t){return Object(f.i)(t.name)?e:(e.push(Object(i.__assign)(Object(i.__assign)({},t),{isSelected:!1})),e)},[]),hasSelectedValue:!1})}),t},y=function(e,t){var n,a;if((null==t?void 0:t.values)&&e.values){var s=t.values.map(function(e){return e.name}),o=e.values.map(function(e){return e.name}),u=Object(r.difference)(s,o),l=function(n){var a=Object(r.find)(t.values,function(e){return e.name===n});e.values.push(Object(i.__assign)(Object(i.__assign)({},a),{isAvailable:!1,estimatedCount:0}))};try{for(var c=Object(i.__values)(u),f=c.next();!f.done;f=c.next()){l(f.value)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}}},_=function(e){return Object(g.a)(e,function(e){return Object(i.__assign)(Object(i.__assign)({},e),{values:Object(b.resetRefinerValuesAvailability)(e.values)})})};function S(e,t){switch(void 0===e&&(e={}),t.type){case u.b.ADD_VERTICAL_CONFIGURATIONS:return Object(i.__assign)(Object(i.__assign)({},Object(m.c)(t.verticals)),e);case o.c:var n=Object(r.keys)(e).sort(),a=Object(r.keys)(t.refinerConfigurationsMap).sort();if(Object(r.isEqual)(n,a))return e;var s=Object(r.intersection)(n,a);return Object(i.__assign)(Object(i.__assign)({},t.refinerConfigurationsMap),Object(r.pick)(e,s));case o.b:var l=_(e),c=Object(i.__assign)(Object(i.__assign)({},l),t.refinerConfigurationsMap);return Object(r.keys)(c).forEach(function(e){var t,n=c[e];n.type===f.f.String&&y(n,l[e]),(null===(t=n.values)||void 0===t?void 0:t.length)&&n.type!==f.f.DateTime&&n.fieldName!==v.a&&(n.values=n.values.sort(function(e,t){return String(e.name).localeCompare(String(t.name))}))}),c;case o.d:var g=j(e),b=Object(d.getRefinersFromUrlQuery)(t.state);return 0!==b.length&&b.forEach(function(e){g[e.id]=Object(i.__assign)(Object(i.__assign)({},e),{values:e.values.map(function(n){return Object(i.__assign)(Object(i.__assign)({},n),{isAvailable:t.deepLink||e.isAvailable})}),isAvailable:t.deepLink||e.isAvailable})}),g;default:return e}}var h=function(e){var t;if(a.a){var n=a.a.getState(),i=Object(r.values)(null===(t=null==n?void 0:n.verticalConfigurations)||void 0===t?void 0:t.verticals);0===i.length?Object(l.f)(e):Object(s.setRefinersConfigurationMap)(Object(m.c)(i)),Object(s.setRefinersFromQuery)(!0)}},R=function(e){var t,n=null===a.a||void 0===a.a?void 0:a.a.getState();if(n){if(!e&&!Object(p.b)()&&n[o.a])return a.a.removeReducer(o.a);n.verticalConfigurations||a.a.injectReducer("verticalConfigurations",O.a),n[o.a]||a.a.injectReducer(o.a,S);var i=Object(r.values)(null===(t=n.verticalConfigurations)||void 0===t?void 0:t.verticals);i.length?h(i):h(Object(c.getDefaultVerticalsConfiguration)())}}},1611:function(e,t,n){"use strict";n.r(t),n.d(t,"getRefinerQueryParamValuesFromUrl",function(){return f}),n.d(t,"generateRefinerStrings",function(){return v}),n.d(t,"generateRefinerString",function(){return g}),n.d(t,"resetRefinerValuesAvailability",function(){return b}),n.d(t,"getCustomRefinersCacheKey",function(){return m}),n.d(t,"createDateTimeRefinerString",function(){return p});var i=n(1),r=n(72),a=n(36),s=n(35),o=n(743),u=n(986),l=n(74),c=!1,f=function(e){var t={};try{var n=e[o.d];n&&(t=JSON.parse(n))}catch(e){!c&&Object(s.a)({eventType:"ERROR",name:"Malformed_CustomRefinerQuery",detail:e.message}),c=!0}return t},d=function(e){return e?'"ǂǂ'+e.split("").map(function(e){return e.charCodeAt(0).toString(16)}).join("")+'"':void 0},v=function(e){return e.type===u.f.String||e.type===u.f.Integer?e.values=e.values.map(g):e.type===u.f.DateTime&&(e.values=e.values.map(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{refinerString:p(e.range)})})),e},g=function(e){return e.groups?e.refinerString=e.groups.map(function(e){return d(String(e))}).join(","):e.range||(e.refinerString=d(String(e.name))),e},b=function(e){return e.map(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{estimatedCount:0,isAvailable:Object(u.i)(e.name)})})},m=function(){var e=l.a.getState(),t=(null==e?void 0:e.location).query,n=(void 0===t?{}:t)[o.d];return n?String(Object(r.e)(n)):void 0},p=function(e){var t=e.from,n=e.to,r=Object(i.__read)([Object(a.q)(t),Object(a.q)(n)],2),s=r[0],o=r[1];if(s&&o){var u=new Date(t),l=new Date(n);return Object(a.t)(u,l)?(u=new Date(u.getFullYear(),u.getMonth(),u.getDate(),0,0,0,0),l=new Date(l.getFullYear(),l.getMonth(),l.getDate(),23,59,59,999),"range("+u.toISOString()+", "+l.toISOString()+")"):"range("+t+", "+n+")"}return s?"range("+t+', max, to="le")':o?"range(min, "+n+")":void 0}},1616:function(e,t,n){"use strict";n.r(t),n.d(t,"getDefaultVerticalsConfiguration",function(){return a}),n.d(t,"defaultVerticalConfigState",function(){return s});var i=n(986),r=n(1849),a=function(){return[{id:"index",entities:[{contentSources:[{id:"SharePoint",name:"SharePoint"},{id:"OneDriveBusiness",name:"OneDriveForBusiness"}],entityType:"File",refinerIds:["index_FileType","index_LastModifiedTime"]},{contentSources:[{id:"SharePoint",name:"SharePoint"}],entityType:"Bookmark"},{entityType:"People"}],refiners:[Object(r.b)({id:"index_FileType"}),Object(r.a)({id:"index_LastModifiedTime",fieldName:"LastModifiedTime",category:i.e.Default})]},{id:"files",entities:[{contentSources:[{id:"SharePoint",name:"SharePoint"},{id:"OneDriveBusiness",name:"OneDriveForBusiness"}],entityType:"File",refinerIds:["files_FileType","files_LastModifiedTime"]}],refiners:[Object(r.b)({id:"files_FileType"}),Object(r.a)({id:"files_LastModifiedTime",fieldName:"LastModifiedTime",category:i.e.Default})]},{id:"sites",refiners:[]},{id:"people",refiners:[]},{id:"news",refiners:[Object(r.a)({id:"news_LastModifiedTime",fieldName:"LastModifiedTime",category:i.e.Default})]},{id:"groupfiles",refiners:[Object(r.b)({id:"groupfiles_FileType"}),Object(r.a)({id:"groupfiles_LastModifiedTime",category:i.e.Default,fieldName:"LastModifiedTime"})]},{id:"siteall",refiners:[Object(r.b)({id:"siteall_FileType"}),Object(r.a)({id:"siteall_LastModifiedTime",category:i.e.Default,fieldName:"LastModifiedTime"})]},{id:"sitefiles",refiners:[Object(r.b)({id:"sitefiles_FileType"}),Object(r.a)({id:"sitefiles_LastModifiedTime",category:i.e.Default,fieldName:"LastModifiedTime"})]},{id:"sitesites",refiners:[]},{id:"sitenews",refiners:[Object(r.a)({id:"sitenews_LastModifiedTime",category:i.e.Default,fieldName:"LastModifiedTime"})]},{id:"videos",refiners:[Object(r.a)({id:"videos_LastModifiedTime",category:i.e.Default,fieldName:"LastModifiedTime"})]},{id:"pindex",refiners:[]},{id:"content",refiners:[Object(r.b)({id:"content_FileType"})]},{id:"pfiles",refiners:[Object(r.b)({id:"pfiles_FileType"}),Object(r.a)({id:"pfiles_LastModifiedTime",category:i.e.Default,fieldName:"LastModifiedTime"})]},{id:"psites",refiners:[]},{id:"pnews",refiners:[Object(r.a)({id:"pnews_LastModifiedTime",category:i.e.Default,fieldName:"LastModifiedTime"})]}]},s=function(){var e={};return a().forEach(function(t){e[t.id]=t}),e}},1617:function(e,t,n){"use strict";n.r(t),n.d(t,"getRefinersForVertical",function(){return u}),n.d(t,"getAppliedRefinerQuery",function(){return d}),n.d(t,"getRefinersFromUrlQuery",function(){return O}),n.d(t,"createRefinerQuery",function(){return _}),n.d(t,"updateAvailableCustomRefiners",function(){return $}),n.d(t,"getDateTimeAggregations",function(){return L}),n.d(t,"createCustomAggregations",function(){return V}),n.d(t,"isCustomRefinerApplied",function(){return y});var i=n(1),r=n(74),a=n(610),s=function(e){return void 0===e&&(e=r.a.getState()),(null==e?void 0:e[a.a])||{}},o=n(126),u=function(e,t,n){void 0===e&&(e=r.a.getState()),void 0===n&&(n=!0);var a=Object(o.c)(e,t);if(!a||!a.refiners)return[];var u=s(e),l=a.refiners.map(function(e){return e.id}).reduce(function(e,t){var n=u[t];return n?(n=Object(i.__assign)(Object(i.__assign)({},n),{values:n.values.reduce(function(e,t){var n=Object(i.__assign)({},t);return e.push(n),e},[])}),e.push(n),e):e},[]);return n?l.filter(function(e){return e.isAvailable}):l},l=n(3),c=n(986),f=n(743),d=function(e,t,n){var a,s,u;void 0===e&&(e=[]),void 0===t&&(t=r.a.getState());var d=t.location.query,v=Object(o.c)(t,n);if(!v||!v.refiners)return[];var g={},b=!1,m=function(e,t){return void 0===t&&(t=!1),t&&!Object(c.i)(e.name)?e.type:e.range||e.groups||e.name},p=function(e){var t,n=e.fieldName,i=e.values,r=void 0===i?[]:i,a=e.displayInterface,s=void 0===a?c.b.SingleSelect:a,o=e.fieldName===f.a||e.type===c.f.DateTime;return e.hasSelectedValue&&0!==r.length?s===c.b.SingleSelect?(r.some(function(e){return e.isSelected&&(t=m(e,o)),e.isSelected}),Object(l.isUndefined)(t)||Object(l.isNull)(t)||(g[n]=t,b=!0),"continue"):(t=[],r.forEach(function(e){e.isSelected&&t.push(m(e,o))}),void(t.length>0&&(g[n]=t,b=!0))):"continue"};try{for(var O=Object(i.__values)(e),j=O.next();!j.done;j=O.next()){p(j.value)}}catch(e){a={error:e}}finally{try{j&&!j.done&&(s=O.return)&&s.call(O)}finally{if(a)throw a.error}}return Object(i.__assign)(Object(i.__assign)({},Object(l.omit)(d,[f.d])),b?((u={})[f.d]=JSON.stringify(g),u):void 0)},v=n(1611),g=function(e,t,n){return void 0===n&&(n=!1),n?t===e.type:Boolean(e.name===t||e.groups&&t&&Object(l.isArray)(t)&&Object(l.intersection)(t,e.groups).length>0||Object(l.isString)(t)&&Object(l.find)(e.groups,function(e){return e.toLowerCase()===t.toLowerCase()})||e.range&&Object(l.isEqual)(Object(l.pick)(t,["from","to"]),e.range))},b=function(e,t){var n;if(t)return t.from||t.to?(n={name:f.b,range:t,isSelected:!0,isAvailable:!0},e.type===c.f.DateTime&&(n.refinerString=Object(v.createDateTimeRefinerString)(t))):e.values[0]&&e.values[0].groups?(n={name:t,groups:[t],isSelected:!0,isAvailable:!0},e.fieldName===f.a&&(n.type=t),Object(v.generateRefinerString)(n)):(n={name:t,isSelected:!0,isAvailable:!0},Object(v.generateRefinerString)(n)),n},m=function(e,t){var n=p(e.values),r=!1,a=e.fieldName===f.a,s=e.type===c.f.DateTime;return e.displayInterface===c.b.SingleSelect?n.some(function(e){var n;return g(e,t,(n=t,a&&Object(c.h)(n)||s&&Object(c.g)(n)))&&(e.isSelected=r=!0),e.isSelected}):e.displayInterface===c.b.MultiSelect&&Object(l.isArray)(t)&&t.forEach(function(t){var s,o,u=!1;try{for(var l=Object(i.__values)(n),f=l.next();!f.done;f=l.next()){var d=f.value;g(d,t,a&&Object(c.h)(t))&&(d.isSelected=r=u=!0)}}catch(e){s={error:e}}finally{try{f&&!f.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}u||(t&&n.push(b(e,t)),r=!0)}),r||(t&&n.push(b(e,t)),r=!0),{hasSelectedValue:r,values:n}},p=function(e){return e.map(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{isSelected:!1})})},O=function(e,t){void 0===e&&(e=r.a.getState());var n=e.location.query,a=Object(o.c)(e,t);if(!(null==a?void 0:a.refiners)||!n[f.d])return[];var u=Object(v.getRefinerQueryParamValuesFromUrl)(n),c=s(e);return a.refiners.map(function(e){var t=c[null==e?void 0:e.id];if(t){var n=u[t.fieldName];if(!Object(l.isUndefined)(n)&&!Object(l.isNull)(n)){var r=m(t,n),a=r.values,s=r.hasSelectedValue;return Object(i.__assign)(Object(i.__assign)({},t),{values:a,hasSelectedValue:s,isAvailable:s})}}}).filter(function(e){return e&&e.hasSelectedValue})},j=function(e,t){return u(e,t).filter(function(e){return!!e&&e.isAvailable&&e.hasSelectedValue})},y=function(){return j().length>0},_=function(e){void 0===e&&(e=j());var t=e;if(0===t.length)return null;var n=t.reduce(function(e,t){var n,i,r=t.values.filter(function(e){return e.isSelected});if(t.fieldName===f.a&&Object(l.find)(r,function(e){return e.type===f.c})){var a=function(e){var t=e.values.filter(function(e){return!e.isSelected&&e.type!==f.c}).reduce(function(e,t){return t.refinerString?e.concat(t.refinerString):e},[]);if(t.length>0)return{RefinerString:"FileType:not(or("+t.join(",")+"))"}}(t);return a&&e.push(a),e}if(t.displayInterface===c.b.SingleSelect?(null===(n=r[0])||void 0===n?void 0:n.refinerString)&&(i=r[0].refinerString):i=r.map(function(e){return e.refinerString}).filter(Boolean).join(","),i){var s=i.match(/range/gi),o=s?s.length>1:i.split(",").length>1;e.push({RefinerString:o?t.fieldName+":or("+i+")":t.fieldName+":("+i+")"})}return e},[]);return n.length>0?n:null},S=n(277);var h=function(e){return null===e};var R=function(e){return void 0===e},T=n(911),A=n(530),x=n(111),C=n(51),D=n(487),E=n(30),N=n(775),w=n(625),M=n(35),F=n(951),I=n(40),L=function(e){var t=u(),n=[];return t.forEach(function(t){t.type===c.f.DateTime&&t.fieldName===e&&t.values.forEach(function(e){if(!Object(c.i)(e.name)){var t={};e.range.to&&(t.To=e.range.to),e.range.from&&(t.From=e.range.from),n.push(t)}})}),n},V=function(e){var t,n;null===(t=Object(I.c)())||void 0===t||t.mark("CreateCustomAggregationsStart");var r=Object(o.d)()[e];if(r&&0!==r.length)try{var a=r.reduce(function(e,t){switch(t.type){case c.f.String:return Object(i.__assign)(Object(i.__assign)({},e),k(t.fieldName));case c.f.DateTime:return Object(i.__assign)(Object(i.__assign)({},e),P(t.fieldName));case c.f.Integer:return Object(i.__assign)(Object(i.__assign)({},e),Q(t))}return e},{});return null===(n=Object(I.c)())||void 0===n||n.mark("CreateCustomAggregationsDone"),Object(E.a)(a)?void 0:a}catch(e){Object(F.logCreateAggregationError)(e)}},k=function(e){var t;return(t={})[e]={Histogram:{Field:e}},t},P=function(e){var t;return(t={})[e]={Histogram:{Field:e,Ranges:L(e)}},t},Q=function(e){var t,n=e.fieldName,i=B(e),r=((t={})[n]={Histogram:{Field:e.fieldName}},t);return i.length>0&&(r[n].Histogram.Ranges=i),r},B=function(e){var t=e.values,n=[];t.forEach(function(e){e.range&&n.push(e.range)});var i=q(n);if(U(i))return i;Object(M.a)({eventType:"ERROR",name:"Invalid_IntegerRanges_CustomRefiners",detail:"Invalid ranges in the "+e.fieldName+" refiner"})},q=function(e){var t=Object(N.a)(e,"to"),n=Object(w.a)(t,function(e){return R(e.to)||h(e.to)});return n&&t.push(t.splice(n,1)[0]),t},U=function(e){var t=e.length-1,n=0,i=0;if(!e[0].to&&e[0].from&&!e[t].from&&e[t].to)return!1;for(var r=0;r<=t;r++){var a=e[r];if(a.to&&!a.from&&++n>1)return!1;if(a.from&&!a.to&&++i>1)return!1;if(e[r+1]&&a.to!==e[r+1].from)return!1}return!0},H=function(e,t){return function(e,t){var n=function(e){return!h(e)&&!R(e)};return t.map(function(t){var r;if(Object(c.i)(t.name))return t;var a=t.range,s=a.from,o=a.to;n(s)&&n(o)?r=s+" up to "+o:n(o)?r="Less than "+o:n(s)&&(r=s+" and up");var u=r&&Object(l.find)(e,function(e){return 0===e.Value.indexOf(r)});return u?Object(i.__assign)(Object(i.__assign)({},t),{isAvailable:!0,estimatedCount:0|u.EstimatedCount,refinerString:u.RefiningQuery.RefinerString}):Object(i.__assign)(Object(i.__assign)({},t),{isAvailable:!1})})}(e,t.values)},Y=function(e,t){var n,r,a,s=(null===(n=t[e.fieldName])||void 0===n?void 0:n.Buckets)||[],o=!1,u=!!(null===(r=e.values[0])||void 0===r?void 0:r.groups),f=!!(null===(a=e.values[0])||void 0===a?void 0:a.range);switch(e.type){case c.f.String:u?z(e,s):o=!0;break;case c.f.DateTime:var d=function(e){var t,n;-1===((null===(t=Object(C.a)(e))||void 0===t?void 0:t.Value)||"").indexOf("Before ")&&-1===((null===(n=Object(D.a)(e))||void 0===n?void 0:n.Value)||"").indexOf("later")||(e=e.reverse());try{return e?e.map(function(t,n){var i,r,a,s=0===n,o=n+1===e.length,u=Object(A.c)(n);return{type:u,estimatedCount:(i=e,r=u,a=n,i.slice("older"===r?a:0,a+1).map(function(e){return e.EstimatedCount||0}).reduce(function(e,t){return e+t},0)),refinerString:s||o?""+t.RefiningQuery.RefinerString:""+e.slice(0,n+1).map(function(e){return e.RefiningQuery.RefinerString}).join(",")}}).filter(function(e){return e.estimatedCount>0}):[]}catch(e){Object(x.throwSafeToLogError)("Parse DateTime refiner from query Response failed",e)}}(s);e.values=X(e,d);break;case c.f.Integer:if(u)z(e,s);else if(f){var v=H(s,e);e.values=v}else o=!0;break;default:o=!0}return o&&function(e,t){var n=[];t.forEach(function(t){var r=Object(l.find)(e.values,function(e){return String(t.Value)===String(e.name)});n.push(Object(i.__assign)(Object(i.__assign)({},r),{name:t.Value,isAvailable:!0,estimatedCount:t.EstimatedCount,refinerString:t.RefiningQuery.RefinerString}))}),e.values=0===t.length?e.values:n,e.isAvailable=e.values.length>0}(e,s),e},W=function(e,t){var n=function(e,t){var n,r,a=u(t,void 0,!1),s=e.EntitySets,o={},l={};s.forEach(function(e){e.ResultSets.forEach(function(e){var t=e.Aggregations;Object(E.a)(t)||(l=Object(i.__assign)({},J(l,t,a)))})});try{for(var c=Object(i.__values)(a),f=c.next();!f.done;f=c.next()){var d=f.value,g=Object(i.__assign)(Object(i.__assign)({},d),{values:Object(v.resetRefinerValuesAvailability)(d.values)});Y(g,l),o[g.id]=g}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return o}(e,t);r.a.dispatch(Object(T.setAvailableCustomRefiners)(n))},J=function(e,t,n){return Object.keys(e).length>0?(Object.keys(t).forEach(function(i){var r;if((null===(r=e[i])||void 0===r?void 0:r.Field)===t[i].Field){(function(){var t,r,a,s=null===(t=e[i])||void 0===t?void 0:t.Field,o=Object(l.find)(n,function(e){return e.fieldName===s});return!!o&&Boolean(null===(a=null===(r=null==o?void 0:o.values)||void 0===r?void 0:r[0])||void 0===a?void 0:a.range)})()||Object(l.isEqual)(e[i],t[i])||(e[i].Buckets=G(e[i].Buckets,t[i].Buckets))}else e[i]=t[i]}),e):Object(i.__assign)({},t)},G=function(e,t){void 0===t&&(t=[]);var n=Object(i.__spread)(e),r=n.reduce(function(e,t){return e[t.Value]=!0,e},{});return t.forEach(function(e){r[e.Value]||n.push(e)}),n},K=function(e,t,n){void 0===n&&(n=!1);var i=!1,r=0,a=e.groups=(n?Object.keys(t):e.groups)||[],s=e.refinerString?e.refinerString.split(","):[];a.forEach(function(e){var n=t[e];if(n){var a=n.RefiningQuery.RefinerString;i=!0,r+=Number(n.EstimatedCount),-1===s.indexOf(a)&&s.push(a),delete t[e]}}),e.isAvailable=i,e.estimatedCount=r,s.length&&(e.refinerString=s.join(","))},z=function(e,t){var n,r,a,s=function(e){var t={};return e.forEach(function(e){var n=(e.Value||"").trim().toLowerCase(),r=t[n];t[n]=r?Object(i.__assign)(Object(i.__assign)({},r),{EstimatedCount:(0|r.EstimatedCount)+(0|e.EstimatedCount),RefiningQuery:{RefinerString:r.RefiningQuery.RefinerString+","+e.RefiningQuery.RefinerString}}):e}),t}(t);try{for(var o=Object(i.__values)(e.values),u=o.next();!u.done;u=o.next()){var l=u.value;"other"===l.type&&(a=l),K(l,s)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}a&&K(a,s,!0)},X=function(e,t){return e.type===c.f.DateTime?e.values.map(function(e){var n=Object(l.find)(t,function(t){return t.type===e.type});return n&&(e.isAvailable=0!==n.estimatedCount,e.estimatedCount=n.estimatedCount,e.refinerString=n.refinerString),e}):[]},Z=function(e,t,n){var i=[];return e&&e.EntitySets&&e.EntitySets.forEach(function(e){var r="External"===e.EntityType?e.ResultSets:e.ResultSets?e.ResultSets.filter(function(e){return e.ContentSources&&Object(l.isArray)(e.ContentSources)&&e.ContentSources.some(function(e){return n.indexOf(e)>-1})}):[];e.EntityType&&-1!==t.indexOf(e.EntityType)&&r.length>0&&i.push({ResultSets:r,EntityType:e.EntityType,Instrumentation:e.Instrumentation,Position:e.Position})}),i},$=function(e,t,n,i,r){var a,s;null===(a=Object(I.c)())||void 0===a||a.mark("UpdateAvailableRefinersStart");var o=function(e,t,n,i,r){try{return{ApiVersion:e.ApiVersion,Instrumentation:e.Instrumentation,EntitySets:Z(e,t,n)}}catch(e){i.addFailure(e.correlationID,S.a.modifyResponseError,r,"Refiner Customisation flow - modifyResponse failed.")}}(e,t,n,i,r);W(o),null===(s=Object(I.c)())||void 0===s||s.mark("UpdateAvailableRefinersDone")}},1849:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return f}),n.d(t,"c",function(){return d});var i=n(1),r=n(3),a=n(570),s=n(569),o=n(986),u=n(1611),l=n(429),c=function(e){var t=Object(i.__assign)(Object(i.__assign)({category:o.e.Default,displayInterface:o.b.MultiSelect},e),{fieldName:"FileType",displayName:(null==e?void 0:e.displayName)||"FileType",manualEntryEnabled:!1,type:o.f.String,values:[{name:"PowerPoint",groups:["pptx","ppt","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","odp","powerpoint"],isAvailable:!0,isSelected:!1,type:o.c.pptx},{name:"Word",groups:["doc","docx","docm","dot","dotx","doc (dx)","doc (third party)","dotm","odt","docb","wbk","rtf"],isAvailable:!0,isSelected:!1,type:o.c.docx},{name:"Excel",groups:["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xls","xll","xlam","xlw","excel","csv","odc"],isAvailable:!0,isSelected:!1,type:o.c.xlsx},{name:"OneNote",groups:["one"],isAvailable:!0,isSelected:!1,type:o.c.one},{name:"PDF",groups:["pdf"],isAvailable:!0,isSelected:!1,type:o.c.pdf},{name:"Photo",groups:l.b,isAvailable:!0,isSelected:!1,type:o.c.photo},{name:"Video",groups:["mp4","mov","avi","wmv","mkv","3gp","mpeg","mpg","ogg","webm","asf","ogv","vtt"],isAvailable:!0,isSelected:!1,type:o.c.video},{name:"Web page",groups:["asp","aspx"],isAvailable:!0,isSelected:!1,type:o.c.html},{name:"Other",isAvailable:!0,isSelected:!1,type:o.c.other}],isAvailable:!0,hasSelectedValue:!1});return Object(u.generateRefinerStrings)(t),t},f=function(e){var t=new Date,n=new Date,r=new Date,a=new Date,s=new Date,l=new Date;n.setDate(t.getDate()-1),r.setDate(t.getDate()-7),a.setMonth(t.getMonth()-1),s.setMonth(t.getMonth()-3),l.setMonth(t.getMonth()-12);var c=Object(i.__assign)(Object(i.__assign)({category:o.e.Default,manualEntryEnabled:!0},e),{displayInterface:o.b.SingleSelect,showCount:!0,customIntervals:[],type:o.f.DateTime,values:[{name:"Older than a year",range:{to:l.toISOString()},isAvailable:!0,isSelected:!1,type:o.a.OlderThanYear},{name:"Past year",range:{from:l.toISOString(),to:s.toISOString()},isAvailable:!0,isSelected:!1,type:o.a.PastYear},{name:"Past 3 months",range:{from:s.toISOString(),to:a.toISOString()},isAvailable:!0,isSelected:!1,type:o.a.Past3Months},{name:"Past month",range:{from:a.toISOString(),to:r.toISOString()},isAvailable:!0,isSelected:!1,type:o.a.PastMonth},{name:"Past week",range:{from:r.toISOString(),to:n.toISOString()},isAvailable:!0,isSelected:!1,type:o.a.PastWeek},{name:"Past 24 hours",range:{from:n.toISOString()},isAvailable:!0,isSelected:!1,type:o.a.Past24Hours}],isAvailable:!0,hasSelectedValue:!1});return Object(u.generateRefinerStrings)(c),c},d=function(e){void 0===e&&(e=[]);var t={};return e.forEach(function(e){var n;(null===(n=null==e?void 0:e.refiners)||void 0===n?void 0:n.length)>0&&(null==e?void 0:e.refiners).forEach(function(e){var n,u=Object(o.j)(null==e?void 0:e.category,(null===(n=null==e?void 0:e.layout)||void 0===n?void 0:n.fieldName)||(null==e?void 0:e.fieldName));(u&&Object(a.a)()||Object(s.a)()&&!u)&&(t[e.id]=function(e,t){var n,a=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},Object(r.omit)(e,"layout")),e.layout),{values:(null===(n=e.layout)||void 0===n?void 0:n.values)||[]});return a.fieldName===o.d.FileType?a=c(a):a.type===o.f.DateTime&&(a=f(t&&!(null==a?void 0:a.displayName)?Object(i.__assign)(Object(i.__assign)({},a),{displayName:"Last modified time"}):a)),a}(e,u))})}),t}}}]);