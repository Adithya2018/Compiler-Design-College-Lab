define("1cea229f-b208-4202-8014-22503d92a019_0.1.0",["tslib","@ms/sp-telemetry","@microsoft/sp-image-helper","@microsoft/sp-loader","@ms/odsp-core-bundle","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","@ms/i18n-utilities","@ms/sp-component-utilities","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(e,t,r,n,i,a,o,s,u,c,l,p,d,h){return function(e){function t(t){for(var r,i,a=t[0],o=t[1],s=0,c=[];s<a.length;s++)i=a[s],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&c.push(n[i][0]),n[i]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);for(u&&u(t);c.length;)c.shift()()}var r={},n={0:0};function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(e){var t=[],r=n[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise(function(t,i){r=n[e]=[t,i]});t.push(r[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+"chunk."+({1:"sp-queryablemanagedproperties",2:"sp-retrievablemanagedproperties"}[e]||e)+"_"+"none"+"_"+{1:"de642cf7c09c45b9e60f",2:"6ffbb2dac325407c2513"}[e]+".js"}(e);var u=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(c);var r=n[e];if(0!==r){if(r){var i=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+i+": "+a+")",u.name="ChunkLoadError",u.type=i,u.request=a,r[1](u)}n[e]=void 0}};var c=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=r,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var a=window.webpackJsonp_1cea229f_b208_4202_8014_22503d92a019_0_1_0=window.webpackJsonp_1cea229f_b208_4202_8014_22503d92a019_0_1_0||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var u=o;return function(){var e,t=document.getElementsByTagName("script"),r="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-dataproviders_en-us_45e68901a2dbd601528c\.js/i;if(t&&t.length)for(var n=0;n<t.length;n++)if(t[n]){var a=t[n].getAttribute("src");if(a&&a.match(r)){e=a.substring(0,a.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(r)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="mwqp")}({"17wl":function(t,r){t.exports=e},"2q6Q":function(e,r){e.exports=t},"3Rlg":function(e,t,r){e.exports=r.p+"icon_helpitemimg2-2x_5a055172.png"},"6DSs":function(e){e.exports=JSON.parse('{"a":"Can\\u0027t get data. {0}: {1} REST call failed. Status Code: {2} Status Message: {3}"}')},"8dK2":function(e,t){e.exports=r},"9G/9":function(e){e.exports=JSON.parse('{"a":"Search"}')},AzJr:function(e,t,r){e.exports=r.p+"icon_helpitemimg3_7f442b60.png"},H4oF:function(e,t,r){e.exports=r.p+"icon_helpitemimg1-2x_296a0ca6.png"},I6O9:function(e,t){e.exports=n},K9kD:function(e,t){e.exports=i},KL1q:function(e,t){e.exports=a},MNck:function(e,t,r){var n=r("K9kD");e.exports=n.SPAlternativeUrls},Pk8u:function(e,t){e.exports=o},QRxg:function(e){e.exports=JSON.parse('{"a":"Page"}')},"R/pT":function(e){e.exports=JSON.parse('{"a":"Can\\u0027t get data. A list identifier or title must be specified."}')},UWqr:function(e,t){e.exports=s},"X+PM":function(e,t){e.exports=u},Ycni:function(e,t){e.exports=c},YkpB:function(e){e.exports=JSON.parse('{"b":"List","a":"Invalid ListRequestType value."}')},fMQH:function(e,t,r){e.exports=r.p+"icon_helpitemimg1_c0dba21d.png"},fP0x:function(e){e.exports=JSON.parse('{"b":"Unknown error happens.","a":"This Events list no longer exists. Try a different Events list."}')},hE4m:function(e){e.exports=JSON.parse('{"n":"Keep your team updated with news on your team site","m":"From the site home page you\\u0027ll be able to quickly author a news post â€“ a status update, trip report, or even just highlight a document with some additional context provided to the team.","o":"https://go.microsoft.com/fwlink/p/?linkid=827920","q":"What is a team site?","p":"A SharePoint team site connects you and your team to the content, information, and apps you rely on every day. For example, you can use a team site to store and collaborate on files or to create and manage lists of information. On a team site home page, you can view links to important team files, apps, and web pages and see recent site activity in the activity feed.","r":"https://go.microsoft.com/fwlink/p/?linkid=827918","t":"Add a page to a site","s":"Using pages is a great way to share ideas using images, Excel, Word and PowerPoint documents, video, and more. You can create and publish pages quickly and easily, and they look great on any device. When you create a page, you add and customize web parts with a toolbox available right in the editing pane. And, you can publish with just a click.","u":"https://go.microsoft.com/fwlink/p/?linkid=827919","x":"Welcome to the new team site experience","w":"Quickly author a new news post, a status update, or a trip report on the new team site home page.","v":"SharePoint","B":"News","y":"Hub News","A":"My News","z":"Multi-site News","c":"Create a news post","e":"No news posts are available right now","b":"Keep your audience engaged by sharing your latest updates.","d":"Check back later to see the latest News.","k":"Title of news post","j":"Preview that shows the first few lines of the article.","i":"Author name","l":"A few seconds ago","a":"Automatic","f":"Build successful portals","g":"Modern SharePoint branding","h":"SharePoint News reaches more users"}')},hfyH:function(e,t,r){e.exports=r.p+"icon_helpitemimg3-2x_ef307bcc.png"},"hiL/":function(e,t){e.exports=l},lMGj:function(e,t,r){e.exports=r.p+"icon_helpitemimg2_4dca3af9.png"},mwqp:function(e,t,r){"use strict";r.r(t),r.d(t,"BaseDataProvider",function(){return o}),r.d(t,"BookmarksDataProvider",function(){return m}),r.d(t,"NewsUtilities",function(){return U}),r.d(t,"news",function(){return F}),r.d(t,"viewCounts",function(){return N}),r.d(t,"currentViewCounts",function(){return A}),r.d(t,"hubNews",function(){return O}),r.d(t,"newsDigest",function(){return L}),r.d(t,"multiSiteNews",function(){return q}),r.d(t,"myNews",function(){return M}),r.d(t,"staleViewCounts",function(){return k}),r.d(t,"NewsDataSource",function(){return w}),r.d(t,"newsDataSourceProp",function(){return P}),r.d(t,"_appendAudienceFilteringQueryParam",function(){return C}),r.d(t,"_appendLanguageOverrideQueryParam",function(){return b}),r.d(t,"_getExtraDataForLogging",function(){return T}),r.d(t,"NewsEmptyStateType",function(){return E}),r.d(t,"ExchangeViewCountsDataProvider",function(){return K}),r.d(t,"HubNewsDataProvider",function(){return Y}),r.d(t,"MicroServiceNewsDataProvider",function(){return Z}),r.d(t,"NewsDataProvider",function(){return $}),r.d(t,"NewsDigestDataProvider",function(){return ee}),r.d(t,"NewsDigestUtilities",function(){return te}),r.d(t,"NewsSearchDataProvider",function(){return ve}),r.d(t,"MultiSiteNewsDataProvider",function(){return ye}),r.d(t,"MyNewsDataProvider",function(){return Se}),r.d(t,"tryGetAuthoritativeSiteDetails",function(){return x}),r.d(t,"DocumentType",function(){return oe}),r.d(t,"FilterOperator",function(){return se}),r.d(t,"FilterSince",function(){return ue}),r.d(t,"FilterType",function(){return ce}),r.d(t,"UserType",function(){return de}),r.d(t,"TokenUtilities",function(){return he}),r.d(t,"ContentLocation",function(){return ie}),r.d(t,"ContentType",function(){return ae}),r.d(t,"DeferredManagedProperties",function(){return we}),r.d(t,"KQLQueryBuilder",function(){return ge}),r.d(t,"AUDIENCE_TARGET_KQL_QUERY",function(){return fe}),r.d(t,"ManagedDataType",function(){return le.a}),r.d(t,"SortType",function(){return pe}),r.d(t,"SearchDataProvider",function(){return me}),r.d(t,"PersonaSettingsCache",function(){return Pe}),r.d(t,"sanitizeSearchQueryParameter",function(){return Ce}),r.d(t,"CAMLQueryBuilder",function(){return Oe}),r.d(t,"ListRequestType",function(){return Le}),r.d(t,"ListDataProvider",function(){return Me}),r.d(t,"ContentRollupDataProvider",function(){return ke}),r.d(t,"EventDataProvider",function(){return $e}),r.d(t,"EventsSearchDataProvider",function(){return et}),r.d(t,"EventsListDataProvider",function(){return rt}),r.d(t,"PageDataProvider",function(){return at}),r.d(t,"PageDataSource",function(){return nt}),r.d(t,"_getWebPartDataFromPage",function(){return ut}),r.d(t,"PageSearchDataProvider",function(){return lt}),r.d(t,"TemplatePanelDataSource",function(){return pt}),r.d(t,"TemplateSelectedPageCopyDataSource",function(){return dt}),r.d(t,"TemplateSelectedPageAsJsonDataSource",function(){return ht}),r.d(t,"DefaultNewPageTemplateIdDataSource",function(){return ft}),r.d(t,"DeleteTemplatePageDataSource",function(){return gt}),r.d(t,"TemplatePanelDataProvider",function(){return _t}),r.d(t,"TemplatePanelSelectedPageCopyDataProvider",function(){return mt}),r.d(t,"TemplatePanelSelectedPageAsJsonDataProvider",function(){return vt}),r.d(t,"DefaultNewPageTemplateIdDataProvider",function(){return yt}),r.d(t,"DeleteTemplatePageDataProvider",function(){return St}),r.d(t,"RecentDocumentsDataProvider",function(){return wt}),r.d(t,"BingLocationDataProvider",function(){return Pt}),r.d(t,"TopicSuggestionSearchDataProvider",function(){return Et}),r.d(t,"TopicFirstRunDataProvider",function(){return qt}),r.d(t,"TopicFirstRunKeys",function(){return At}),r.d(t,"ViewCountDataProvider",function(){return G}),r.d(t,"ListDataSource",function(){return Ee}),r.d(t,"ListFieldDataSource",function(){return xe}),r.d(t,"ListFieldType",function(){return Re}),r.d(t,"ListItemDataSource",function(){return Ne}),r.d(t,"SPRenderListDataOptions",function(){return Ue}),r.d(t,"ListViewDataSource",function(){return Ae}),r.d(t,"BaseDataSource",function(){return be}),r.d(t,"ODataQueryStringBuilder",function(){return De}),r.d(t,"SPDataSource",function(){return Ie}),r.d(t,"SPHomeHttpClient",function(){return _}),r.d(t,"SPHomeMicroserviceNotAvailableError",function(){return l}),r.d(t,"SeeAllPageLayoutWebparts",function(){return Mt}),r.d(t,"SearchAPIRequest",function(){return ne}),r.d(t,"SearchAPISortDirection",function(){return re});var n=r("X+PM"),i=r("vlQI"),a=r("UWqr"),o=function(){function e(e){return this._options=e,this._serviceScope=e.serviceScope,this}return e.prototype.requestData=function(e){var t=this;return this.resolveServices().then(function(){return t.getItems(e)})},e.prototype.resolveServices=function(){var e=this;return new Promise(function(t,r){e._serviceScope.whenFinished(function(){e._pageContext=e._serviceScope.consume(n.PageContext.serviceKey),e._baseEndPoint=a.UrlUtilities.removeEndSlash(e._pageContext.web.absoluteUrl),e._options.useHttpClient?e._httpClient=e._serviceScope.consume(i.HttpClient.serviceKey):e._spHttpClient=e._serviceScope.consume(i.SPHttpClient.serviceKey),e._options.requiresTokenProvider&&(e._tokenProvider=e._serviceScope.consume(i.OAuthTokenProvider.serviceKey)),t()})})},Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"httpClient",{get:function(){return this._httpClient},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spHttpClient",{get:function(){return this._spHttpClient},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageContext",{get:function(){return this._pageContext},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tokenProvider",{get:function(){return this._tokenProvider},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseEndPoint",{get:function(){return this._baseEndPoint},enumerable:!0,configurable:!0}),e}(),s=r("ut3N"),u=r("KL1q"),c=r("hiL/"),l=function(e){this.name="SPHomeMicroserviceNotAvailableError",this.message="SPHome Microservice not available in this environment",this.message=e||this.message},p=r("17wl"),d=function(e){function t(t){var r=e.call(this,t)||this;return r._requestUpdater=function(e){return Promise.resolve(e)},r}return Object(p.__extends)(t,e),Object.defineProperty(t.prototype,"requestUpdater",{set:function(e){this._requestUpdater=e},enumerable:!0,configurable:!0}),t.prototype._fetch=function(t,r,n){var i=this;return this._requestUpdater({url:t,options:n}).then(function(t){return e.prototype._fetch.call(i,t.url,r,t.options)})},t}(i.SPHttpClient),h=a.ServiceKey.create("sp-http:SPHttpMicroserviceClient",d),f=function(){function e(){}return e.processResponseRawData=function(e,t,r){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];return e.then(function(e){return t(e)?r.apply(void 0,Object(p.__spreadArrays)([e],n)):e})},e.useStalePropName="useStale",e.parentKeyOverride="parentKeyOverride",e.onlyIndexedDB="onlyIndexedDB",e.onlyMySiteCache="onlyMySiteCache",e}(),g=new c.KillSwitch("0306551a-b040-4e46-ae3d-98f35375764b"),_=function(){function e(e){var t=this;this._isServiceAvailable=void 0,this._hasPrefetchedToken=!1,this._requestUpdater=function(e){return t._fetchTokenIfExpired().then(function(){return{url:t._generateUrlVersionedPath(e.url),options:t._getRequestOptions(e.options)}})},this._isPrefetchTokenFlightEnabled&&(this._initializeFromPrefetchedToken=new Promise(function(e,r){var n=new u.Async;window._spHomeClientContextLoaded=function(){n.dispose();var i=new s._QosMonitor("SpHomeClientContextPrefetch");try{t._initializeWithPrefetchedToken(),t._hasPrefetchedToken?i.writeSuccess():i.writeUnexpectedFailure("NoPrefetchedToken")}catch(e){i.writeUnexpectedFailure("Unexpected",e),r(e)}e()},n.setTimeout(function(){return!t._hasPrefetchedToken&&r(new Error("Timeout"))},1e4)})),this._stopUsingSPHttpMSClient=a._SPKillSwitch.isActivated("14b96c7e-3dcc-42e8-8a42-f56091d1f9f3"),e.whenFinished(function(){t._spHttpClient=e.consume(i.SPHttpClient.serviceKey),t._stopUsingSPHttpMSClient||(t._spHttpMicroserviceClient=e.consume(h),t._spHttpMicroserviceClient.requestUpdater=t._requestUpdater),t._httpClient=e.consume(i.HttpClient.serviceKey),t._pageContext=e.consume(n.PageContext.serviceKey),t._isPrefetchTokenFlightEnabled&&t._initializeWithPrefetchedToken(),t._isUserSupportedBySubstrate=t._isSubtrateSupportedUser(e.consume(n.PageContext.serviceKey).user)})}return e.prototype.get=function(e,t,r,n){return n?this._get(e,t,r,n):this._get_deprecated(e,t,r)},e.prototype.post=function(e,t,r,n,i){return i?this._post(e,t,r,n,i):this._post_deprecated(e,t,r,n)},Object.defineProperty(e.prototype,"isServiceAvailable",{get:function(){var e=this;return void 0!==this._isServiceAvailable?Promise.resolve(this._isServiceAvailable):this._fetchTokenIfExpired().then(function(){return e._isServiceAvailable=!0,e._isServiceAvailable}).catch(function(t){return e._isServiceAvailable=!1,e._isServiceAvailable})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isUserSupportedBySubstrate",{get:function(){return this._isUserSupportedBySubstrate},enumerable:!0,configurable:!0}),e.prototype._get=function(e,t,r,n){var a=this;if(!this._stopUsingSPHttpMSClient&&this._spHttpMicroserviceClient){var o=this._generateVersionedPath(e,t);return this._spHttpMicroserviceClient.get(o,new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),this._getRequestOptions({},r),this._getCacheConfiguration(n,o))}return this._fetchTokenIfExpired().then(function(){return a._spHttpClient.get(a._generateUrl(e,t),new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),a._getRequestOptions({},r),n)})},e.prototype._get_deprecated=function(e,t,r){var n=this;return this._fetchTokenIfExpired().then(function(){return g.isActivated()?n._httpClient.get(n._generateUrl(e,t),i.HttpClient.configurations.v1,n._getRequestOptions({},r)):n._spHttpClient.get(n._generateUrl(e,t),new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),n._getRequestOptions({},r))})},e.prototype._post=function(e,t,r,n,a){var o=this;if(void 0===t&&(t=""),!this._stopUsingSPHttpMSClient&&this._spHttpMicroserviceClient){var s=this._generateVersionedPath(e,r);return this._spHttpMicroserviceClient.fetch(s,new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),this._getRequestOptions({body:t},n,"POST"),this._getCacheConfiguration(a,s))}return this._fetchTokenIfExpired().then(function(){return o._spHttpClient.fetch(o._generateUrl(e,r),new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),o._getRequestOptions({body:t},n,"POST"),a)})},e.prototype._post_deprecated=function(e,t,r,n){var a=this;return void 0===t&&(t=""),this._fetchTokenIfExpired().then(function(){return g.isActivated()?a._httpClient.post(a._generateUrl(e,r),i.HttpClient.configurations.v1,a._getRequestOptions({body:t},n)):a._spHttpClient.post(a._generateUrl(e,r),new i.SPHttpClientConfiguration(i.HttpClient.configurations.v1,{}),a._getRequestOptions({body:t},n))})},e.prototype._getCacheConfiguration=function(e,t){return e&&(e.extraProps||(e.extraProps=new Map),e.extraProps.set(f.parentKeyOverride,t)),e},e.prototype._generateUrl=function(t,r){return void 0===r&&(r=1),a.Text.format(e.MICROSERVICE_ENDPOINT,this._url,r,t)},e.prototype._generateUrlVersionedPath=function(t){return a.Text.format(e.MICROSERVICE_ENDPOINT_V,this._url,t)},e.prototype._generateVersionedPath=function(t,r){return void 0===r&&(r=1),a.Text.format(e.VERSIONED_PATH,r,t)},e.prototype._isTokenValid=function(){return this._tokenExpiry&&this._tokenExpiry>new Date},e.prototype._getTokenAndMicroserviceDetails=function(){var e,t=this,r=new s._QosMonitor("SPHomeHttpClient"),n=this._pageContext.web.absoluteUrl+"/_api/sphomeservice/context?$expand=Token,Payload";return this._spHttpClient.get(n,i.SPHttpClient.configurations.v1).then(function(t){if(e=t.correlationId?t.correlationId.toString():void 0,t.ok)return t.json();var n=new Error(t.statusText);throw r.writeUnexpectedFailure("FailedResponse",n,{correlationId:e,Status:t.status}),n}).then(function(e){if(!e.Token||!e.Token.access_token)throw t._isServiceAvailable=!1,new l;t._isServiceAvailable=!0,t._token=e.Token.access_token,t._tokenExpiry=new Date(1e3*Number(e.Token.expires_on)-15e3),t._payload=e.Payload,t._url=e.Urls[0],t._alreadyGettingTokenPromise=void 0,r.writeSuccess()}).catch(function(n){throw n instanceof l?r.writeExpectedFailure("NotAvailable",n,{correlationId:e}):r.writeUnexpectedFailure("SPHomeHttpClient",n,{correlationId:e}),t._alreadyGettingTokenPromise=void 0,n})},e.prototype._getRequestOptions=function(e,t,r){var n;return void 0===e&&(e={}),e.headers=e.headers||{},this._token&&(e.headers.Authorization="Bearer "+this._token),this._payload&&(e.headers["SPHome-ApiContext"]=this._payload),e.headers["Content-Type"]="application/json",e.headers["SPHome-ClientType"]="PagesWeb",(null===(n=this._pageContext)||void 0===n?void 0:n.legacyPageContext)&&(e.headers.FarmLabel=this._pageContext.legacyPageContext.farmLabel),r&&(e.headers["X-HTTP-Method"]=r,e.method=r),t&&t.forEach(function(t,r){e.headers[r]=t}),e},e.prototype._initializeWithPrefetchedToken=function(){var e=new s._QosMonitor("InitializeSpHomeClientContext");try{if(!this._hasPrefetchedToken)if(window._spHomeClientContext&&window._spHomeClientContext!==[]){var t=window._spHomeClientContext,r=t.Token;this._token=r&&r.AccessToken,this._payload=t.Payload,this._url=t.Urls&&t.Urls[0],this._tokenExpiry=r&&r.ExpiresOn&&new Date(1e3*Number(t.Token.ExpiresOn)-15e3),this._hasPrefetchedToken=!0,e.writeSuccess()}else window._spHomeClientContext===[]?e.writeUnexpectedFailure("SPHomeClientContextNotAvailable",new Error("EmptyTokenReturned")):e.writeExpectedFailure("SPHomeClientContextNotAvailable",new Error("TokenNotAvailable"))}catch(t){this._hasPrefetchedToken=!1,e.writeUnexpectedFailure("InitializeSPHomeClientContextFailed",t.message)}return this._hasPrefetchedToken},e.prototype._fetchTokenIfExpired=function(){if(this._isTokenValid())return Promise.resolve();if(!this._alreadyGettingTokenPromise)if(this._isPrefetchTokenFlightEnabled){var e=a.Guid.parse("928806ac-3e49-4e4e-9114-7c392215230f"),t=a.Guid.parse("5ff931f9-8682-4614-b4f1-9b8d1aa74942"),r=[{raceablePromise:this._initializeFromPrefetchedToken,raceId:e},{raceablePromise:this._getTokenAndMicroserviceDetails(),raceId:t}];this._alreadyGettingTokenPromise=c.SmartRace.race(r).then(function(e){return e.raceablePromise}).catch(function(e){throw e})}else this._alreadyGettingTokenPromise=this._getTokenAndMicroserviceDetails();return this._alreadyGettingTokenPromise},Object.defineProperty(e.prototype,"_isPrefetchTokenFlightEnabled",{get:function(){return a._SPFlight.isEnabled(1265)},enumerable:!0,configurable:!0}),e.prototype._isSubtrateSupportedUser=function(e){if(e){var t=e.isAnonymousGuestUser,r=e.isExternalGuestUser;return!t&&!r}return!0},e.serviceKey=a.ServiceKey.create("sp-component-utilities:SPHomeHttpClient",e),e.MICROSERVICE_ENDPOINT="{0}/api/v{1}/{2}",e.MICROSERVICE_ENDPOINT_V="{0}/api/{1}",e.VERSIONED_PATH="v{0}/{1}",e}(),m=function(){function e(e,t){var r=this;this._qosComponentName=e,t.whenFinished(function(){r._spHomeHttpClient=t.consume(_.serviceKey)})}return e.prototype.addBookmark=function(e){var t=new s._QosMonitor(this._qosComponentName+".AddBookmark"),r=e;return this._spHomeHttpClient.post("documents/followed/add",JSON.stringify(r)).then(function(e){return e.ok}).then(function(e){return t.writeSuccess(),e}).catch(function(e){return t.writeUnexpectedFailure("AddBookmark"),!1})},e.prototype.removeBookmark=function(e){var t=new s._QosMonitor(this._qosComponentName+".RemoveBookmark"),r=decodeURI(e);return this._spHomeHttpClient.post("documents/followed/remove",JSON.stringify(r)).then(function(e){return e.ok}).then(function(e){return t.writeSuccess(),e}).catch(function(e){return t.writeUnexpectedFailure("RemoveBookmark"),!1})},e.prototype.isBookmarked=function(e){var t=new s._QosMonitor(this._qosComponentName+".IsBookmarked");return this._spHomeHttpClient.isUserSupportedBySubstrate?this._isBookmarkedRequest(e).then(function(e){return t.writeSuccess(),e.json()}).then(function(e){return e.SavedForLater}).catch(function(e){return t.writeUnexpectedFailure("IsBookmarked"),!1}):(t.writeExpectedFailure("SubstrateUnsupportedUser"),Promise.resolve(!1))},e.prototype._isBookmarkedRequest=function(e){var t="document/metadata?siteId="+e.siteId+"&webId="+e.webId+"&listId="+e.listId+"&uniqueId="+e.listItemUniqueId+"&url="+e.url+(e.groupId?"&groupId="+e.groupId:"");return this._spHomeHttpClient.get(t)},e}(),v=r("8dK2"),y=r("y88i"),S=r("MNck"),w={CurrentSite:1,Hub:2,ChooseSites:3,MyNews:4},P="newsDataSourceProp";function C(e){return e.audienceTargetingEnabled?"&filterByAudience=true":""}function b(e){var t=e.languageOverride;return t?"&languageOverride="+t:""}function T(e,t){var r="noFilter";e.serializedFilterQuery?r="filterCAMLQueryAdded":e.filterKQLQuery&&(r="filterKQLQueryAdded");var n={audienceTargetingEnabled:(!!e.audienceTargetingEnabled).toString(),isOnSeeAllPage:U.isOnSeeAllPage.toString(),isAdvanceMode:(!!e.languageOverride).toString(),alias:r};return t&&t.legacyPageContext&&t.legacyPageContext.isHubSite&&(n.service="HubSite"),n}var I=r("hE4m"),D=function(){function e(){}return e.getIconUrl=function(t){if(t===e._modernizedImageKey&&!e._assetIconsMap[this._modernizedImageKey]){var n=r("oxet");e._assetIconsMap[this._modernizedImageKey]=[n,n]}var i=e._assetIconsMap[t];return i[window.devicePixelRatio>=2&&i.length>=2?1:0]},e._assetIconsMap={HelpImg1:[r("fMQH"),r("H4oF")],HelpImg2:[r("lMGj"),r("3Rlg")],HelpImg3:[r("AzJr"),r("hfyH")]},e._modernizedImageKey="HelpImgModern",e}(),E={None:0,TeamSite:1,CommSite:2,Carousel:3};function x(e,t,r){if(e&&t&&r.legacyPageContext&&r.legacyPageContext.organizationNewsSiteReference){var n=a.Guid.tryParse(e),i=a.Guid.tryParse(t);if(n&&i){var o;r.legacyPageContext.organizationNewsSiteReference&&(o=r.legacyPageContext.organizationNewsSiteReference);for(var s=0,u=o;s<u.length;s++){var c=u[s];if(R(n,i,c))return c}}}}function R(e,t,r){var n=a.Guid.tryParse(r.SiteId),i=a.Guid.tryParse(r.WebId);return n&&i&&e.equals(n)&&t.equals(i)}var U=function(){function e(){}return e.cacheViewCountsValue=function(t,r,n){var i=e.viewCountsDictionary[t+"/"+r];(void 0===i||i<n)&&(e.viewCountsDictionary[t+"/"+r]=n)},e._internalGetTeamSiteHelpItems=function(t,r){var i=void 0!==t&&t<=3?t:3,a=[],o=!1;r&&r.whenFinished(function(){var e=r.consume(n.PageContext.serviceKey);o=e.legacyPageContext.IsHomepageModernized});for(var s=[{description:o?I.w:I.m,title:o?I.x:I.n,url:o?e._mdrnHelpUrl:I.o},{description:I.p,title:I.q,url:I.r},{description:I.s,title:I.t,url:I.u}],u=0;u<i;u++){var c="f7752afa-9c69-49c8-bc62-5b5b35d01775",l=o&&0===u?"Modern":""+(u+1);a.push({author:I.v,authorInitial:"SP",authorAccountName:"",description:s[u].description,image:D.getIconUrl("HelpImg"+l),publishedOn:new Date,publishedOnRelativeTime:"",title:s[u].title,url:s[u].url,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:c,siteId:c,webId:c})}return a},e.isValidNewsSource=function(e){return e===w.CurrentSite||e===w.Hub||e===w.ChooseSites||e===w.MyNews},e.getEmptyStateItems=function(t,r,n,i){switch(t){case E.CommSite:return e.getCommSiteHelpArticles(n);case E.TeamSite:return e._internalGetTeamSiteHelpItems(n,r);case E.Carousel:return e.getEmptyCarouselItems(n,i);default:return[]}},e.getCommSiteHelpArticles=function(e){for(var t=void 0!==e&&e<=3?e:3,r=[],n=0;n<t;n++){var i=a.Guid.newGuid().toString();r.push({author:I.i,authorAccountName:"",description:I.j,image:"",publishedOn:void 0,publishedOnRelativeTime:I.l,title:I.k,url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:i,siteId:i,webId:i})}return r},e.getEmptyCarouselItems=function(e,t){for(var r=void 0!==e&&e<=3?e:3,n=[],i=[I.f,I.g,I.h],o=0;o<r;o++){var s=a.Guid.newGuid().toString();n.push({author:"",authorAccountName:"",description:"",image:c.DefaultImageHelper.getDefaultNewsCarouselImageById(o,t),publishedOn:void 0,publishedOnRelativeTime:"",title:i[o],url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:s,siteId:s,webId:s})}return n},Object.defineProperty(e,"autofillItem",{get:function(){var e=a.Guid.newGuid().toString();return{author:"",authorAccountName:"",description:"",image:"",publishedOn:void 0,publishedOnRelativeTime:I.l,title:I.a,url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:e,siteId:e,webId:e}},enumerable:!0,configurable:!0}),e.getTipActionNewsItem=function(e,t){var r=a.Guid.newGuid().toString();return{author:"",authorAccountName:"",description:e?I.b:I.d,image:"",isContributorActionCard:e,publishedOn:void 0,publishedOnRelativeTime:"",title:e?I.c:I.e,url:e?y.Uri.concatenate(t,"/_layouts/15/CreateSitePage.aspx?source=")+y.UriEncoding.encodeURIComponent(window.location.pathname)+"&promotedState=1":I.o,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:r,siteId:r,webId:r}},e.extractNewsItemsFromSearch=function(t,r){return t.map(function(t){var n=t.SiteID?a.Guid.parse(t.SiteID).toString():void 0,i=t.WebId?a.Guid.parse(t.WebId).toString():void 0,o=t.ListId?a.Guid.parse(t.ListId).toString():void 0,s=t.UniqueID?a.Guid.parse(t.UniqueID).toString():void 0,u=t.ViewCountLifetime,c="number"==typeof u?u:void 0,l=x(n,i,r),p=t.SPWebUrl,d=e._handleDefaultBanner(t.PictureThumbnailURL);return{author:e._getUserDisplayNameFromSearch(t.CreatedBy),authorAccountName:t.AuthorOWSUSER,description:t.Description||"",isAuthoritative:!!l,image:d||"",publishedOn:new Date(t.FirstPublishedDate),publishedOnRelativeTime:"",title:t.Title||t.FileName,url:e.encodeSegments(t.Path),listItemId:t.ListItemId,originalSourceItemId:void 0,originalSourceUrl:e.encodeSegments(t.OriginalPath),path:t.Path,siteTitle:e._getSiteTitle(t,n,i,r),siteUrl:p,viewCounts:c,isHelpArticle:!1,uniqueId:s,siteId:n,webId:i,listId:o}})},e.extractNewsItems=function(t,r){return t.map(function(t){var n,i=function(e){return a.Guid.parse(e).toString()},o=t.SiteID?i(t.SiteID):r.site.id.toString(),s=t.WebId?i(t.WebId):r.web.id.toString(),u=t.ListId?i(t.ListId):r.list&&r.list.id&&r.list.id.toString(),c=t.UniqueId?i(t.UniqueId):r.listItem&&r.listItem.id&&r.listItem.id.toString(),l=x(o,s,r),p=t.BannerImageUrl,d=t.BannerThumbnailUrl;return n=a._SPFlight.isEnabled(1047)&&p&&p.toUpperCase().indexOf("/_LAYOUTS/IMAGES/")>-1?e._handleDefaultBanner(p):e._handleDefaultBanner(d||p),{author:t.CreatedBy.Name,authorAccountName:t.CreatedBy.AccountName,description:t.Description?t.Description:"",isAuthoritative:!!l,image:n||"",publishedOn:new Date(t.FirstPublished),publishedOnRelativeTime:"",title:t.Title||t.FileName,url:e.encodeSegments(t.AbsoluteUrl),listItemId:t.Id,originalSourceItemId:t.OriginalSourceItemId,originalSourceUrl:e.encodeSegments(t.OriginalSourceUrl),path:t.Path&&t.Path.DecodedUrl,siteTitle:l?e._getSiteTitle(t,o,s,r):void 0,siteUrl:r.web.absoluteUrl,viewCounts:void 0,isHelpArticle:!1,uniqueId:c,siteId:o,webId:s,listId:u}})},e.extractMicroserviceNewsItems=function(t,r,n){return t.map(function(t){var i,o,s,u=t.Site&&t.Site.ItemReference,c=t.Library,l=a.Guid.tryParse(u&&u.SiteId);i=l&&l.toString()||n&&r.site.id.toString();var p=a.Guid.tryParse(u&&u.WebId);o=p&&p.toString()||n&&r.web.id.toString();var d=a.Guid.tryParse(c&&c.ListId);s=d&&d.toString();var h=t.UniqueId?a.Guid.parse(t.UniqueId).toString():void 0,f=x(i,o,r),g=t.Site&&t.Site.Url?t.Site.Url:t.SiteUrl||r.site.absoluteUrl,_=e._handleDefaultBanner(t.ImageUrl);return{author:t.Author&&t.Author.Title?t.Author.Title:"",authorAccountName:t.Author&&t.Author.AccountName?t.Author.AccountName:"",description:t.Description,isAuthoritative:t.IsAuthoritativeNews||!!f,image:_||"",publishedOn:new Date(t.FirstPublishedDate),publishedOnRelativeTime:"",title:t.Title,url:e.encodeSegments(t.Url),viewCounts:void 0,isHelpArticle:!1,siteTitle:e._getSiteTitle(t,i,o,r),siteUrl:g,listItemId:t.ListItemId,originalSourceItemId:t.OriginalSourceItemId,originalSourceUrl:e.encodeSegments(t.OriginalSourceUrl),path:t.Path&&t.Path.DecodedUrl,uniqueId:h,siteId:i,webId:o,listId:s}})},e.processBannerImageUrlPart=function(t,r,n,i,a,o,u){try{return e._processBannerImageUrlPartCore(t,r,n,i,a,o,u)}catch(e){var c={defaultUniqueId:r,imageWidth:i};return a&&(c.siteId=a),o&&(c.webId=a),new s._QosMonitor("News.processBannerImageUrlPart").writeExpectedFailure("UrlError",e,c),""}},e.getResourceFromPrivateCDNUrl=function(e){return v._ThumbnailUrlGenerator.getThumbnailProvider(e)===v._ThumbnailProviderType.PrivateCDN&&(e=(e="https:/"+new v._SPResourcePath(e).path).split("?")[0]),e},e.isPrefetchStale=function(e){return void 0!==this._initialUrl||(this._initialUrl=e,!1)},e.extractParamFromUrl=function(e,t){var r=new RegExp("[?&]"+e+"=([^?&]+)(&|$)");return r.test(t)?decodeURIComponent(r.exec(t)[1]):void 0},e.isNewsItemInList=function(t,r){return!(!t||!r)&&t.some(function(t,n){return t&&e.getNewsItemKey(t,""+n)===e.getNewsItemKey(r,""+n)})},e.getPaddingCount=function(e,t){var r=0;return e.emptyItemType&&(r=e.count-t,r=e.emptyItemsCount?Math.min(e.emptyItemsCount,r):r),r},e.hasSameSetOfPosts=function(e,t){if(!e||!t||e.length!==t.length)return!1;var r=!0;return e.every(function(e){return r=r&&t.some(function(t){return e.url===t.url})}),r},e.hasSameOrderOfPosts=function(e,t){if(!e||!t||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},e.removeQueryParam=function(e,t){if(e&&t){var r=new y.Uri(e);return r.removeQueryParameter(t),r.toString()}return e},e.didRenderedPropertiesChange=function(e,t){return e&&t&&(e.description!==t.description||e.image!==t.image||e.title!==t.title)},e.getNewsItemKey=function(e,t){return e.isHelpArticle?t:e.siteId+"-"+e.webId+"-"+e.listId+"-"+e.uniqueId},Object.defineProperty(e,"isOnSeeAllPage",{get:function(){var e=new y.Uri(window.location.href);return y.StringHelper.doesStringEndWith(e.getPath(!0).toLowerCase(),"/_layouts/15/news.aspx")},enumerable:!0,configurable:!0}),e.getFilterQueryBody=function(e){return void 0===e&&(e=""),JSON.stringify(e)},e.encodeSegments=function(e){if(!e)return e;var t="/"===e.substring(e.length-1)?"/":"",r=new v._SPResourcePath(e);if(!r.authority&&!r.domain)return e;var n=new RegExp(".+.aspx"),i=new RegExp("^(?:[^%]|%[0-9A-Fa-f]{2})+$"),a=r.segments.filter(function(e){return!!e}).map(function(e){try{if(n.test(e)){var t=n.exec(i.test(e)?decodeURIComponent(e):e)[0];return e.replace(n,encodeURIComponent(t))}return e}catch(t){return e}});return y.Uri.concatenate.apply(y.Uri,[r.authority].concat(a))+t+r.searchParamString},e._shouldDeprecateDocViz=function(){return v._ThumbnailUrlGenerator.isVROOMThumbnailEnabled()},e._getSiteTitle=function(e,t,r,n){var i=e.SiteTitle;if(!i){var o=a.Guid.tryParse(t),s=a.Guid.tryParse(r);o&&s&&o.equals(n.site.id)&&s.equals(n.web.id)&&(i=n.web.title)}return i},e._getUserDisplayNameFromSearch=function(e){var t=e,r=e&&e.split("|");return r&&r.length>1&&(t=r[1]),t||""},e._handleDefaultBanner=function(t){return e._isDefaultBannerImage(t)?"":t},e._extractImageFromBanner=function(e){var t=e.split(", ");return t[t.length>1?1:0].trim()},e._isDefaultBannerImage=function(t){return!t||y.StringHelper.doesStringEndWith(e._extractImageFromBanner(t),"/images/sitepagethumbnail.png")},e._processBannerImageUrlPartCore=function(t,r,n,i,a,o,u){var l=e._extractImageFromBanner(t),p=u||n.web.absoluteUrl,d=e._tryGetExternalBanner(n,l,"newsProcessBannerImageUrl:");if(d)return d;if(e._isDefaultBannerImage(l))return"";var h=v._ThumbnailUrlGenerator.getThumbnailProvider(l);h!==v._ThumbnailProviderType.PrivateCDN||Object(S.isAlterantiveUrlFresh)(l)||(l=(l="https:/"+new v._SPResourcePath(l).path).split("?")[0],h=v._ThumbnailProviderType.Original);var f=new v._SPResourcePath(l),g=f.path.toLowerCase();if(h===v._ThumbnailProviderType.Stock)return l;if(h===v._ThumbnailProviderType.VROOMMeTACache||h===v._ThumbnailProviderType.PrivateCDN||h===v._ThumbnailProviderType.PublicCDN||h===v._ThumbnailProviderType.MeTA)return v._ThumbnailUrlGenerator.updateThumbnailWidth(l,i);if(h===v._ThumbnailProviderType.DocViz){if(s._TraceLogger.logVerbose(e._logSource,"newsProcessBannerImageUrl: already from GetPreview"),e._shouldDeprecateDocViz()){var _=v._ThumbnailUrlGenerator.fromGetPreview(l,"newsProcessBannerImageUrl",i);if(_)return _}var m=v._PreviewUtility.normalizeWidthToResolution(i),w=new y.Uri(l);return w.setQueryParameter(v._PreviewHelper.RESOLUTION,m.toString()),w.toString()}var P=h!==v._ThumbnailProviderType.SharePointHost&&h!==v._ThumbnailProviderType.MySite;if(h!==v._ThumbnailProviderType.Unknown&&P)return v._ThumbnailUrlGenerator.updateThumbnailWidth(l,i);var C={absoluteUrl:f.authority||p,fileType:v._PreviewUtility.getFileExtension(f),spResource:g,width:i,callerId:"newsProcessBannerImageUrl"},b=c.DefaultImageHelper.getDefaultImage(f,C.width);return v._ThumbnailUrlGenerator.getThumbnailUrl(C,b)},e._tryGetExternalBanner=function(t,r,n){var i=new v._SPResourcePath(r),a="";if(i&&(a=i.authority),a&&!c.UrlUtility.isInternalResource(r,t))return s._TraceLogger.logVerbose(e._logSource,n+" external host"),r},e.aliasPrefix="FirstParty_NewsWebPart_",e.viewCountsDictionary={},e._logSource=s._LogSource.create("NewsUtilities"),e._mdrnHelpUrl=" https://go.microsoft.com/fwlink/?linkid=2103711",e}(),F="news",N="viewCounts",A="currentViewCounts",O="hubNews",L="newsDigest",q="multiSiteNews",M="myNews",k="staleViewCounts",j=r("2q6Q");function H(e,t){return(a._BrowserDetection.getBrowserInformation().browser===a._Browser.IE||t)&&!!e}function V(e,t){return t?B(e)?"ThrottledResponse":"ResponseNotOk":"AzureFrontDoorHeadersMissing"}function B(e){return 429===e||503===e}var G=function(){function e(e){var t=this;e.whenFinished(function(){t._sphomeHttpClient=e.consume(_.serviceKey)})}return e.prototype.getViewCounts=function(e){var t=this;if(0===e.length)return Promise.resolve([]);var r=new j._QosMonitor("ExchangeViewCountsFetch");if(!this._sphomeHttpClient.isUserSupportedBySubstrate)return r.writeExpectedFailure("SubstrateUnsupportedUser"),Promise.resolve([]);var n=this._requestForItem(e);return this._sphomeHttpClient.post("documents/metadata",JSON.stringify(n)).then(function(e){if(e.ok)return e.json();var t=function(e){var t={MSCV:e.headers.get("MS-CV"),responseStatus:e.status.toString()},r=H(t.MSCV,e.url);return t.errorCode=V(e.status,r),t}(e),n=t.errorCode,i=new Error(n);throw r.writeUnexpectedFailure(n,i,t),i}).then(function(n){return r.writeSuccess(),e.map(function(e){return t._addMicroserviceViewCount(e,n.Items)})}).catch(function(e){return r.hasEnded||r.writeUnexpectedFailure("ExchangeViewCountsFetchSearchFallback",e),[]})},e.prototype._addMicroserviceViewCount=function(e,t){var r=this,n=t.filter(function(t){return r._guidEquals(t.Site.ItemReference.SiteId,e.siteId)&&r._guidEquals(t.Site.ItemReference.WebId,e.webId)&&r._guidEquals(t.UniqueId,e.uniqueId)})[0];return n&&void 0!==n.Views&&(e.viewCount=n.Views),e},e.prototype._guidEquals=function(e,t){var r=a.Guid.tryParse(e),n=a.Guid.tryParse(t);return r&&n&&r.equals(n)},e.prototype._requestForItem=function(e){return[].concat.apply([],e.map(function(e){return[{Site:{ItemReference:{SiteId:e.siteId,WebId:e.webId,Type:"SiteReference"},Type:"Site"},Library:{ListId:e.listId,Type:"Library"},UniqueId:e.uniqueId,Type:"Document"},{Site:{ItemReference:{SiteId:e.siteId,WebId:e.webId,Type:"GroupReference"},Type:"Site"},Library:{ListId:e.listId,Type:"Library"},UniqueId:e.uniqueId,Type:"Document"}]}))},e.serviceKey=a.ServiceKey.create("sp-dataproviders:ViewCountDataProvider",e),e}(),Q=r("Pk8u"),K=function(){function e(e){var t=this;this.id="ExchangeViewCounts",this.title="",this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(n.PageContext.serviceKey),t._viewCountDataSource=t.options.serviceScope.consume(G.serviceKey)})}return e._getViewCountFromCacheIfAvailable=function(e){this._viewCountCache.hasOwnProperty(e.uniqueId)&&(e.viewCounts=this._viewCountCache[e.uniqueId])},e._cacheViewCounts=function(e){var t=this;e.forEach(function(e){void 0!==e.uniqueId&&(t._viewCountCache[e.uniqueId]=e.viewCounts)})},e.prototype.requestData=function(e){var t=Object(Q.chunk)(e,10);return Promise.all(t.map(this._createRequestForItems.bind(this))).then(function(){return e})},e.prototype._addViewCountsToItems=function(e,t){return e.filter(this._needsViewCount).map(function(e){var r=t.filter(function(t){return t.uniqueId===e.uniqueId||t.siteId===e.siteId&&t.webId===e.webId&&t.listItemId===Number(e.listItemId)})[0];return e.viewCounts=void 0!==r?Number(r.viewCount):void 0,e})},e.prototype._createRequestForItems=function(t){var r=this;return this._viewCountDataSource.getViewCounts(this._buildRequest(t)).then(function(n){return t=r._addViewCountsToItems(t,n),e._cacheViewCounts(t),t})},e.prototype._buildRequest=function(e){var t=this._pageContext.site.id.toString(),r=this._pageContext.web.id.toString();return e.filter(this._needsViewCount).map(function(e){return{listItemId:Number(e.listItemId)||0,uniqueId:e.uniqueId,siteId:e.siteId||t,webId:e.webId||r,listId:e.listId}})},e.prototype._needsViewCount=function(t){e._getViewCountFromCacheIfAvailable(t);var r=t.viewCounts;return null==r||"number"!=typeof r},e._viewCountCache={},e}(),W=function(){function e(){}return e.isTieredCachingEnabled=function(){var e=this._isMySiteCacheEnabled(),t=this._isIndexedDBEnabled();return a._SPFlight.isEnabled(1703)&&(e||t)},e.isCacheAndNetworkEnabled=function(){return this._isMySiteCacheEnabled()},e._isIndexedDBEnabled=function(){return a._SPFlight.isEnabled(1693)||1===j._SPPerfExperiment.getVariantAndTrackExperiment(j._PerformanceExperiment.WEXUseIndexedDBTieredCachingExp)},e._isMySiteCacheEnabled=function(){return a._SPFlight.isEnabled(1705)||1===j._SPPerfExperiment.getVariantAndTrackExperiment(j._PerformanceExperiment.WEXMySiteCacheTieredCachingExp)},e}();function z(){return a._SPFlight.isEnabled(60013)}function J(){return a._SPFlight.isEnabled(1761)}var Z=function(){function e(e){var t=this;this._maxRetryCount=3,this._processRawData=function(e,r,n){var i=U.getPaddingCount(r,e.Items?e.Items.length:0),a=!e.Items||0===e.Items.length;t._logEmptyResultToQos(t._extraData,a,e);var o=a?[]:t.extractMicroserviceNewsItems(e.Items);return o=o.concat(U.getEmptyStateItems(r.emptyItemType,t.options.serviceScope,i,r.webpartWidth)),n.writeSuccess(t._extraData),o},this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(n.PageContext.serviceKey),t._sphomeHttpClient=t.options.serviceScope.consume(_.serviceKey)})}return Object.defineProperty(e.prototype,"isMicroserviceUnavailable",{get:function(){return this._sphomeHttpClient.isServiceAvailable},enumerable:!0,configurable:!0}),e.prototype.requestData=function(t){var r=this,n=0,i=e._requestCount++;return this._addPageUsageStartData(i),W.isTieredCachingEnabled()?this._requestData(t,n).then(function(e){return r._addPageUsageEndData(i,n),e}).catch(function(e){if(++n<r._maxRetryCount&&r.shouldRetryDataFetch(e))return r._requestData(t,n).then(function(e){return r._addPageUsageEndData(i,n),e});throw r._addPageUsageEndData(i,n,!0),e}):this._requestDataWithRetry(t,n).then(function(e){return r._addPageUsageEndData(i,n),e}).catch(function(e){if(++n<r._maxRetryCount&&r.shouldRetryDataFetch(e))return r._requestDataWithRetry(t,n).then(function(e){return r._addPageUsageEndData(i,n),e});throw r._addPageUsageEndData(i,n,!0),e})},e.prototype.extractMicroserviceNewsItems=function(e){return U.extractMicroserviceNewsItems(e,this._pageContext)},e.prototype.shouldRetryDataFetch=function(e){return"UnexpectedRetryableError"===e.message},e.prototype._applyCacheAndNetwork=function(e,t,r){var n=new s._QosMonitor(this.qosMonitorLabel+".getNewsItemsInSmartRace"),i=this._processHttpClientResponsePromise(e.serverResponse,t,n),o=new s._QosMonitor(this.qosMonitorLabel+".getCachedNewsItemsInSmartRace"),u=f.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData.bind(this),t,o).catch(function(e){throw o.writeUnexpectedFailure("ParseCacheResultsFailed",e),e}),l=a.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),p=a.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),d=[{raceablePromise:u,raceId:l},{raceablePromise:i,raceId:p}];return c.SmartRace.race(d).then(function(e){return e.raceId===l&&i.then(function(e){t.onServerResponseResolved(e)}).catch(function(){}),r.writeSuccess({cacheStatus:e.raceId===l?"WonRace":"LostRace"}),e.raceablePromise}).catch(function(e){throw r.writeUnexpectedFailure("SmartRaceFailed",e),e})},e.prototype._addPageUsageStartData=function(e){var t=j._PageUsageAdapter.getInstance(),r=t.elapsedTime();t.markFeature("MicroServiceNews-"+this.qosMonitorLabel+"-StartTime-"+e,r.toFixed(2))},e.prototype._addPageUsageEndData=function(e,t,r){var n=j._PageUsageAdapter.getInstance(),i=n.elapsedTime();n.markFeature("MicroServiceNews-"+this.qosMonitorLabel+"-EndTime-"+e+"-"+t,i.toFixed(2)),r&&n.markFeature("MicroServiceNews-"+this.qosMonitorLabel+"-"+e+"-"+t+"-Failure")},e.prototype._addMoreAdditionalFields=function(e){this._extraData.spHomeServer=e.headers.get("sphome-server");var t=e.headers.get("sphome-sharepointid");t&&(this._extraData.spHomeSharepointId=t)},e.prototype._addCacheAndServerEmptyStateLogs=function(e,t,r){var n=this,i=t&&r,a=i?"Cache":"";return e.then(function(e){var r=n._isEmptyResponse(e);if(r||i){var o=r?"Server":"";n._writeToEmptyResultsMonitor(t,""+a+o+"EmptyResponse")}return e}).catch(function(e){throw n._writeToEmptyResultsMonitor(t,a+"Server_Response_Parse_Error",e),e})},e.prototype._getIsExpectedError=function(e){return e>=400&&e<500&&!B(e)},e.prototype._getIsUnExpectedRetryableError=function(e){return e>=500&&e<600&&!B(e)},e.prototype._isEmptyResponse=function(e){var t=e&&e.filter(function(e){var t;return!(null===(t=e)||void 0===t?void 0:t.isHelpArticle)});return!t||0===t.length},e.prototype._isRawData=function(e){return e&&void 0!==e.Items},e.prototype._logEmptyResultToQos=function(e,t,r){var n=new s._QosMonitor(this.qosMonitorLabel+".getNewsItems.EmptyResults");t?n.writeUnexpectedFailure("EmptyResponse",new Error("200 "+(r.Items?"0 Items":"No Items")),e):n.writeSuccess(e)},e.prototype._logThrottledResultToQos=function(e,t){if(B(t)){var r=new s._QosMonitor("GetNewsItems.ThrottledResult");e.dataProvider=this.qosMonitorLabel,r.writeSuccess(e)}},e.prototype._parseClientCachableResponse=function(e,t,r){var n=this,i=e.cachedResponse&&f.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData,t,r),a=e.serverResponse?this._processHttpClientResponsePromise(e.serverResponse,t,r):void 0;return i?(i.then(function(e){var r=n._isEmptyResponse(e);if(a)n._addCacheAndServerEmptyStateLogs(a,!0,r).then(function(e){t.onServerResponseResolved(e)}).catch(function(){});else{var i=r?"Cache":"";r&&n._writeToEmptyResultsMonitor(!0,i+"EmptyResponse")}}).catch(function(){}),i):(r.writeSuccess(this._extraData),this._addCacheAndServerEmptyStateLogs(a,!1,!0))},e.prototype._parseHttpClientResponse=function(e,t,r){var n=this,i=T(t);i.responseStatus=e.status.toString();var a=H(i.MSCV,i.URL),o=V(e.status,a);return e.ok?e.json().then(function(e){var a=n._processRawData(e,t,r);return r.writeSuccess(i),a}).catch(function(e){throw r.writeUnexpectedFailure(o,e,i),e}):(r.writeUnexpectedFailure(o,new Error("UnexpectedError"),i),Promise.reject())},e.prototype._processHttpClientResponsePromise=function(e,t,r){var n,i=this;return e.then(function(e){return n=e,e.json()}).then(function(e){return i._processMicroserviceServiceResponse(e,t,r,n)})},e.prototype._processMicroserviceServiceResponse=function(e,t,r,n){this._extraData.URL=U.removeQueryParam(n.url,"mainSiteUrl"),this._extraData.MSCV=n.headers.get("MS-CV"),this._addMoreAdditionalFields(n);var i=H(this._extraData.MSCV,this._extraData.URL);if(n.ok&&i)return this._processRawData(e,t,r);var a=n.status,o=V(a,i);this._extraData.statusCode=a.toString(),this._extraData.responseStatus=n.statusText;var s=void 0,u=e;throw this._getIsExpectedError(a)?(s=new Error("ExpectedError"),this._extraData.id=u.ErrorLabel,r.writeExpectedFailure(o,s,this._extraData)):(this._getIsUnExpectedRetryableError(a)?s=new Error("UnexpectedRetryableError"):(s=new Error("UnexpectedError"),this._logThrottledResultToQos(this._extraData,a)),this._extraData.id=u.ErrorLabel,r.writeUnexpectedFailure(o,s,this._extraData)),s},e.prototype._requestData=function(e,t){var r=this,n=new s._QosMonitor(this.qosMonitorLabel+".getNewsItems");return this._extraData=T(e,this._pageContext),this._extraData.retryCount=t,this.executeRequest(e).then(function(t){if(t instanceof i.HttpClientResponse)return r._parseHttpClientResponse(t,e,n);if(W.isCacheAndNetworkEnabled()){var a=t;if(a.serverResponse&&a.cachedResponse)return r._applyCacheAndNetwork(a,e,n)}var o=t;return r._parseClientCachableResponse(o,e,n)}).catch(function(e){if(!n.hasEnded&&0===r._extraData.retryCount)if(e instanceof l)n.writeUnexpectedFailure("TokenNotAvailable",e,r._extraData);else{var t=e.message;e=new Error("UnexpectedError"),n.writeUnexpectedFailure(t,e,r._extraData)}throw e})},e.prototype._requestDataWithRetry=function(e,t){var r,n,i=this,a=new s._QosMonitor(this.qosMonitorLabel+".getNewsItems"),o=!1;return this._extraData=T(e,this._pageContext),this._extraData.retryCount=t,this.executeRequest_deprecated(e).then(function(e){return r=e,i._extraData.URL=U.removeQueryParam(e.url,"mainSiteUrl"),i._extraData.MSCV=e.headers.get("MS-CV"),i._addMoreAdditionalFields(e),n=H(i._extraData.MSCV,i._extraData.URL),o=e.ok&&!!n,e.json()}).then(function(t){if(o)return i._processRawData(t,e,a);var s=r.status,u=V(s,n);i._extraData.statusCode=s.toString(),i._extraData.responseStatus=r.statusText;var c=void 0,l=t;throw i._getIsExpectedError(s)?(c=new Error("ExpectedError"),i._extraData.id=l.ErrorLabel,a.writeExpectedFailure(u,c,i._extraData)):(i._getIsUnExpectedRetryableError(s)?c=new Error("UnexpectedRetryableError"):(c=new Error("UnexpectedError"),i._logThrottledResultToQos(i._extraData,s)),i._extraData.id=l.ErrorLabel,a.writeUnexpectedFailure(u,c,i._extraData)),c}).catch(function(e){if(!a.hasEnded&&0===i._extraData.retryCount)if(e instanceof l)a.writeUnexpectedFailure("TokenNotAvailable",e,i._extraData);else{var t=e.message;e=new Error("UnexpectedError"),a.writeUnexpectedFailure(t,e,i._extraData)}throw e})},e.prototype._writeToEmptyResultsMonitor=function(e,t,r){var n=new s._QosMonitor("GetNewsItems.ZeroResult");this._extraData.mySiteCacheHit=e,this._extraData.dataProvider=this.qosMonitorLabel,this._extraData.source=t,r?n.writeUnexpectedFailure(t,r,this._extraData):e&&"CacheServerEmptyResponse"===t?n.writeExpectedFailure(t,new Error("Expected Cache and Server Empty Result"),this._extraData):n.writeSuccess(this._extraData)},e._requestCount=0,e}(),Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="hubNews",t.title=I.y,t}return Object(p.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"HubNewsDataSource"},enumerable:!0,configurable:!0}),t.prototype.extractMicroserviceNewsItems=function(e){return U.extractMicroserviceNewsItems(e,this._pageContext,!0)},t.prototype.executeRequest_deprecated=function(e){return this._sphomeHttpClient.post(this.getMicroservicePath(e),U.getFilterQueryBody(e.filterKQLQuery))},t.prototype.executeRequest=function(e){var t=W.isCacheAndNetworkEnabled(),r={alias:U.aliasPrefix+this.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:t?i._CacheStrategy.CacheAndNetwork:i._CacheStrategy.CacheThenNetwork,extraProps:new Map([[f.useStalePropName,!0]])};return e.canCacheRequest||(r.cacheStrategy=i._CacheStrategy.NetworkOnly),this._sphomeHttpClient.post(this.getMicroservicePath(e),U.getFilterQueryBody(e.filterKQLQuery),void 0,void 0,r)},t.prototype.getMicroservicePath=function(e){var t="departmentId="+e.hubId+"&start="+e.skip+"&count="+e.count;return"news/hub/filtered?"+((t+=C(e))+b(e))},t}(Z),X=function(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e},$=function(){function e(e){var t=this;return this.id="News",this.title=I.B,this.options=e,this._isTieredCachingEnabled=W.isTieredCachingEnabled(),this.options.serviceScope.whenFinished(function(){t._spHttpClient=t.options.serviceScope.consume(i.SPHttpClient.serviceKey),t._pageContext=t.options.serviceScope.consume(n.PageContext.serviceKey),t._absoluteUrl=void 0===t._pageContext?void 0:t._pageContext.web.absoluteUrl}),y.Locale.language||(y.Locale.language="en-us"),this}return e.prototype.requestData=function(e){var t=this;return this._executeRequest(e).then(function(r){if(r instanceof i.SPHttpClientResponse)return t._parseSPHttpClientResponse(r,e);if(W.isCacheAndNetworkEnabled()){var n=r;if(n.serverResponse&&n.cachedResponse)return t._applyCacheAndNetwork(n,e)}return t._parseClientCachableResponse(r,e)})},e.prototype._applyCacheAndNetwork=function(e,t){var r=this,n=e.serverResponse.then(function(e){return r._parseSPHttpClientResponse(e,t,!0)}),i=f.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData.bind(this),t),o=a.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),s=a.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),u=[{raceablePromise:i,raceId:o},{raceablePromise:n,raceId:s}];return c.SmartRace.race(u).then(function(e){return e.raceId===o&&n.then(function(e){t.onServerResponseResolved(e)}).catch(function(){}),e.raceablePromise})},e.prototype._executeRequest=function(e){var t={metadataFilter:e.serializedFilterQuery,languageOverride:e.languageOverride},r={body:JSON.stringify(t),headers:new X("POST")};if(this._isTieredCachingEnabled){r.method="POST";var n=W.isCacheAndNetworkEnabled(),a={alias:U.aliasPrefix+this.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:n?i._CacheStrategy.CacheAndNetwork:i._CacheStrategy.CacheThenNetwork,extraProps:new Map([[f.useStalePropName,!0]])};return e.canCacheRequest||(a.cacheStrategy=i._CacheStrategy.NetworkOnly),this._spHttpClient.fetch(this._getNewsItemsUrl(e),i.SPHttpClient.configurations.v1,r,a)}return this._spHttpClient.post(this._getNewsItemsUrl(e),i.SPHttpClient.configurations.v1,r)},e.prototype._getNewsItemsUrl=function(e){return y.UriEncoding.escapeUrlForCallback(this._absoluteUrl)+"/_api/sitepages/pages/"+(e.audienceTargetingEnabled?"FeedTargeted":"feed")+"?promotedstate=2&published=true&$skip="+(e.skip?e.skip.toString():"0")+"&$top="+(e.count>0?e.count.toString():"")+"&$expand=CreatedBy&$select=Description,BannerImageUrl,BannerThumbnailUrl,AbsoluteUrl,FirstPublished,Title,FileName,Id,UniqueId,ListId,OriginalSourceItemId,OriginalSourceUrl,Path"},e.prototype._isRawData=function(e){return e&&e.value},e.prototype._parseClientCachableResponse=function(e,t){var r=this,n=e.serverResponse?e.serverResponse.then(function(e){return r._parseSPHttpClientResponse(e,t)}):void 0;return e.cachedResponse?(n&&n.then(function(e){t.onServerResponseResolved(e)}).catch(function(){}),f.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData.bind(this),t)):n},e.prototype._parseSPHttpClientResponse=function(e,t,r){var n=this,i=T(t),a=r?"NewsreelDataSource.getNewsItemsInSmartRace":"NewsreelDataSource.getNewsItems",o=new j._QosMonitor(a);if(i.correlationId=""+e.correlationId,i.responseStatus=""+e.status,i.message=e.statusMessage,e.ok)return e.json().then(function(e){var r=n._processRawData(e,t);return o.writeSuccess(i),r}).catch(function(e){throw o.writeUnexpectedFailure("Unexpected",e,i),e});var s=new Error(e.statusMessage);return o.writeUnexpectedFailure("Unexpected",s,i),Promise.reject(s)},e.prototype._processRawData=function(e,t){var r=U.getPaddingCount(t,e.value?e.value.length:0);return(e.value&&e.value.length>0?U.extractNewsItems(e.value,this._pageContext):[]).concat(U.getEmptyStateItems(t.emptyItemType,this.options.serviceScope,r,t.webpartWidth))},e}(),ee=function(){function e(e){this.id=L,this.title="NewsDigest",this.options=e}return e.prototype.requestData=function(e){var t=this.options.newsItems||[];return Promise.resolve(t)},e}(),te=function(){function e(e,t,r){return a.Validate.isNotNullOrUndefined(e,"pageContext"),this._pageContext=e,this._spHttpClient=t,this._newsDigestBubbleType=r,this._absoluteUrl=this._pageContext.web.absoluteUrl,this}return Object.defineProperty(e.prototype,"_newsDigestFirstExperienceBitRestApiUrl",{get:function(){return this._absoluteUrl+"/_api/SP.Directory.DirectorySession/GetGraphUser(principalName='"+y.UriEncoding.encodeURIComponent(this._pageContext.user.loginName)+"')"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_newsDigestFirstExperienceBitRestUrl",{get:function(){return this._newsDigestFirstExperienceBitRestApiUrl+"?$select="+this._newsDigestBubbleType},enumerable:!0,configurable:!0}),e.readCachedFirstRunExperience=function(e){var t=window.localStorage.getItem(e);if(t)return"true"===t},e.prototype.writeCachedFirstRunExperience=function(t){var r=this._newsDigestBubbleType,n=window.localStorage.getItem(r),i=String(t);if(n!==i)try{window.localStorage.setItem(r,i)}catch(t){s._TraceLogger.logError(e._logSource,t)}},e.prototype.showFirstRun=function(){var t=e.readCachedFirstRunExperience(this._newsDigestBubbleType);return!0===t?(s._TraceLogger.logVerbose(e._logSource,this._newsDigestBubbleType+" is true in the local storage"),Promise.resolve(!1)):!1===t?(s._TraceLogger.logVerbose(e._logSource,this._newsDigestBubbleType+" is false in the local storage"),Promise.resolve(!0)):this.getFirstRunBitApi()},e.prototype.setFirstRunSeen=function(t){var r=this,n=new j._QosMonitor("SetNewsDigestFirstRunExperienceAPI"),a={};a[this._newsDigestBubbleType]=Boolean(t);var o="application/json; odata=minimalmetadata",u=new Headers;return u.append("Accept","*/*, "+o),u.append("Content-Type",o),u.append("X-HTTP-Method","PATCH"),u.append("X-ClientType","NewsDigest_SetFirstRunBit"),this._spHttpClient.post(this._newsDigestFirstExperienceBitRestApiUrl,i.SPHttpClient.configurations.v1,{body:JSON.stringify(a),headers:u}).then(function(i){s._TraceLogger.logVerbose(e._logSource,"Set news digest first run bit to API: "+t),n.writeSuccess(),r.writeCachedFirstRunExperience(t)}).catch(function(t){throw s._TraceLogger.logError(e._logSource,t),n.writeUnexpectedFailure("SetNewsDigestFirstRunExperienceAPI",t),t})},e.prototype.getFirstRunBitApi=function(){var t=this,r=new j._QosMonitor("GetNewsDigestFirstRunExperienceAPI"),n=new Headers;return n.append("X-ClientType","NewsDigest_GetFirstRunBit"),this._spHttpClient.get(this._newsDigestFirstExperienceBitRestUrl,i.SPHttpClient.configurations.v1,{headers:n}).then(function(e){return e.json()}).then(function(n){var i=n[t._newsDigestBubbleType];return s._TraceLogger.logVerbose(e._logSource,"Get news digest first run bit from API, status: "+i),r.writeSuccess(),t.writeCachedFirstRunExperience(i),!i}).catch(function(t){return s._TraceLogger.logError(e._logSource,t),r.writeUnexpectedFailure("FailedToGetNewsDigestFirstExperienceError",t),!1})},e._logSource=s._LogSource.create("NewsDigestFirstRunDataProvider"),e}(),re=function(){function e(){}return e.ascending=0,e.descending=1,e}(),ne=function(){function e(e,t,r){void 0===t&&(t=!1),void 0===r&&(r=""),this._serviceScope=e,this._isMockMode=t,this._qosPrefix=r}return e.prototype.getSearchQueryResponse=function(e){var t=this,r=this._qosPrefix?new j._QosMonitor(this._qosPrefix+".SearchDataProviderGetResponse"):new j._QosMonitor("SearchDataProviderGetResponse");return this._isMockMode?(r.writeSuccess(),Promise.resolve(this.mockResponse)):this._getRawSearchQueryResponse(e).then(function(e){var n=t._simplifyResultForTemplating(e);return r.writeSuccess(),n}).catch(function(e){return r.writeUnexpectedFailure("FailedSearchPOST",e,{correlationId:e.correlationId}),Promise.reject(e)})},e.prototype.getManagedPropertiesQueryResponse=function(e){var t=new j._QosMonitor("ManagedPropertiesRequest");return this._isMockMode?(t.writeSuccess(),Promise.resolve([])):this._getRawSearchQueryResponse(e).then(function(e){var r=Object(Q.has)(e.PrimaryQueryResult,"RefinementResults.Refiners")?e.PrimaryQueryResult.RefinementResults.Refiners:[],n=(r.length>0?r[0].Entries:[]).map(function(e){return e.RefinementName});return t.writeSuccess(),Promise.resolve(n)}).catch(function(e){return t.writeUnexpectedFailure("ManagedPropertiesRequestFailed",e),Promise.reject(e)})},e.prototype._getRawSearchQueryResponse=function(e){var t=this;e.ClientType=e.ClientType||"ModernWebPart";var r='{ "request": '+(e?JSON.stringify(e):"{}")+" }",n=new Headers;return n.append("Accept","application/json;odata=nometadata"),n.append("Content-type","application/json;charset=utf-8"),n.append("OData-Version","3.0"),this._afterServiceScopeFinished().then(function(e){var a=e.pageContext,o=e.spHttpClient,s=a.web.absoluteUrl+"/_api/search/postquery";return o.post(s,i.SPHttpClient.configurations.v1,{body:r,headers:n}).then(t._parseResponse)})},e.prototype._simplifyResultForTemplating=function(e){var t={};try{for(var r=[],n=e.PrimaryQueryResult.RelevantResults.Table.Rows,i=0;i<n.length;i++){for(var a={},o=n[i].Cells,s=0;s<o.length;s++){var u=o[s];a[u.Key]=u.Value}r.push(a)}t.rows=r}catch(e){t.rows=[]}return t},e.prototype._afterServiceScopeFinished=function(){var e=this;return new Promise(function(t){e._serviceScope.whenFinished(function(){t({pageContext:e._serviceScope.consume(n.PageContext.serviceKey),spHttpClient:e._serviceScope.consume(i.SPHttpClient.serviceKey)})})})},e.prototype._parseResponse=function(t){return t.status>=200&&t.status<300?t.json():t.json().then(function(r){var n="BadSearchResponse: statusMessage="+t.statusMessage;throw s._TraceLogger.logVerbose(e._LogSource,n+", response inner error="+JSON.stringify(r)),{message:n,status:t.status,correlationId:t.correlationId?t.correlationId.toString():"",innerError:r}})},e._LogSource=s._LogSource.create("SearchAPIRequest"),e}(),ie={CurrentSite:1,CurrentSiteCollection:2,AllSites:3,CurrentSiteDocumentLibrary:4,AllSitesInTheHub:5,CurrentSitePageLibrary:6,CurrentSiteEventsList:7,SelectedSites:99},ae={Document:1,Page:2,Video:3,Event:4,Issue:5,Task:6,Link:7,Contact:8,Image:9,News:10,All:99},oe={Word:1,Excel:2,PowerPoint:3,OneNote:4,Visio:5,PDF:10,Any:99},se={Equals:1,NotEqual:2,BeginsWith:3,EndsWith:4,Contains:5,DoesNotContain:6,LessThan:7,GreaterThan:8,Between:9,GreaterThanOrEqualTo:10,LessThanOrEqualTo:11,IsNull:12},ue={Today:1,Yesterday:2,ThisWeek:3,ThisMonth:4,LastMonth:5,ThisYear:6,LastYear:7},ce={TitleContaining:1,AnyTextContaining:2,TaggedWith:3,CreatedBy:4,ModifiedBy:5,Field:6,RecentlyChanged:7,RecentlyAdded:8,PageAuthorByline:9},le=r("ui8f"),pe={MostRecent:1,MostViewed:2,Trending:3,FieldAscending:4,FieldDescending:5},de={CurrentUser:1,SpecificUser:2},he=function(){function e(){}return e.isValidMeToken=function(e){return new RegExp("^\\[me\\]$","i").test(e)},e.isValidTodayToken=function(e){return new RegExp("^\\[today\\]([\\+|\\-]\\d+$)?$","i").test(e)},e}(),fe="(ModernAudienceAadObjectIds:{User.Audiences} OR NOT IsAudienceTargeted:true)",ge=function(){function e(){}return e.generateKqlFromFilters=function(e){var t="",r=!1;if(!e||!e.query||!e.query.filters)return{expr:t,isFilteringByDate:r};for(var n=Object(Q.clone)(e.query.filters),i=n.length;i--;)void 0!==n[i].value&&""!==n[i].value||void 0!==n[i].userType&&n[i].userType!==de.SpecificUser||n.splice(i,1);n=n.sort(function(e,t){return e.filterType-t.filterType});for(var a=!1,o=0;o<n.length;o++){o>0&&(t+=" "+(a?"OR":"AND")+" ");var s=n[o],u=o<n.length-1?n[o+1]:{};a||void 0===u.value||s.filterType!==u.filterType||(t+="(",a=!0);var c=this._kqlFilter(s,e.queryableManagedProperties);t+=c.expr,r=r||c.isFilteringByDate,a&&s.filterType!==u.filterType&&(t+=")",a=!1)}return t.length>0&&(t+=" AND"),{expr:t,isFilteringByDate:r}},e.generateKqlFromFilterGroup=function(e){if(!e||!e.query||!e.query.filterGroup)return{expr:"",isFilteringByDate:!1};var t=this._buildFilterGroupExpr(e.query.filterGroup,e.queryableManagedProperties);return t.expr.length>0&&(t.expr+=" AND"),t},e.generateQuery=function(e,t){var r="";if(!e||!e.query)return{queryTemplate:r};var n=!1,i=!1;if(e.query.advancedQueryText)r=e.query.advancedQueryText;else if(e.query.filterGroup)r=(a=this.generateKqlFromFilterGroup(e)).expr,n=a.isFilteringByDate;else if(e.query.filters){var a;r=(a=this.generateKqlFromFilters(e)).expr,n=a.isFilteringByDate}r.length>0&&(i=!0),r+=" "+this.generateContentLocationKqlQuery(e),r+=this._generateContentKql(e,i);var o=void 0;return n&&(o=t.user.preferUserTimeZone?t.user.timeZoneInfo.id:t.web.timeZoneInfo.id),e.audienceTarget&&(r=r.trim()+" "+fe),{queryTemplate:r.trim(),timeZoneId:o}},e.generateContentLocationKqlQuery=function(e){var t=this;switch(e.query.contentLocation){case ie.AllSitesInTheHub:return""+this._siteCriteria(e.hubSiteId,"DepartmentId");case ie.CurrentSite:return this._generateSiteIdCriteria(e.siteId,e.webId);case ie.CurrentSiteCollection:return"("+this._siteCriteria(e.siteId,"NormSiteID")+")";case ie.SelectedSites:if(e.siteIds&&e.siteIds.length>0)return"("+e.siteIds.map(function(e){return t._generateSiteIdCriteria(e.siteId,e.webId)}).join(" OR ")+")"}return""},e.generateSearchAPIQueryOptions=function(e,t,r){var n=r.isPrivateGroup;!n&&r.query&&(n=r.query.contentLocation===ie.AllSites||r.query.contentLocation===ie.AllSitesInTheHub);var i=n?"True":"False",a=r.enableMultiGeoSearch?"True":"False",o={ClientType:r.clientType,QueryTemplate:e,TimeZoneId:t,SelectProperties:["ContentType","ContentTypeId","Title","EditorOwsUser","ModifiedBy","LastModifiedBy","FileExtension","FileType","Path","SiteName","SiteTitle","PictureThumbnailURL","DefaultEncodingURL","LastModifiedTime","ListID","ListItemID","SiteID","WebId","UniqueID"],Properties:[{Name:"TrimSelectProperties",Value:{StrVal:"1",QueryPropertyValueTypeIndex:1}},{Name:"EnableDynamicGroups",Value:{BoolVal:i,QueryPropertyValueTypeIndex:3}},{Name:"EnableMultiGeoSearch",Value:{BoolVal:a,QueryPropertyValueTypeIndex:3}}],SourceId:"8413CD39-2156-4E00-B54D-11EFD9ABDB89",TrimDuplicates:!1};if(e.indexOf("ContentTypeId:0x0106*")>-1&&o.SelectProperties.push("UserName","WorkEmail","OrgNames","JobTitle","WorkPhone","MobilePhone"),r.query&&r.query.filters){for(var s=r.query.filters,u=!1,c=!1,l=0;l<s.length;l++)switch(s[l].filterType){case ce.RecentlyAdded:u=!0;break;case ce.RecentlyChanged:c=!0}u&&o.SelectProperties.push("Created"),c&&o.SelectProperties.push("LastModifiedTime")}if(r.selectProperties){var p={};for(l=0;l<o.SelectProperties.length;l++)p[o.SelectProperties[l]]=!0;for(l=0;l<r.selectProperties.length;l++)this._addSelectField(o.SelectProperties,r.selectProperties[l],p)}if(r.maxItemsPerPage&&(o.RowLimit=r.maxItemsPerPage,o.RowsPerPage=r.maxItemsPerPage),r.startRow&&(o.StartRow=r.startRow),r.query)switch(r.query.sortType){case pe.MostRecent:o.SortList=[{Property:"LastModifiedTime",Direction:re.descending}];break;case pe.MostViewed:o.SortList=[{Property:"ViewsLifeTime",Direction:re.descending}];break;case pe.Trending:o.SortList=[{Property:"ViewsRecent",Direction:re.descending}];break;case pe.FieldAscending:case pe.FieldDescending:r.query.sortField&&(o.SortList=[{Property:r.query.sortField,Direction:r.query.sortType===pe.FieldAscending?re.ascending:re.descending}])}return o},e.generateSearchAPIQueryOptionsForManagedProperties=function(e){var t,r=e.query,n=r.managedPropertiesRefinerOptions,i=isNaN(n.limit)?5e4:n.limit,a=n.managedPropertyMatchText?"*"+n.managedPropertyMatchText+"*":"*",o=btoa(Object(Q.unescape)(encodeURIComponent(a)));switch(r.contentLocation){case ie.CurrentSite:t=e.webAbsoluteUrl;break;case ie.CurrentSiteCollection:t=e.siteAbsoluteUrl;break;case ie.AllSites:default:t=new URL(e.webAbsoluteUrl).origin}var s='path:"'+t+'" '+this._generateContentKql(e,!1);return{ClientType:e.clientType,SourceId:"8413CD39-2156-4E00-B54D-11EFD9ABDB89",Querytext:s,Refiners:"ManagedProperties(filter3i="+i+"/0/"+o+",sort=name/ascending)",EnableQueryRules:!1,ProcessBestBets:!1,ProcessPersonalFavorites:!1,Properties:[{Name:"EnableDynamicGroups",Value:{BoolVal:"False",QueryPropertyValueTypeIndex:3}},{Name:"ClientFunction",Value:{StrVal:"SchemaLookup",QueryPropertyValueTypeIndex:1}}]}},e._buildFilterGroupExpr=function(e,t){var r=this,n="",i=!1;return e.filters&&e.filters.forEach(function(a){if(void 0!==a.value&&""!==a.value||void 0!==a.userType&&a.userType!==de.SpecificUser){var o=r._kqlFilter(a,t);i=i||o.isFilteringByDate,n=r._chainKqlFilterExpr(n,o,e.logicalOperator)}}),e.filterGroups&&e.filterGroups.forEach(function(a){var o=r._buildFilterGroupExpr(a,t);i=i||o.isFilteringByDate,n=r._chainKqlFilterExpr(n,o,e.logicalOperator)}),n&&(n+=")"),{expr:n,isFilteringByDate:i}},e._chainKqlFilterExpr=function(e,t,r){var n=e;return t.expr&&(n?n+=" "+r+" ":n="(",n+=t.expr),n},e._generateContentKql=function(e,t){var r=e.query,n=e.languageCode,i="",o="(FileType="+c.spConstants.imageExtensions.join(" OR FileType=")+")",s=r.contentTypes||[ae.Document],u=!1;s.indexOf(ae.All)>-1&&(u=!0,r.contentLocation!==ie.AllSites||t||(i+="*"));var l=!1,d=!1;if(!u)for(var h="",f=0;f<s.length;++f)switch(1===f&&(h=" OR"),s[f]){case ae.Document:i=this._appendCriteriaUniquely(i,h,"IsDocument:1"),l||(i+=" AND NOT (FileType:aspx OR FileType:html OR FileType:htm OR FileType:mhtml)"),l=!0;break;case ae.Page:i=this._appendCriteriaUniquely(i,h,"(ContentTypeId:0x010108* OR ContentTypeId:0x01010901* OR ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* OR ContentTypeId:0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF39*)",n),d||(i+=" AND NOT (FileType:one OR FileType:onepkg OR FileType:ms-one-stub OR FileType:onetoc OR FileType:onetoc2)"),d=!0;break;case ae.News:i=this._appendCriteriaUniquely(i,h,"(ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* AND PromotedState=2)",n);break;case ae.Event:i=this._appendCriteriaUniquely(i,h,"ContentTypeId:0x0102*");break;case ae.Issue:i=this._appendCriteriaUniquely(i,h,"ContentTypeId:0x0103*");break;case ae.Task:i=this._appendCriteriaUniquely(i,h,"ContentTypeId:0x0108*");break;case ae.Link:i=this._appendCriteriaUniquely(i,h,"ContentTypeId:0x0105*");break;case ae.Contact:i=this._appendCriteriaUniquely(i,h,"ContentTypeId:0x0106*");break;case ae.Video:i=this._appendCriteriaUniquely(i,h,"ContentTypeId:0x010100F3754F12A9B6490D9622A01FE9D8F012*"),a._SPFlight.isEnabled(1538)&&(""===h&&(i+=" OR "),i=this._appendCriteriaUniquely(i,h,this._documentTypeCriteria(Object(p.__spreadArrays)(c.spConstants.videoExtensions))));break;case ae.Image:i=this._appendCriteriaUniquely(i,h,o)}if(n&&u&&(i+=" AND (SPTranslationLanguage:"+n+" OR (NOT SPTranslatedLanguages:"+n+" AND NOT SPIsTranslation:true))"),l||u){var g=r.documentTypes||[oe.Any];if(-1===g.indexOf(oe.Any))for(h="",f=0;f<g.length;++f)switch(1===f&&(h=" OR"),g[f]){case oe.Word:i=this._appendCriteriaUniquely(i,h,this._documentTypeCriteria(["doc","docm","docx"]));break;case oe.Excel:i=this._appendCriteriaUniquely(i,h,this._documentTypeCriteria(["xls","xlsb","xlsm","xlsx"]));break;case oe.PowerPoint:i=this._appendCriteriaUniquely(i,h,this._documentTypeCriteria(["pot","potx","ppt","pptm","pptx"]));break;case oe.OneNote:i=this._appendCriteriaUniquely(i,h,this._documentTypeCriteria(["one","onepkg","ms-one-stub","onetoc","onetoc2"]));break;case oe.Visio:i=this._appendCriteriaUniquely(i,h,this._documentTypeCriteria(["vsd","vsdm","vsdx","vdw"]));break;case oe.PDF:i=this._appendCriteriaUniquely(i,h,this._documentTypeCriteria(["pdf"]))}}return i&&" ("+i.trim()+")"},e._addSelectField=function(e,t,r){r[t]||(r[t]=!0,e.push(t))},e._generateSiteIdCriteria=function(e,t){return"("+this._siteCriteria(e,"NormSiteID")+" AND "+this._siteCriteria(t,"NormWebId")+")"},e._siteCriteria=function(e,t){return"DepartmentId"===t?"("+t+":"+e+" OR "+t+":{"+e+"})":t+":"+e},e._appendCriteriaUniquely=function(e,t,r,n){return-1===e.indexOf(r)&&(n&&(r+=" AND (SPTranslationLanguage:"+n+" OR (NOT SPTranslatedLanguages:"+n+" AND NOT SPIsTranslation:true))"),e+=t+" "+r),e},e._kqlFilter=function(e,t){var r=" ",n=!1;if(e&&(void 0!==e.value||void 0!==e.userType)){var i=void 0!==e.value?e.value.toString():"",a=void 0;switch(e.filterType){case ce.TitleContaining:r+=i?'title:"'+i+'"':"";break;case ce.AnyTextContaining:r+=i?'"'+i+'"':"";break;case ce.TaggedWith:r+=i?'tags:"'+i+'"':"";break;case ce.CreatedBy:e.userType===de.CurrentUser?r+="createdby:{User}":i&&(he.isValidMeToken(i)?r+="createdby:{User}":r+='createdby:"'+i+'"');break;case ce.ModifiedBy:e.userType===de.CurrentUser?r+="modifiedby:{User}":i&&(he.isValidMeToken(i)?r+="modifiedby:{User}":r+='modifiedby:"'+i+'"');break;case ce.RecentlyAdded:a="Created";break;case ce.RecentlyChanged:a="LastModifiedTime";break;case ce.Field:if(t){var o=this._managedPropertyFilter(e,t);r+=o.expr,n=o.isFilteringByDate}}if(a)switch(n=!0,this._filterSince(i)){case ue.Today:r+=a+"=today";break;case ue.Yesterday:r+="("+a+"=today OR "+a+"=yesterday)";break;case ue.ThisWeek:r+=a+'="this week"';break;case ue.ThisMonth:r+=a+'="this month"';break;case ue.LastMonth:r+="("+a+'="this month" OR '+a+'="last month")';break;case ue.ThisYear:r+=a+'="this year"';break;case ue.LastYear:r+="("+a+'="this year" OR '+a+'="last year")'}}return{expr:r.trim(),isFilteringByDate:n}},e._filterSince=function(e){try{return parseInt(e,10)}catch(e){return ue.ThisMonth}},e._documentTypeCriteria=function(e){return"(FileType:"+e.join(" OR FileType:")+")"},e._managedPropertyFilter=function(e,t){var r=e.fieldInfo||t[e.fieldname];r=r||le.a.Text;var n=this._parseManagedFieldValue(e.value,r),i="",a=r===le.a.DateTime;if(""===n.trim()&&e.op!==se.Equals&&e.op!==se.NotEqual&&e.op!==se.Between)return{expr:"",isFilteringByDate:!1};switch(e.op){case se.BeginsWith:var o=n.substr(1,n.length-2);i=e.fieldname+'="'+o+'*"';break;case se.Between:var s=this._parseManagedFieldValue(e.value2,r);""!==n.trim()&&""!==s.trim()?i=e.fieldname+">="+n+" AND "+e.fieldname+"<="+s:""!==n.trim()?i=e.fieldname+">="+n:""!==s.trim()&&(i=e.fieldname+"<="+s);break;case se.Contains:i=e.fieldname+":"+n;break;case se.DoesNotContain:i="-"+e.fieldname+":"+n;break;case se.Equals:i=e.fieldname+"="+n;break;case se.GreaterThan:i=e.fieldname+">"+n;break;case se.GreaterThanOrEqualTo:i=e.fieldname+">="+n;break;case se.LessThan:i=e.fieldname+"<"+n;break;case se.LessThanOrEqualTo:i=e.fieldname+"<="+n;break;case se.NotEqual:i="-"+e.fieldname+"="+n}return{expr:i,isFilteringByDate:a}},e._parseManagedFieldValue=function(e,t){var r="";switch(t){case le.a.DateTime:if("string"==typeof e&&he.isValidTodayToken(e)){var n=e.substr("[today]".length)||"";return n?"{Today"+n+"}":"{Today}"}var i=new Date(e.toString());"[object Date]"===Object.prototype.toString.call(i)&&(isNaN(i.getTime())||(r='"'+i.toISOString()+'"'));break;case le.a.Decimal:case le.a.Double:var a=parseFloat(e.toString());isNaN(a)||(r=a.toString());break;case le.a.Integer:var o=parseInt(e.toString(),10);isNaN(o)||(r=o.toString());break;case le.a.Text:r="string"==typeof e&&he.isValidMeToken(e)?"{User}":'"'+e.toString().trim()+'"';break;case le.a.YesNo:r=e?"true":"false"}return r},e}(),_e=r("9G/9"),me=function(){function e(e){var t=this;return this.id="Search",this.title=_e.a,this.options=e,this.options.serviceScope.whenFinished(function(){t._spHttpClient=t.options.serviceScope.consume(i.SPHttpClient.serviceKey),t._pageContext=t.options.serviceScope.consume(n.PageContext.serviceKey),t._initVariables()}),this._searchAPIRequest=new ne(e.serviceScope,!1,e.qosPrefix||""),y.Locale.language||(y.Locale.language="en-us"),this}return e.prototype.requestData=function(e){var t=null;if(Object(Q.has)(e.searchOptions,"query.managedPropertiesRefinerOptions"))return t=ge.generateSearchAPIQueryOptionsForManagedProperties(e.searchOptions),this._searchAPIRequest.getManagedPropertiesQueryResponse(t).catch(function(e){return Promise.reject(e)});if(e.returnCachedValues)return this._returnCachedResults();if(e.searchAPIQueryOptions)t=e.searchAPIQueryOptions;else if(e.searchOptions){var r=ge.generateQuery(e.searchOptions,this._pageContext);t=ge.generateSearchAPIQueryOptions(r.queryTemplate,r.timeZoneId,e.searchOptions)}return t?this._searchAPIRequest.getSearchQueryResponse(t).then(this._mapResponse).catch(function(e){return Promise.reject(e)}):Promise.resolve([])},e.prototype._initVariables=function(){},e.prototype._mapResponse=function(e){return Promise.resolve(e)},e.prototype._returnCachedResults=function(){return Promise.resolve([])},e}(),ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){var r=U.extractNewsItemsFromSearch(e.rows,t._pageContext);return Promise.resolve(r)},t}return Object(p.__extends)(t,e),t._requestNewsData=function(e){var r="ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* AND PromotedState:2",n=[];return e.uniqueIdGuids?(n.push(r+" AND ("),e.uniqueIdGuids.forEach(function(e,t){0===t?n.push("UniqueID:"+e.toString()):n.push(" OR UniqueID:"+e.toString()),n.push(" OR UniqueID:{"+e.toString()+"}")}),n.push(")")):n.push("{searchterms} "+r),t._request(e,n.join(""))},t._request=function(e,r){return new t({serviceScope:e.serviceScope}).requestData({searchOptions:{query:{contentLocation:e.contentLocation}},searchAPIQueryOptions:{Properties:[{Name:"EnableDynamicGroups",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}},{Name:"EnableMultiGeoSearch",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}}],Querytext:e.searchText||"",QueryTemplate:r,RowLimit:e.rowLimit,SelectProperties:["CreatedBy","AuthorOWSUSER","Description","PictureThumbnailURL","FirstPublishedDate","Title","FileName","ListItemId","OriginalPath","Path","SiteTitle","SPSiteURL","SPWebUrl","ViewCountLifetime","UniqueID","SiteID","WebId","ListId"],SortList:[{Property:"LastModifiedTime",Direction:re.descending}],StartRow:e.startRow,TrimDuplicates:!0}})},t}(me),ye=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="MultiSiteNews",t.title=I.z,t}return Object(p.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"MultiSiteNewsDataSource"},enumerable:!0,configurable:!0}),t.prototype.requestData=function(t){return 0===t.siteList.length?Promise.resolve(this._getNewsItemsWithPadding(t,0)):e.prototype.requestData.call(this,t)},t.prototype.extractMicroserviceNewsItems=function(e){return U.extractMicroserviceNewsItems(e,this._pageContext,!0)},t.prototype.executeRequest_deprecated=function(e){return this._sphomeHttpClient.post(this.getMicroservicePath(e),this._getSiteListAndFilterBody(e.siteList,e.filterKQLQuery))},t.prototype.executeRequest=function(e){var t=W.isCacheAndNetworkEnabled(),r={alias:U.aliasPrefix+this.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:t?i._CacheStrategy.CacheAndNetwork:i._CacheStrategy.CacheThenNetwork,extraProps:new Map([[f.useStalePropName,!0]])};return e.canCacheRequest||(r.cacheStrategy=i._CacheStrategy.NetworkOnly),this._sphomeHttpClient.post(this.getMicroservicePath(e),this._getSiteListAndFilterBody(e.siteList,e.filterKQLQuery),void 0,void 0,r)},t.prototype.getMicroservicePath=function(e){var t="mainSiteUrl="+this._pageContext.site.absoluteUrl+"&",r="start="+e.skip+"&count="+e.count;return r+=C(e),r+=b(e),"news/sites/filtered?"+(this._shouldQueryCurrentSite(e.siteList)?t:"")+r},t.prototype._getNewsItemsWithPadding=function(e,t){var r=U.getPaddingCount(e,t);return U.getEmptyStateItems(e.emptyItemType,this.options.serviceScope,r,e.webpartWidth)},t.prototype._shouldQueryCurrentSite=function(e){var t=this._pageContext.site.id.toString(),r=this._pageContext.web.id.toString();return Q.findIndex(e,function(e){return e.ItemReference.SiteId===t&&e.ItemReference.WebId===r})>-1},t.prototype._getSiteListAndFilterBody=function(e,t){var r=e.map(function(e){return{Type:"SiteReference",SiteId:e.ItemReference.SiteId,WebId:e.ItemReference.WebId}});return JSON.stringify({ReferenceList:r,FilterQuery:t})},t}(Z),Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="myNews",t.title=I.A,t}return Object(p.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"MyNewsDataSource"},enumerable:!0,configurable:!0}),t.prototype.executeRequest_deprecated=function(e){return this._sphomeHttpClient.post(this.getMicroservicePath(e),U.getFilterQueryBody(e.filterKQLQuery))},t.prototype.executeRequest=function(e){var t=W.isCacheAndNetworkEnabled(),r={alias:U.aliasPrefix+this.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:t?i._CacheStrategy.CacheAndNetwork:i._CacheStrategy.CacheThenNetwork,extraProps:new Map([[f.useStalePropName,!0]])};return e.canCacheRequest||(r.cacheStrategy=i._CacheStrategy.NetworkOnly),this._sphomeHttpClient.post(this.getMicroservicePath(e),U.getFilterQueryBody(e.filterKQLQuery),void 0,void 0,r)},t.prototype.getMicroservicePath=function(e){var t="start="+e.skip+"&count="+e.count;return"news/filtered?"+((t+=C(e))+b(e))},t}(Z),we=function(){function e(){}return e.ensureQueryableManagedProperties=function(){return e._loadedQueryableManagedPropertiesPromise||(e._loadedQueryableManagedPropertiesPromise=r.e(1).then(r.bind(null,"n9CK")).then(function(e){return e.default})),e._loadedQueryableManagedPropertiesPromise},e.ensureRetrievableManagedProperties=function(){return e._loadedRetrievableManagedPromise||(e._loadedRetrievableManagedPromise=r.e(2).then(r.bind(null,"oz+a")).then(function(e){return e.default})),e._loadedRetrievableManagedPromise},e}(),Pe=function(){function e(){}return e.prototype.getPerson=function(e,t){var r,n,i,a;if(!e&&t)(o=t.split(";")).length>0&&(n=o[o.length-1]);else if(e){var o;if((o=e.split(" | ")).length>=2&&(i=o[0],n=o[1]),o.length>=3&&o[2]){var s=o[2].split(" ");s.length>1&&s[1].length>1&&(a=this._getAccountNameFromClaim(s[1]))}}return r={name:n},a&&(r.profileImageSrc=c.SPUtility.getUserPhotoUrl(a)),i?(r.email=i,r.profileImageSrc||(r.profileImageSrc=c.SPUtility.getUserPhotoUrl(i))):n?r.initials=this._getEditorInitials(n):r.profileImageSrc||(r.profileImageSrc=c.SPUtility.getUserPhotoUrl()),r},e.prototype._getEditorInitials=function(e){var t;if(e){var r=e.split("(")[0].trim().split(" ");switch(r.length){case 1:t=r[0].substring(0,2);break;default:t=r[0].charAt(0)+r[r.length-1].charAt(0)}t=t.toUpperCase()}return t},e.prototype._getAccountNameFromClaim=function(e){if(e){var t=e.lastIndexOf("|");if(t>=0)return e.substr(t+1)}},e}();function Ce(e){if(!e)return"";var t=new RegExp('[*{}"]',"g");return e.replace(t," ")}var be=function(){function e(e){this._pageContext=e.pageContext}return e.prototype.buildUrl=function(e,t,r){var n=a.UrlUtilities.removeEndSlash(e),i=0===t.indexOf("/")?"":"/",o=t.indexOf("?")>-1?"&":"?";return""+n+i+t+(r?o+r:"")},Object.defineProperty(e.prototype,"pageContext",{get:function(){return this._pageContext},enumerable:!0,configurable:!0}),e}(),Te=r("6DSs"),Ie=function(e){function t(t){var r=e.call(this,t)||this;return r._spHttpClient=t.spHttpClient,r}return Object(p.__extends)(t,e),t.prototype.get=function(e,t,r,n,a,o,s,u){var c=this.buildUrl(e,t,r);return this._getResponse(this._spHttpClient.get(c,i.SPHttpClient.configurations.v1,{headers:o}),n,a,s,u)},t.prototype.post=function(e,t,r,n,a,o,s,u,c){var l=this.buildUrl(e,t,r);return this._getResponse(this._spHttpClient.post(l,i.SPHttpClient.configurations.v1,{body:n,headers:s}),a,o,u,c)},t.prototype.patch=function(e,t,r,n,a,o,s,u,c){var l=this.buildUrl(e,t,r);return this._getResponse(this._spHttpClient.fetch(l,i.SPHttpClient.configurations.v1,{body:n,headers:s,method:"PATCH"}),a,o,u,c)},t.prototype._getResponse=function(e,t,r,n,i){return e.then(function(e){if(e.ok)return i?{}:e.json();var o=a.Text.format(Te.a,t,r,e.status,e.statusMessage);if(n)throw e;return e.json().then(function(t){throw{message:o,status:e.status,correlationId:e.correlationId?e.correlationId.toString():"",innerError:t}})})},t}(be),De=function(){function e(){}return e.generateQueryString=function(e){var t=e.queryString||"",r=e.fields?e.fields.map(function(e){return y.UriEncoding.encodeURIComponent(e)}).join(","):void 0;return 0===(t+=this._generateOption(t,"select",r,!1)+this._generateOption(t,"filter",e.filter,!0)+this._generateOption(t,"top",e.top,!0)+this._generateOption(t,"skip",e.skip,!0)+this._generateOption(t,"orderby",e.orderBy,!0)+this._generateOption(t,"expand",e.expand,!0)).indexOf("&")&&(t=t.slice(1)),t},e._generateOption=function(e,t,r,n){return r&&-1===e.indexOf("$"+t)?"&$"+t+"="+(n?y.UriEncoding.encodeRestUriStringToken(r.toString()):r.toString()):""},e}(),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.getListsForWeb=function(e,t){return this.get(e,"/_api/web/lists",t,"ListDataSource","getListsForWeb",{headers:{accept:"application/json;odata.metadata=none"}}).then(function(e){return e.value})},t.prototype.getListFromWeb=function(e,t,r){return this.get(e,"/_api/web/lists(guid'"+t+"')",r,"ListDataSource","getListFromWeb").then(function(e){return e})},t.prototype.getDefaultDocumentLibrary=function(e,t){return this.get(e,"/_api/web/DefaultDocumentLibrary",t,"ListDataSource","getDefaultDocumentLibrary").then(function(e){return e})},t}(Ie),xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.getFieldsForList=function(e,t,r){return this.get(e,"/_api/web/lists('"+t+"')/Fields",r,"ListFieldDataSource","getFieldsForList",{headers:{accept:"application/json;odata.metadata=none"}}).then(function(e){return e.value})},t}(Ie),Re={Integer:1,Text:2,DateTime:4,Counter:5,Choice:6,Boolean:8,Number:9,Currency:10,MultiChoice:15,User:20},Ue={None:0,ContextInfo:1,ListData:2,ListSchema:4},Fe=r("R/pT"),Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.getItemsForList=function(e,t,r,n,i,a,o,s,u,c,l){if(!n&&!t&&!r)throw Fe.a;var p;void 0===i&&(i=Ue.None),o?(0===o.indexOf("?")&&(o=o.substring(1)),0!==o.indexOf("&")&&(o="&"+o)):o="",n?p="DefaultDocumentLibrary":(p="Lists",p+=t?"(guid'"+t+"')":"/GetByTitle('"+r+"')");var d="/_api/web/"+p+"/RenderListDataAsStream?"+(l?"View="+l:"")+o,h={parameters:{__metadata:{type:"SP.RenderListDataParameters"},RenderOptions:i}},f=new Headers;return f.append("Content-Type","application/json;odata=verbose"),f.append("Accept","application/json;odata=nometadata"),f.append("OData-Version","3.0"),a&&(h.parameters.ViewXml=a),u&&(h.parameters.ImageFieldsToTryRewriteToCdnUrls=u),void 0!==c&&(h.parameters.AudienceTarget=c),this.post(e,d,"",JSON.stringify(h),"ListItemDataSource","getItemsForList",f,s).then(function(e){return e.ListData.Row})},t}(Ie),Ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.addView=function(e,t){var r="/_api/web/lists('"+t+"')/Views/Add",n=JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},PersonalView:!1}});return this.post(e,r,void 0,n,"ListViewDataSource","addView",{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"}).then(function(e){return e.d})},t.prototype.updateViewXml=function(e,t,r,n){var i="/_api/web/lists('"+t+"')/views('"+r+"')/SetViewXml()",a=JSON.stringify({viewXml:n});return this.post(e,i,void 0,a,"ListViewDataSource","updateViewXml",{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"}).then(function(e){return e.d})},Object(p.__decorate)([Object(c.monitor)("ListViewDataSource.addView")],t.prototype,"addView",null),Object(p.__decorate)([Object(c.monitor)("ListViewDataSource.updateViewXml")],t.prototype,"updateViewXml",null),t}(Ie),Oe=function(){function e(){}return e.generateCAMLQuery=function(t,r){var n=this;(t=t||{}).documentTypes=t.documentTypes||[oe.Any],t.fields=t.fields||["Editor","FileLeafRef","File_x0020_Type","ID","Modified","Title","UniqueID"],t.filters=t.filters||[],t.fieldDictionary=t.fieldDictionary||{};var i=[],a=[],o=!1;t.documentTypes.map(function(e){switch(e){case oe.Any:o=!0;break;case oe.Word:i.push(n._documentTypeCriteria(["doc","docm","docx"]));break;case oe.Excel:i.push(n._documentTypeCriteria(["xls","xlsb","xlsm","xlsx"]));break;case oe.PowerPoint:i.push(n._documentTypeCriteria(["pot","potx","ppt","pptm","pptx"]));break;case oe.OneNote:i.push(n._documentTypeCriteria(["one","onepkg","ms-one-stub"]));break;case oe.Visio:i.push(n._documentTypeCriteria(["vsd","vsdm","vsdx","vdw"]));break;case oe.PDF:i.push(n._documentTypeCriteria(["pdf"]))}}),o&&(i=[]),i.length&&(i=['<And><In><FieldRef Name="File_x0020_Type" /><Values>'].concat(i,"</Values></In>"),a.push("</And>")),o&&(i=['<And><And><Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'+e._generateNotIn("File_x0020_Type",["onetoc","onetoc2"])+"</And>"],a.push("</And>")),t.contentTypes&&t.contentTypes.indexOf(ae.News)>-1&&(i.push('<And><Eq><FieldRef Name="PromotedState" /><Value Type="Integer">2</Value></Eq>'),a.push("</And>")),t.languageCode&&this._filterByLanguage(t,i,a);var s=t.sortField||"Modified",u="true";"Modified"===s&&(u="false");var c="";t.maxItemsPerPage&&(c='<RowLimit Paged="false">'+t.maxItemsPerPage+"</RowLimit>");var l=t.fields.map(function(e){return'<FieldRef Name="'+e+'" />'}).join("");return'<View Scope="RecursiveAll"><Query>'+e.generateCAMLFilter(t,i,a,r)+'<OrderBy><FieldRef Name="'+s+'" Ascending="'+u+'" /></OrderBy></Query><ViewFields>'+l+"</ViewFields>"+c+"</View>"},e.generateCAMLFilter=function(e,t,r,n){var i=this;if(t=t||[],r=r||[],e.filterGroup){var a=this._generateCriteriaFromFilterGroup(e.filterGroup,e.fieldDictionary,n);return"<Where>"+t.join("")+(a?"<And>":"")+a+'<Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'+(a?"</And>":"")+r.join("")+"</Where>"}var o=new Map;return e.filters.map(function(t){if(t){var r=i._generateFieldName(t),a=i._generateCriteria(t,e.fieldDictionary,n);r&&a&&(o.get(t.filterType)||o.set(t.filterType,new Map),o.get(t.filterType).get(r)||o.get(t.filterType).set(r,[]),o.get(t.filterType).get(r).push(a))}}),o.forEach(function(e){e.forEach(function(e){t.push("<And>"+i._combineCriteria(e,"Or")),r.push("</And>")})}),"<Where>"+t.join("")+'<Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'+r.join("")+"</Where>"},e._generateNotIn=function(e,t){return t.map(function(t){return'<Neq><FieldRef Name="'+e+'" /><Value Type="Text">'+t+"</Value></Neq>"}).reduceRight(function(e,t){return""===e?t:"<And>"+t+e+"</And>"},"")},e._generateCriteriaFromFilterGroup=function(t,r,n){var i=this,a="";return t.filters&&(a=t.filters.reduce(function(a,o){var s=i._generateCriteria(o,r,n);return e._appendCriteria(t.logicalOperator,a,s)},a)),t.filterGroups&&(a=t.filterGroups.reduce(function(n,a){var o=i._generateCriteriaFromFilterGroup(a,r);return e._appendCriteria(t.logicalOperator,n,o)},a)),a},e._appendCriteria=function(e,t,r){var n="AND"===e?"And":"Or";return t&&r?"<"+n+">"+t+r+"</"+n+">":t+r},e._generateFieldName=function(e){switch(e.filterType){case ce.TitleContaining:return"Title";case ce.CreatedBy:return"Author";case ce.PageAuthorByline:return"_AuthorByline";case ce.ModifiedBy:return"Editor";case ce.RecentlyAdded:return"Created";case ce.RecentlyChanged:return"Modified";case ce.Field:return e.fieldname}return""},e._generateCriteria=function(e,t,r){var n=e.value?this._encodeUserEntryForXML(e.value.toString(),r):"";switch(e.filterType){case ce.TitleContaining:return n?'<Contains><FieldRef Name="Title"/><Value Type="Text">'+n+"</Value></Contains>":"";case ce.CreatedBy:return this._userTypeCriteria(e.userType,n,"Author",e.op);case ce.PageAuthorByline:return this._userTypeCriteria(e.userType,n,"_AuthorByline",e.op);case ce.ModifiedBy:return this._userTypeCriteria(e.userType,n,"Editor",e.op);case ce.RecentlyAdded:return this._dateTimeTypeCriteria(e.value,"Created");case ce.RecentlyChanged:return this._dateTimeTypeCriteria(e.value,"Modified");case ce.Field:return this._fieldTypeCriteria(e,t,r)}return""},e._encodeUserEntryForXML=function(e,t){var r=document.createElement("div");return r.appendChild(document.createTextNode(e)),t?encodeURIComponent(r.innerHTML).replace(new RegExp("'","g"),"%27%27"):r.innerHTML},e._documentTypeCriteria=function(e){return e.map(function(e){return'<Value Type="Text">'+e+"</Value>"}).join("")},e._getISODateString=function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},e._getDateTimeTypeComparisonValueElement=function(e,t,r){return["<And>",this._comparisonElement("Geq",e,'<Value Type="DateTime">'+this._getISODateString(t)+"</Value>"),this._comparisonElement("Leq",e,'<Value Type="DateTime">'+this._getISODateString(r)+"</Value>"),"</And>"].join("")},e._dateTimeTypeCriteria=function(e,t){var r=new Date;if("number"==typeof e)switch(e){case ue.Today:return this._comparisonElement("Eq",t,'<Value Type="DateTime"><Today /></Value>');case ue.Yesterday:return this._comparisonElement("Eq",t,'<Value Type="DateTime"><Today OffsetDays="-1" /></Value>');case ue.ThisWeek:var n=new Date(r.getFullYear(),r.getMonth(),r.getDate()-r.getDay());return this._getDateTimeTypeComparisonValueElement(t,n,r);case ue.ThisMonth:var i=new Date(r.getFullYear(),r.getMonth(),1),a=new Date(r.getFullYear(),r.getMonth()+1,0);return this._getDateTimeTypeComparisonValueElement(t,i,a);case ue.LastMonth:var o=new Date(r.getFullYear(),r.getMonth()-1,1),s=new Date(r.getFullYear(),r.getMonth(),0);return this._getDateTimeTypeComparisonValueElement(t,o,s);case ue.ThisYear:var u=new Date(r.getFullYear(),0,1),c=new Date(r.getFullYear(),11,31);return this._getDateTimeTypeComparisonValueElement(t,u,c);case ue.LastYear:var l=new Date(r.getFullYear()-1,0,1),p=new Date(r.getFullYear()-1,11,31);return this._getDateTimeTypeComparisonValueElement(t,l,p)}return""},e._userTypeCriteria=function(e,t,r,n){switch(n){case se.IsNull:return this._comparisonElement("IsNull",r,"");case se.Equals:default:var i=this._comparisonElement("Eq",r,'<Value Type="Integer"><UserID Type="Integer" /></Value>');return e===de.CurrentUser?i:e===de.SpecificUser&&t?he.isValidMeToken(t)?i:this._comparisonElement("Eq",r,'<Value Type="User">'+t.toString()+"</Value>"):""}},e._criteriaElement=function(e,t,r,n){var i=n?this._encodeUserEntryForXML(r,n):r,a='<Value Type="'+t.TypeAsString+'">'+i+"</Value>";if(t.FieldTypeKind===Re.User&&he.isValidMeToken(i))a='<Value Type="Integer"><UserID Type="Integer" /></Value>';else if(t.FieldTypeKind===Re.DateTime&&he.isValidTodayToken(i)){var o=i.substr("[today]".length)||"0";a='<Value Type="DateTime"><Today OffsetDays="'+parseInt(o,0)+'" /></Value>'}return this._comparisonElement(e,t.InternalName,a)},e._comparisonElement=function(e,t,r){return"<"+e+'><FieldRef Name="'+t+'"/>'+r+"</"+e+">"},e._includeElement=function(e,t,r){var n=this,i=t.map(function(t){return t?n._criteriaElement("Eq",e,t,r):'<IsNull><FieldRef Name="'+e.InternalName+'"/></IsNull>'});return this._combineCriteria(i,"Or")},e._combineCriteria=function(e,t){if(!e||0===e.length)return"";for(var r="",n=1;n<e.length;n++)r+="<"+t+">";for(r+=e[0],n=1;n<e.length;n++)r+=e[n]+"</"+t+">";return r},e._fieldTypeCriteria=function(e,t,r){var n=this;if(!e.fieldInfo&&!t)return"";var i=e.fieldInfo||t[e.fieldname];if(!i)return"";var a=this._parseListFieldValue(e.value,i.FieldTypeKind);if(""===a.trim()&&e.op!==se.Equals&&e.op!==se.NotEqual&&e.op!==se.Between)return"";var o="";switch(e.op){case se.BeginsWith:o=this._criteriaElement("BeginsWith",i,a,r);break;case se.Between:var s=this._parseListFieldValue(e.value2,i.FieldTypeKind);""!==a.trim()&&""!==s.trim()?o="<And>"+this._criteriaElement("Geq",i,a,r)+this._criteriaElement("Leq",i,s,r)+"</And>":""!==a.trim()?o=this._criteriaElement("Geq",i,a,r):""!==s.trim()&&(o=this._criteriaElement("Leq",i,s,r));break;case se.Contains:o=this._criteriaElement("Contains",i,a,r);break;case se.Equals:o=e.values&&e.values.length>0?this._includeElement(i,e.values.map(function(e){return n._parseListFieldValue(e,i.FieldTypeKind)}),r):this._criteriaElement("Eq",i,a,r);break;case se.GreaterThan:o=this._criteriaElement("Gt",i,a,r);break;case se.GreaterThanOrEqualTo:o=this._criteriaElement("Geq",i,a,r);break;case se.LessThan:o=this._criteriaElement("Lt",i,a,r);break;case se.LessThanOrEqualTo:o=this._criteriaElement("Leq",i,a,r);break;case se.NotEqual:o=this._criteriaElement("Neq",i,a,r)}return o},e._parseListFieldValue=function(e,t){var r="";if(void 0===e)return r;switch(t){case Re.DateTime:if("string"==typeof e&&he.isValidTodayToken(e)){r=e.trim();break}var n=new Date(e.toString());"[object Date]"===Object.prototype.toString.call(n)&&(isNaN(n.getTime())||(r=""+n.toISOString()));break;case Re.Number:case Re.Currency:var i=parseFloat(e.toString());isNaN(i)||(r=i.toString());break;case Re.Integer:case Re.Counter:var a=parseInt(e.toString(),10);isNaN(a)||(r=a.toString());break;case Re.User:case Re.Text:default:r=""+e.toString().trim()}return this._encodeUserEntryForXML(r)},e._filterByLanguage=function(e,t,r){var n=e.contentTypes&&e.contentTypes.indexOf(ae.All)>-1,i=!1,a=!1;if(e.contentTypes&&!n)for(var o=0;o<e.contentTypes.length;++o)switch(e.contentTypes[o]){case ae.Page:i=!0;break;case ae.News:a=!0}if(e.languageCode&&(n||i||a)){var s=e.languageCode,u='<Eq><FieldRef Name="_SPTranslationLanguage" /><Value Type="Choice">'+s+"</Value></Eq>",c='<Neq><FieldRef Name="_SPTranslatedLanguages" /><Value Type="MultiChoice">'+s+"</Value></Neq>";t.push("<And><Or>"+u+"<And>"+c+'<IsNull><FieldRef Name="_SPTranslationLanguage" /></IsNull></And></Or>'),r.push("</And>")}},e}(),Le={List:1,Item:2,Field:3},qe=r("YkpB"),Me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="List",t.title=qe.b,t._logSource=s._LogSource.create("ListDataProvider"),t}return Object(p.__extends)(t,e),t.prototype.getItems=function(e){var t=this;switch(e.requestType){case Le.List:return this._listDataSource||(this._listDataSource=new Ee({spHttpClient:this.spHttpClient})),this._listDataSource.getListsForWeb(this.baseEndPoint,De.generateQueryString(e));case Le.Item:return this._listItemDataSource||(this._listItemDataSource=new Ne({spHttpClient:this.spHttpClient})),e.viewId?(this._listViewDataSource||(this._listViewDataSource=new Ae({spHttpClient:this.spHttpClient})),this._listViewDataSource.updateViewXml(this.baseEndPoint,e.id,e.viewId,e.caml).then(function(){return t._listItemDataSource.getItemsForList(t.baseEndPoint,e.id,e.title,e.isDefaultDocumentLibrary,e.renderOptions,void 0,void 0,void 0,void 0,e.audienceTarget,e.viewId)})):this._listItemDataSource.getItemsForList(this.baseEndPoint,e.id,e.title,e.isDefaultDocumentLibrary,e.renderOptions,e.caml,void 0,void 0,void 0,e.audienceTarget);case Le.Field:return this._listFieldDataSource||(this._listFieldDataSource=new xe({spHttpClient:this.spHttpClient})),this._listFieldDataSource.getFieldsForList(this.baseEndPoint,e.id,De.generateQueryString(e));default:var r=new Error(qe.a);return s._TraceLogger.logError(this._logSource,r),Promise.reject(r)}},t.prototype.addView=function(e){return this._listViewDataSource||(this._listViewDataSource=new Ae({spHttpClient:this.spHttpClient})),this._listViewDataSource.addView(this.baseEndPoint,e)},t}(o),ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){for(var r=[],n=["aspx","html","htm"],i=0,a=e.rows;i<a.length;i++){var o=a[i],s=t._personaSettingsCache.getPerson(o.EditorOwsUser,o.ModifiedBy),u=n.indexOf(o.FileExtension)>-1?o.Path:c.SPUtility.getWebPathOfFile(o.DefaultEncodingURL?o.DefaultEncodingURL:o.Path),l=o.LastModifiedTime,p=o.SitePath;p&&(p=p.split(";")[0]);var d=c.SPFormatDateTime.formatTimestampToDisplayDate(l,t._pageContext,{skeleton:"yMMMd"}),h=Q.extend(o,{Name:s.name,Email:s.email,ProfileImageSrc:s.profileImageSrc,Initials:s.initials,InitialsColor:s.initials,WebPath:u,ModifiedDate:d,SitePath:p});h.SiteName&&(h.SiteName=encodeURI(h.SiteName)),r.push(h)}return new Promise(function(e,t){return e(r)})},t}return Object(p.__extends)(t,e),t.prototype._initVariables=function(){this._personaSettingsCache=new Pe},t}(me);function je(e){var t=new Date(e);return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}function He(e,t){return("\n    <View>\n      <ViewFields>\n        "+(J()?'<FieldRef Name="BannerUrl" />':"")+'\n        <FieldRef Name="Category" />\n        <FieldRef Name="EndDate" />\n        <FieldRef Name="EventDate" />\n        <FieldRef Name="ID" />\n        <FieldRef Name="Location" />\n        <FieldRef Name="Title" />\n        <FieldRef Name="fAllDayEvent" />\n        '+(z()?'<FieldRef Name="_ModernAudienceTargetUserField" />':"")+"\n      </ViewFields>\n      <Query>\n        <Where>\n          "+function(e){return a._SPFlight.isEnabled(1634)?"\n      <And>\n        "+e+'\n        <Neq>\n          <FieldRef Name="fRecurrence" />\n          <Value Type="Boolean">1</Value>\n        </Neq>\n      </And>\n    ':"\n      <And>\n        "+e+'\n        <Eq>\n          <FieldRef Name="fRecurrence" />\n          <Value Type="Boolean">0</Value>\n        </Eq>\n      </And>\n    '}(function(e,t){var r=function(e){return e.category?"\n      <Eq>\n        <FieldRef Name='Category' />\n        <Value Type='Choice'>"+y.HtmlEncoding.encodeText(e.category)+"</Value>\n      </Eq>\n    ":""}(e),n=function(e,t){var r='\n      <Geq>\n        <FieldRef Name="EndDate" />\n        <Value IncludeTimeValue="True" Type="DateTime">\n          '+(e.startDate||"<Today />")+"\n        </Value>\n      </Geq>\n    ",n=e.endDate?'\n      <Lt>\n        <FieldRef Name="EventDate" />\n        <Value IncludeTimeValue="True" Type="DateTime">\n          '+je(e.endDate)+"\n        </Value>\n      </Lt>\n    ":"",i=e.startDate?Ve(e.startDate,t):"<Today />",a=e.endDate?Ve(je(e.endDate),t):"",o='\n        <Geq>\n          <FieldRef Name="EndDate" />\n          <Value IncludeTimeValue="True" Type="DateTime">\n            '+i+"\n          </Value>\n        </Geq>\n      ",s=e.endDate?'\n      <Lt>\n        <FieldRef Name="EventDate" />\n        <Value IncludeTimeValue="True" Type="DateTime">\n          '+a+"\n        </Value>\n      </Lt>\n    ":"",u='\n      <Neq>\n        <FieldRef Name="fAllDayEvent" />\n        <Value Type="Boolean">1</Value>\n      </Neq>\n    ';return n?"\n      <Or>\n        <And>\n          "+u+"\n          <And>\n            "+r+"\n            "+n+'\n          </And>\n        </And>\n        <And>\n          <Eq>\n            <FieldRef Name="fAllDayEvent" />\n            <Value Type="Boolean">1</Value>\n          </Eq>\n          <And>\n            '+o+"\n            "+s+"\n          </And>\n        </And>\n      </Or>\n      ":"\n      <Or>\n        <And>\n          "+u+"\n          "+r+'\n        </And>\n        <And>\n          <Eq>\n            <FieldRef Name="fAllDayEvent" />\n            <Value Type="Boolean">1</Value>\n          </Eq>\n          '+o+"\n        </And>\n      </Or>"}(e,t);return r?"\n      <And>\n        "+n+"\n        "+r+"\n      </And>\n    ":n}(e,t))+"\n        </Where>\n      </Query>\n      "+function(e){return e.rowLimit?'<RowLimit Paged="FALSE">'+e.rowLimit+"</RowLimit>":""}(e)+"\n    </View>\n  ").replace(/" \/>/g,'"/>').split(/(?:\r\n|\r|\n)/).map(function(e){return e.trim()}).join("")}function Ve(e,t){var r=new Date(e);return r.setMinutes(r.getMinutes()-t.offset),r.toISOString()}var Be=r("Ycni"),Ge=function(){function e(){}return e.dateStringToUTCDate=function(t,r,n){if(e._allDayKillSwitch.isActivated())return new Date(t);var i=new Date(e.ensureISOTimestamp(t));if(!n)return i;var a=new Be.SPDate({fullYear:i.getUTCFullYear(),month:i.getUTCMonth(),date:i.getUTCDate(),hours:i.getUTCHours(),minutes:i.getUTCMinutes(),seconds:i.getUTCSeconds(),milliseconds:i.getUTCMilliseconds()}).convertToUTC(r);return new Date(Date.UTC(a.fullYear,a.month,a.date,a.hours,a.minutes,a.seconds,a.milliseconds))},e.dateStringToLocalDate=function(t,r,n){var i=new Date(e.ensureISOTimestamp(t));if(!r)return i;var a=new Be.SPDate({fullYear:i.getUTCFullYear(),month:i.getUTCMonth(),date:i.getUTCDate(),hours:i.getUTCHours(),minutes:i.getUTCMinutes(),seconds:i.getUTCSeconds(),milliseconds:i.getUTCMilliseconds()}),o=n?a:a.convertFromUTC(r);return new Date(o.fullYear,o.month,o.date,o.hours,o.minutes,o.seconds)},e.localToUtc=function(e,t){if(!t)return e;var r=new Be.SPDate({fullYear:e.getFullYear(),date:e.getDate(),month:e.getMonth(),hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()}).convertToUTC(t);return new Date(Date.UTC(r.fullYear,r.month,r.date,r.hours,r.minutes,r.seconds))},e.ensureISOTimestamp=function(e){if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?[0-9]*Z$/i.test(e))return e;if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?[0-9]*$/i.test(e))return e.substring(0,19)+"Z";throw new Error("EventTimeZoneUtilities: date time string "+e+" is not supported")},e._allDayKillSwitch=new c.KillSwitch("5a511229-1361-450b-a2ac-61bdf600d687"),e}(),Qe=r("fP0x");function Ke(e,t){return{FieldName:e,FieldValue:t}}function We(e){return e.toLocaleString("en-US").replace(",","").replace(/:\d{2} /," ")}function ze(e,t){var r={formValues:[Ke("Title",e.title),Ke("Category",e.category?e.category instanceof Array?JSON.stringify(e.category):e.category:""),Ke("Description",e.description),Ke("Location",e.location),Ke("EventDate",We(e.startTime)),Ke("EndDate",We(e.endTime)),Ke("fAllDayEvent",e.isAllDayEvent?"true":"false"),Ke("Workspace",e.linkUrl?e.linkUrl+", "+e.linkName:""),Ke("BannerUrl",e.bannerUrl),Ke("ParticipantsPicker",JSON.stringify(t.map(function(e){return{Key:e}}))),Ke("Geolocation",e.geolocation?"Point ("+e.geolocation.longitude+" "+e.geolocation.latitude+")":"")],bNewDocumentUpdate:!1,checkInComment:null};return z()&&e.audiences&&r.formValues.push(Ke("_ModernAudienceTargetUserField",JSON.stringify(e.audiences.map(function(e){return{Key:e}})))),r}function Je(e){return e.status>=200&&e.status<300?204===e.status?Promise.resolve():e.json():e.json().then(function(t){throw Xe(e.correlationId,e.status,t.error)})}function Ze(e){return e.status>=200&&e.status<300?Promise.resolve(!0):e.json().then(function(t){if(400===e.status&&"string"==typeof t.error.message&&t.error.message.indexOf("7F759147-C861-4CD6-A11F-5AA3037D9634"))return Promise.resolve(!1);throw Xe(e.correlationId,e.status,t.error)})}function Ye(e){var t=e.value.filter(function(e){return 0!==e.ErrorCode});if(t.length>0)throw{correlationId:a.Guid.empty,httpStatus:200,code:t[0].ErrorCode.toString(),message:t[0].ErrorMessage};return e.value.filter(function(e){return"Id"===e.FieldName})[0].FieldValue}function Xe(e,t,r){var n=r||{code:"UnknownErrorCode",message:Qe.b};return{correlationId:e,httpStatus:t,code:n.code,message:"string"==typeof n.message?n.message:n.message.value}}var $e=function(){function e(e){this.id="Event",this.title="EventDataProvider",this._eventToETag=new Map,this.options=e,this._serviceScope=e.serviceScope}return e.prototype.requestData=function(e){var t=this;if(!e.listId)return Promise.resolve([]);if(e.startDate&&e.endDate&&new Date(e.startDate)>new Date(e.endDate))return Promise.resolve([]);var r,n={Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"};return this._afterServiceScopeFinished().then(function(o){var s=o.pageContext,u=o.httpClient,c=a.UrlUtilities.removeEndSlash(s.web.absoluteUrl);r=t._getTimeZoneFromPageContext(s);var l=c+"/_api/web/Lists(guid'"+e.listId.toString()+"')/RenderListDataAsStream?"+t._buildQueryString(e),p=JSON.stringify({parameters:{__metadata:{type:"SP.RenderListDataParameters"},DatesInUtc:!0,RenderOptions:3,ViewXml:He(e,r),AudienceTarget:e.audienceTarget}});return u.post(l,i.SPHttpClient.configurations.v1,{body:p,headers:n})}).then(Je).then(function(e){if(e&&e.ListData&&e.ListData.Row instanceof Array)return e.ListData.Row.map(function(n){var i;return{id:n.ID,category:n.Category,title:t._htmlDecode(n.Title),description:void 0,startTime:Ge.dateStringToLocalDate(n.EventDate,r,"1"===n["fAllDayEvent.value"]),endTime:Ge.dateStringToLocalDate(n.EndDate,r,"1"===n["fAllDayEvent.value"]),allDay:"1"===n["fAllDayEvent.value"],location:t._htmlDecode(n.Location),attendees:void 0,containsAudiences:z()?(null===(i=n._ModernAudienceTargetUserField)||void 0===i?void 0:i.length)>0:void 0,prevPageQuery:t._constructPageQuery(e.ListData.PrevHref),nextPageQuery:t._constructPageQuery(e.ListData.NextHref),geolocation:void 0,linkUrl:"",linkName:"",bannerUrl:J()?String(n.BannerUrl):void 0,webName:"",webUrl:""}});throw new Error(Qe.a)})},e.prototype.requestEventItem=function(e,t){return this._requestEventItem(e,t,!1)},e.prototype.requestUTCEventItem=function(e,t,r){return this._requestEventItem(t,r,!0,e)},e.prototype.updateEventItem=function(e,t,r){var n,o=this;return z()?this._afterServiceScopeFinished().then(function(s){var u=s.pageContext,c=s.httpClient,l=a.UrlUtilities.removeEndSlash(u.web.absoluteUrl);n=l+"/_api/web/Lists(guid'"+e.toString()+"')/items('"+t+"')/ValidateUpdateListItem()";var p={"If-Match":o._eventToETag.get(n),"Content-Type":"application/json;charset=utf-8"};return o._getEventPeopleIds(r.attendees).then(function(e){var t=JSON.stringify(ze(r,e.map(function(e){return e.UserPrincipalName||e.LoginName})));return c.post(n,i.SPHttpClient.configurations.v1,{headers:p,body:t})})}).then(function(e){return Je(e).then(function(){return e})}).then(function(e){o._eventToETag.set(n,e.headers.get("ETag"))}):this._updateEventItemFlightDisabled(e,t,r)},e.prototype.deleteEventItem=function(e,t){var r,n=this;return this._afterServiceScopeFinished().then(function(o){var s=o.pageContext,u=o.httpClient,c=a.UrlUtilities.removeEndSlash(s.web.absoluteUrl);r=c+"/_api/web/Lists(guid'"+e.toString()+"')/items("+t+")";var l={"If-Match":n._eventToETag.get(r)};return u.fetch(r,i.SPHttpClient.configurations.v1,{headers:l,method:"DELETE"})}).then(Je).then(function(){n._eventToETag.delete(r)}).catch(function(e){if("-2130575234, Microsoft.SharePoint.SPException"!==e.code)throw e;j._EngagementLogger.logEvent("EventDataProvider.DeleteEventItemFailure.HasSkypeLink")})},e.prototype.createEventItem=function(e,t){var r=this;return z()?this._afterServiceScopeFinished().then(function(n){var o=n.pageContext,s=n.httpClient,u=a.UrlUtilities.removeEndSlash(o.web.absoluteUrl)+"/_api/web/Lists(guid'"+e.toString()+"')/AddValidateUpdateItemUsingPath()",c={Accept:"application/json","Content-Type":"application/json;charset=utf-8"};return r._getEventPeopleIds(t.attendees).then(function(e){var r=JSON.stringify(ze(t,e.map(function(e){return e.UserPrincipalName||e.LoginName})));return s.post(u,i.SPHttpClient.configurations.v1,{headers:c,body:r})})}).then(Je).then(Ye).then(function(t){return r.requestEventItem(e,t)}):this._createEventItemFlightDisabled(e,t)},e.prototype.getAllCategories=function(e){return Promise.all([this.getInUsedCategories(e),this.getPreDefinedCategories(e)]).then(function(e){var t=e[0],r=e[1];return Object(Q.uniq)(Object(p.__spreadArrays)(t,r.categories)).sort()})},e.prototype.getPreDefinedCategories=function(e){return this._afterServiceScopeFinished().then(function(t){var r=t.pageContext,n=t.httpClient,o=a.UrlUtilities.removeEndSlash(r.web.absoluteUrl)+"/_api/web/Lists(guid'"+e.toString()+"')/fields/GetByInternalNameOrTitle('Category')";return n.get(o,i.SPHttpClient.configurations.v1).then(Je).then(function(e){return{categories:Object(p.__spreadArrays)(e.Choices),type:e.TypeAsString}})})},e.prototype.getInUsedCategories=function(e){var t=this;return this._afterServiceScopeFinished().then(function(r){var n=r.pageContext,i=r.httpClient,o=a.UrlUtilities.removeEndSlash(n.web.absoluteUrl);return t._getViewId(o,e.toString(),i).then(function(r){return t._getCategoriesFromView(o,e.toString(),i,r)})})},e.prototype.convertDisplayedDateToUTC=function(e){var t=this;return this._afterServiceScopeFinished().then(function(r){var n=r.pageContext;return Ge.localToUtc(e,t._getTimeZoneFromPageContext(n))})},e.prototype.getAudienceTargetEnabledFlag=function(e){return this._afterServiceScopeFinished().then(function(t){var r=t.pageContext,n=t.httpClient,o=a.UrlUtilities.removeEndSlash(r.web.absoluteUrl)+"/_api/web/Lists(guid'"+e.toString()+"')/Fields(guid'7F759147-C861-4CD6-A11F-5AA3037D9634')";return n.get(o,i.SPHttpClient.configurations.v1,{headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}})}).then(Ze)},e.prototype._createEventItemFlightDisabled=function(e,t){var r,n,o=this,s=e.toString();return this._afterServiceScopeFinished().then(function(e){var u=e.pageContext,c=e.httpClient;r=a.UrlUtilities.removeEndSlash(u.web.absoluteUrl),n=o._getTimeZoneFromPageContext(u);var l=r+"/_api/web/Lists(guid'"+s+"')/items?$select="+["Attachments","BannerUrl","Category","Description","EffectiveBasePermissions","EndDate","EventDate","fAllDayEvent","Geolocation","ID","Location","ParticipantsPickerId","Title","Workspace","fRecurrence"].join(","),p={Accept:"application/json","Content-Type":"application/json;charset=utf-8"};return o._constructEventPayload(t,n).then(function(e){var t=JSON.stringify(e);return c.post(l,i.SPHttpClient.configurations.v1,{headers:p,body:t})})}).then(Je).then(function(e){var t=r+"/_api/web/Lists(guid'"+s+"')/items("+e.ID+")";return o._eventToETag.set(t,e["@odata.etag"]),o._mapRESTResponseEvent(e,n)})},e.prototype._updateEventItemFlightDisabled=function(e,t,r){var n,o,s=this;return this._afterServiceScopeFinished().then(function(u){var c=u.pageContext,l=u.httpClient;o=s._getTimeZoneFromPageContext(c);var p=a.UrlUtilities.removeEndSlash(c.web.absoluteUrl);n=p+"/_api/web/Lists(guid'"+e.toString()+"')/items("+t+")";var d={"If-Match":s._eventToETag.get(n),"X-HTTP-Method":"MERGE","Content-Type":"application/json;charset=utf-8"};return s._constructEventPayload(r,o).then(function(e){var t=JSON.stringify(e);return l.post(n,i.SPHttpClient.configurations.v1,{headers:d,body:t})})}).then(function(e){return Je(e).then(function(){return e})}).then(function(e){s._eventToETag.set(n,e.headers.get("ETag"))})},e.prototype._getViewId=function(e,t,r){var n=e+"/_api/web/Lists/GetById('"+t+"')/Views?$select=Id&$filter=BaseViewId eq '1'";return r.get(n,i.SPHttpClient.configurations.v1).then(Je).then(function(e){return e.value&&e.value.length>0?e.value[0].Id:Promise.reject(new Error("No view is found."))})},e.prototype._getCategoriesFromView=function(e,t,r,n){var a=this,o=e+"/_api/web/Lists/GetById('"+t+"')/RenderListFilterData?FieldInternalName='Category'&ViewId='"+n+"'";return r.post(o,i.SPHttpClient.configurations.v1,{}).then(function(e){if(e.ok)return e.text();throw new Error(JSON.stringify(e))}).then(function(e){var t=new RegExp('Value="([^"]*)',"g"),r=e.match(t).map(function(e){return e.replace(t,"$1")}).map(a._htmlDecode);return Object(Q.uniq)(r)})},e.prototype._mapRESTResponseEvent=function(e,t,r){var i=this;return void 0===r&&(r=!1),this._getEventAttachments(e).then(function(a){return{id:e.ID.toString(),category:e.Category,title:e.Title,description:e.Description,startTime:r?Ge.dateStringToUTCDate(e.EventDate,t,e.fAllDayEvent):Ge.dateStringToLocalDate(e.EventDate,t,e.fAllDayEvent),endTime:r?Ge.dateStringToUTCDate(e.EndDate,t,e.fAllDayEvent):Ge.dateStringToLocalDate(e.EndDate,t,e.fAllDayEvent),location:e.Location,attendees:i._mapRESTResponsePeople(e.ParticipantsPicker),audiences:z()?i._mapRESTResponseAudience(e.OData__ModernAudienceTargetUserField,e["OData__ModernAudienceTargetUserField@odata.navigationLink"]):void 0,bannerUrl:e.BannerUrl?e.BannerUrl.Url:"",attachments:a,linkName:e.Workspace?e.Workspace.Description:"",linkUrl:e.Workspace?e.Workspace.Url:"",isAllDayEvent:e.fAllDayEvent,geolocation:e.Geolocation?{latitude:e.Geolocation.Latitude,longitude:e.Geolocation.Longitude}:void 0,permission:new n.SPPermission(e.EffectiveBasePermissions),isRecurrence:e.fRecurrence,prevPageQuery:void 0,nextPageQuery:void 0,webName:"",webUrl:""}})},e.prototype._getEventAttachments=function(e){var t=this;return this._afterServiceScopeFinished().then(function(r){var n=r.pageContext,o=r.httpClient,s=a.UrlUtilities.removeEndSlash(n.web.absoluteUrl);if(e.Attachments){var u=o.beginBatch(),c=e.AttachmentFiles.map(function(e){return e.ServerRelativeUrl}).map(function(e){var t=s+"/_api/web/getFileByUrl('"+e+"')";return u.get(t,i.SPHttpClientBatch.configurations.v1,{headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(function(e){return Je(e)})});return u.execute().then(function(){return Promise.all(c)}).then(t._mapRESTAttachments)}return Promise.resolve([])})},e.prototype._constructEventPayload=function(e,t){return this._getEventPeopleIds(e.attendees).then(function(e){return e.map(function(e){return e.Id})}).then(function(r){return{Title:e.title,Category:e.category?e.category:null,Description:e.description,Location:e.location,EventDate:Ge.localToUtc(e.startTime,t).toISOString(),EndDate:Ge.localToUtc(e.endTime,t).toISOString(),fAllDayEvent:e.isAllDayEvent,Workspace:{Description:e.linkName,Url:e.linkUrl},BannerUrl:{Url:e.bannerUrl},ParticipantsPickerId:r,Geolocation:e.geolocation?{Latitude:e.geolocation.latitude,Longitude:e.geolocation.longitude}:null,fRecurrence:e.isRecurrence}})},e.prototype._getEventPeopleIds=function(e){return e.length>0?this._afterServiceScopeFinished().then(function(t){var r=t.pageContext,n=t.httpClient,o=a.UrlUtilities.removeEndSlash(r.web.absoluteUrl),s=n.beginBatch(),u=e.map(function(e){var t=o+"/_api/web/ensureUser(@user)?@user='"+encodeURIComponent(e.id)+"'";return s.get(t,i.SPHttpClientBatch.configurations.v1).then(Je).then(function(e){return e})});return s.execute().then(function(){return Promise.all(u)})}):Promise.resolve([])},e.prototype._requestEventItem=function(e,t,r,n){var o,s,u=this;return void 0===r&&(r=!1),this._afterServiceScopeFinished().then(function(r){var c=r.pageContext,l=r.httpClient;s=u._getTimeZoneFromPageContext(c),n=n||a.UrlUtilities.removeEndSlash(c.web.absoluteUrl);var p=["Attachments","BannerUrl","Category","Description","EffectiveBasePermissions","EndDate","EventDate","fAllDayEvent","ID","Location","ParticipantsPicker/Name","ParticipantsPicker/Title","Title","Workspace","fRecurrence","Geolocation"],d=["AttachmentFiles","ParticipantsPicker"];o=n+"/_api/web/Lists(guid'"+e.toString()+"')/items("+t+")";var h={Accept:"application/json","Content-Type":"application/json;charset=utf-8"};return(z()?u.getAudienceTargetEnabledFlag(e):Promise.resolve(!1)).then(function(e){e&&(p.push("OData__ModernAudienceTargetUserField/Name"),d.push("OData__ModernAudienceTargetUserField"));var t="$select="+p.join(",")+"&$expand="+d.join(","),r=o+"/?"+t;return l.get(r,i.SPHttpClient.configurations.v1,{headers:h})})}).then(Je).then(function(e){return u._eventToETag.set(o,e["@odata.etag"]),u._mapRESTResponseEvent(e,s,r)})},e.prototype._afterServiceScopeFinished=function(){var e=this;return new Promise(function(t){e._serviceScope.whenFinished(function(){t({pageContext:e._serviceScope.consume(n.PageContext.serviceKey),httpClient:e._serviceScope.consume(i.SPHttpClient.serviceKey)})})})},e.prototype._buildQueryString=function(e){if(e.pageQuery)return e.pageQuery;var t=[];return e.orderBy&&t.push(["SortField",e.orderBy.field],["SortDir",e.orderBy.direction]),t.map(function(e){return e.join("=")}).join("&")},e.prototype._mapRESTResponsePeople=function(e){return e?e.map(function(e){return{id:e.Name,name:e.Title}}):[]},e.prototype._mapRESTResponseAudience=function(e,t){return e?e.map(function(e){return function(e){var t;return(null===(t=e.Name)||void 0===t?void 0:t.length)>=36?e.Name.substr(e.Name.length-36):""}(e)}):t?[]:void 0},e.prototype._mapRESTAttachments=function(e){return e?e.map(function(e){return{fileName:e.Name,fileSize:e.Length,filePreviewUrl:e.LinkingUri,fileRelativeUrl:e.ServerRelativeUrl}}):[]},e.prototype._constructPageQuery=function(e){return e?e.substr(1).replace("&View=00000000-0000-0000-0000-000000000000",""):""},e.prototype._getTimeZoneFromPageContext=function(e){return e.user.preferUserTimeZone?e.user.timeZoneInfo:e.web.timeZoneInfo},e.prototype._htmlDecode=function(e){return e?(new DOMParser).parseFromString(e,"text/html").body.innerText:e},Object(p.__decorate)([Object(c.monitor)("EventDataProvider.RequestData")],e.prototype,"requestData",null),Object(p.__decorate)([Object(c.monitor)("EventDataProvider.UpdateEventItem")],e.prototype,"updateEventItem",null),Object(p.__decorate)([Object(c.monitor)("EventDataProvider.DeleteEventItem")],e.prototype,"deleteEventItem",null),Object(p.__decorate)([Object(c.monitor)("EventDataProvider.CreateEventItem")],e.prototype,"createEventItem",null),Object(p.__decorate)([Object(c.monitor)("EventDataProvider.GetPreDefinedCategories")],e.prototype,"getPreDefinedCategories",null),Object(p.__decorate)([Object(c.monitor)("EventDataProvider.GetInUsedCategories")],e.prototype,"getInUsedCategories",null),Object(p.__decorate)([Object(c.monitor)("EventDataProvider.GetAudienceTargetEnabledFlag")],e.prototype,"getAudienceTargetEnabledFlag",null),Object(p.__decorate)([Object(c.monitor)("EventDataProvider.GetEventAttachments")],e.prototype,"_getEventAttachments",null),Object(p.__decorate)([Object(c.monitor)("EventDataProvider.GetEventPeopleIds")],e.prototype,"_getEventPeopleIds",null),Object(p.__decorate)([Object(c.monitor)("EventDataProvider.RequestEventItem")],e.prototype,"_requestEventItem",null),e}(),et=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){var r=t._pageContext.user.preferUserTimeZone?t._pageContext.user.timeZoneInfo:t._pageContext.web.timeZoneInfo,n=e.rows.map(function(e){var t="true"===e.IsAllDayEvent,n=Ge.dateStringToLocalDate(e.EventsRollUpStartDate.toString(),r,t);return{endTime:Ge.dateStringToLocalDate(e.EventsRollUpEndDate.toString(),r,t),isAllDayEvent:t,startTime:n,id:e.ListItemID,attendees:void 0,audiences:void 0,bannerUrl:J()?e.BannerUrlOWSURLH?e.BannerUrlOWSURLH.split(",")[0]:"":void 0,category:e.EventsRollUpCategory?e.EventsRollUpCategory.toString():"",description:void 0,geolocation:void 0,linkName:void 0,linkUrl:void 0,listId:e.ListID,location:e.Location?e.Location.toString():"",nextPageQuery:void 0,prevPageQuery:void 0,title:e.Title,webName:e.SiteTitle?e.SiteTitle:"",webUrl:e.SPWebUrl?e.SPWebUrl.toString():"",containsAudiences:!!z()&&Boolean(e.ModernAudienceAadObjectIds)}});return Promise.resolve(n)},t}return Object(p.__extends)(t,e),Object.defineProperty(t,"selectProperties",{get:function(){var e=["EventsRollUpCategory","EventsRollUpEndDate","EventsRollUpStartDate","IsAllDayEvent","ListID","ListItemID","Location","SiteTitle","SPWebUrl","Title"];return J()&&e.push("BannerUrlOWSURLH"),e},enumerable:!0,configurable:!0}),t}(me),tt=[-2130575322,-2147024891],rt=function(){function e(e){this._serviceScope=e}return e.prototype.getEventsLists=function(){var e=this;return this._afterServiceScopeFinished().then(function(t){var r=t.pageContext,n=t.httpClient,a=r.web.absoluteUrl+"/_api/web/Lists?$filter=BaseTemplate eq 106&$select=Id,Title";return n.get(a,i.SPHttpClient.configurations.v1).then(e._parseResponse).then(function(e){return e.value})})},e.prototype.ensureEventsList=function(){var e=this;return this._afterServiceScopeFinished().then(function(t){var r=t.pageContext,n=t.httpClient,a=r.web.absoluteUrl+"/_api/Lists/EnsureEventsList?$select=Title,Id";return n.post(a,i.SPHttpClient.configurations.v1,{}).then(e._parseResponse)})},e.prototype.getEventsListPermission=function(e){var t=this;return e?this._afterServiceScopeFinished().then(function(r){var a=r.pageContext,o=r.httpClient,s=a.web.absoluteUrl+"/_api/web/Lists(guid'"+e+"')/EffectiveBasePermissions";return o.get(s,i.SPHttpClient.configurations.v1).then(t._parseResponse).then(function(e){return new n.SPPermission(e)}).catch(function(e){return tt.forEach(function(t){if(-1!==e.code.indexOf(String(t)))throw new c.ExpectedFailure("SPErrorCode_"+e.code,e.message,{correlationId:e.correlationId?e.correlationId.toString():void 0})}),Promise.reject(e)})}):Promise.resolve(void 0)},e.prototype._afterServiceScopeFinished=function(){var e=this;return new Promise(function(t){e._serviceScope.whenFinished(function(){t({pageContext:e._serviceScope.consume(n.PageContext.serviceKey),httpClient:e._serviceScope.consume(i.SPHttpClient.serviceKey)})})})},e.prototype._parseResponse=function(e){return e.status>=200&&e.status<300?204===e.status?Promise.resolve():e.json():e.json().then(function(t){var r=t.error||{code:"UnknownErrorCode",message:Qe.b};throw{correlationId:e.correlationId,httpStatus:e.status,code:r.code,message:"string"==typeof r.message?r.message:r.message.value}})},Object(p.__decorate)([Object(c.monitor)("EventDataProvider.GetEventsLists")],e.prototype,"getEventsLists",null),Object(p.__decorate)([Object(c.monitor)("EventDataProvider.EnsureEventsList")],e.prototype,"ensureEventsList",null),Object(p.__decorate)([Object(c.monitor)("EventDataProvider.GetEventsListPermission")],e.prototype,"getEventsListPermission",null),e}(),nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.getPageJsonBlob=function(e,t,r){return this.get(e,"_api/sitepages/pages/GetByUrl('"+y.UriEncoding.encodeRestUriStringToken(t)+"')",r,"PageDataSource","getPageJsonBlob").then(function(e){return[e]})},t.prototype.getPageCanvasContent=function(e){return this.get("/",e,"asjson=1","PageDataSource","getPageCanvasContent").then(function(e){return e.page.Content.CanvasContent1})},t}(Ie),it=r("QRxg"),at=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="Page",t.title=it.a,t}return Object(p.__extends)(t,e),t.prototype.getItems=function(e){return this._pageDataSource||(this._pageDataSource=new nt({spHttpClient:this.spHttpClient})),this._pageDataSource.getPageCanvasContent(e.pageRelativeUrl).then(function(e){return[e]})},t}(o),ot=r("I6O9"),st=function(){function e(){}return e.load=function(t){return e._promise||(e._promise=ot.SPComponentLoader.loadComponentById(e._dataProviderComponentId).then(function(e){return new e.PageDataProvider(t)})),e._promise},e._dataProviderComponentId="1cea229f-b208-4202-8014-22503d92a019",e}();function ut(e){var t=e.pageRelativeUrl,r=e.webPartInstanceId,n=e.componentName,i=e.webPartAlias,a=e.defaultWebPartData,o=e.serviceScope,s=e.processWebPartDataCallback,u=new j._QosMonitor(n+".ParseWebPartDataFromPage"),c={serviceScope:o};return st.load(c).then(function(e){return e.requestData({pageRelativeUrl:t})}).then(function(e){var t=e[0],r=t.CanvasJson1||t;return r||function(e,t){var r=new Error("StockContent");throw e.writeExpectedFailure(r.message,r,ct(t)),r}(u,i),JSON.parse(r)}).then(function(e){return function(e,t){if(t)for(var r=0,n=t;r<n.length;r++){var i=n[r];if(i.id===e)return i}}(r,e)}).then(function(e){var t;if(e&&(t=e.webPartData),!t){var n=new Error("NoInstanceDataFound");throw u.writeUnexpectedFailure(n.message,n,ct(i)),n}return t.instanceId=r,s&&(t=s(t)),u.writeSuccess(ct(i)),t}).catch(function(e){return u.hasEnded||u.writeUnexpectedFailure("FailedToParse",e,ct(i)),j._EngagementLogger.logEvent(n+".LoadDefaultWebPartData"),a}).then(function(e){return e})}function ct(e){return{webpart:e}}var lt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){var r=e.rows.map(function(e){return{id:a.Guid.tryParse(e.UniqueID),lastEditor:t._personaSettingsCache.getPerson(e.EditorOwsUser,e.ModifiedBy),lastModifiedDate:e.ModifiedOwsDate&&new Date(e.ModifiedOwsDate),title:e.Title,url:e.DefaultEncodingURL}});return Promise.resolve(r)},t}return Object(p.__extends)(t,e),t.prototype._initVariables=function(){this._personaSettingsCache=new Pe},t}(me),pt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.getPages=function(e){var t=new s._QosMonitor("TemplatePanelDataSource.getPages");return this.get(e,"_api/sitepages/pages/templates","asjson=1","TemplatePanelDataSource","getPages").then(function(e){return t.writeSuccess(),[e]}).catch(function(e){return 404===e.status?t.writeExpectedFailure("TemplatePanelError",Error(e.statusMessage||"getPage returned 404"),{correlationId:e.correlationId,status:e.status}):t.writeUnexpectedFailure("TemplatePanelError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(Ie),dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.getPage=function(e,t){var r=new s._QosMonitor("TemplateSelectedPageCopyDataSource.getPage");return this.get(e,"_api/sitepages/pages("+t+")","$select=CanvasContent1,LayoutWebpartsContent","TemplateCopyDataSource","getPage").then(function(e){return r.writeSuccess(),[e]}).catch(function(e){return r.writeUnexpectedFailure("TemplateSelectedPageCopyError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(Ie),ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.getPage=function(e){var t=new s._QosMonitor("TemplateSelectedPageAsJsonDataSource.getPage");return this.get(e,"","as=json","TemplateSelectedPageAsJsonDataSource","getPage").then(function(e){return t.writeSuccess(),[e]}).catch(function(e){return t.writeUnexpectedFailure("TemplateSelectedPageAsJsonError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(Ie),ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.getDefaultNewPageTemplateId=function(e){var r=new s._QosMonitor(t._dataSourceName+".GetDefaultNewPageTemplateId");return this.get(e,"_api/web/DefaultNewPageTemplateId","",t._dataSourceName,"GetDefaultNewPageTemplateId",this._headers).then(function(e){var t=e.value;return r.writeSuccess(),t}).catch(function(e){return r.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to get DefaultNewPageTemplateId"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t.prototype.setDefaultNewPageTemplateId=function(e,r){var n=new s._QosMonitor(t._dataSourceName+".SetDefaultNewPageTemplateId",!0);return this.post(e,"_api/web/SetDefaultNewPageTemplateId","",JSON.stringify({defaultNewPageTemplateId:r}),t._dataSourceName,"SetDefaultNewPageTemplateId",this._headers,!0,!0).then(function(){return n.writeSuccess(),!0}).catch(function(e){return n.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to set DefaultNewPageTemplateId"),{correlationId:e.correlationId,status:e.status}),!1})},Object.defineProperty(t.prototype,"_headers",{get:function(){var e=new Headers;return e.append("Content-Type","application/json; odata=verbose"),e.append("Accept","application/json; odata.metadata=minimal"),e},enumerable:!0,configurable:!0}),t._dataSourceName="DefaultNewPageTemplateIdDataSource",t._errorTag="DefaultNewPageTemplateIdError",t}(Ie),gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.deleteTemplatePage=function(e,r){var n=new s._QosMonitor(t._dataSourceName+".deleteTemplatePage"),i=t._apiRelativePath+"('"+r+"')";return this.post(e,i+"/recycle()","","",t._dataSourceName,"deleteTemplatePage",this._headers,!0,!0).then(function(){return n.writeSuccess(),!0}).catch(function(e){return n.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to delete template page"),{correlationId:e.correlationId,status:e.status}),!1})},Object.defineProperty(t.prototype,"_headers",{get:function(){var e=new Headers;return e.append("Content-Type","application/json; odata=verbose"),e.append("Accept","application/json; odata.metadata=minimal"),e.append("IF-MATCH","*"),e},enumerable:!0,configurable:!0}),t._apiRelativePath="_api/web/GetFileByServerRelativeUrl",t._dataSourceName="DeleteTemplatePageDataSource",t._errorTag="DeleteTemplatePageError",t}(Ie),_t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplates",t.title="Template Data Provider",t}return Object(p.__extends)(t,e),t.prototype.getItems=function(e){return this._templatePanelDataSource||(this._templatePanelDataSource=new pt({spHttpClient:this.spHttpClient})),this._templatePanelDataSource.getPages(e.webAbsoluteUrl)},t}(o),mt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplatesCopy",t.title="Template Copy Data Provider",t}return Object(p.__extends)(t,e),t.prototype.getItems=function(e){return this._templateSelectedPageCopyDataSource||(this._templateSelectedPageCopyDataSource=new dt({spHttpClient:this.spHttpClient})),this._templateSelectedPageCopyDataSource.getPage(e.webAbsoluteUrl,e.page.Id)},t}(o),vt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplatesAsJson",t.title="Template As Json Data Provider",t}return Object(p.__extends)(t,e),t.prototype.getItems=function(e){return this._templateSelectedPageAsJsonDataSource||(this._templateSelectedPageAsJsonDataSource=new ht({spHttpClient:this.spHttpClient})),this._templateSelectedPageAsJsonDataSource.getPage(e.page.AbsoluteUrl)},t}(o),yt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="DefaultNewPageTemplateId",t.title="Default New Page Template Id Data Provider",t.getItems=function(){return Promise.resolve([])},t}return Object(p.__extends)(t,e),t.prototype.getDefaultNewPageTemplateId=function(e){var t=this;return(this._defaultNewPageTemplateIdDataSource?Promise.resolve():this.resolveServices().then(function(){t._defaultNewPageTemplateIdDataSource=new ft({spHttpClient:t.spHttpClient})})).then(function(){return t._defaultNewPageTemplateIdDataSource.getDefaultNewPageTemplateId(e.RequestingWebUrl)})},t.prototype.setDefaultNewPageTemplateId=function(e){var t=this;return(this._defaultNewPageTemplateIdDataSource?Promise.resolve():this.resolveServices().then(function(){t._defaultNewPageTemplateIdDataSource=new ft({spHttpClient:t.spHttpClient})})).then(function(){return t._defaultNewPageTemplateIdDataSource.setDefaultNewPageTemplateId(e.RequestingWebUrl,e.DefaultNewPageTemplateId)})},t}(o),St=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="DeleteTemplatePage",t.title="Delete Template Page Data Provider",t.getItems=function(){return Promise.resolve([])},t}return Object(p.__extends)(t,e),t.prototype.deleteTemplatePage=function(e){var t=this;return(this._defaultDeleteTemplatePageDataSource?Promise.resolve():this.resolveServices().then(function(){t._defaultDeleteTemplatePageDataSource=new gt({spHttpClient:t.spHttpClient})})).then(function(){return t._defaultDeleteTemplatePageDataSource.deleteTemplatePage(e.RequestingWebUrl,e.RelativePageUrl)})},t}(o),wt=function(){function e(e){this.id="RecentDocuments",this.title="Recent documents",this._pageContext=e}return e.prototype.requestData=function(e){var t=this,r=new j._QosMonitor("RecentDocumentsDataProvider.getRecentDocuments");return e.authToken.then(function(r){return fetch(t._getApiUrl(e),t._getHttpConfig(r))}).then(function(e){return r.writeSuccess(),e.json()}).catch(function(e){r.writeUnexpectedFailure("Unexpected",e)}).then(function(e){return e&&e.documents&&e.documents.items?e.documents.items.map(function(e){var t=new Date(e.time_stamp),r=e.url.substring(0,e.url.lastIndexOf("/")),n="OneNote"===e.app?"one":e.extension,i=new y.Uri(e.url);return i.setQueryParameter("web","1"),{fileName:e.title,fileUrl:i.toString(),filePathSegments:e.display_path,filePathUrl:r,fileType:e.app,fileExtension:n,lastAccessedRelative:t}}):[]})},e.prototype._getApiUrl=function(e){return this._pageContext.legacyPageContext.msMruEndpointUrl+"/ocs/v2/recent/docs?apps=Word,Excel,PowerPoint,Visio,OneNote,Sway,PdfViewer&show="+(e.numDocsToRequest||50)+"&sort=Date"},e.prototype._getHttpConfig=function(e){var t=new Headers;return t.set("Authorization","Bearer "+e),t.set("Content-Type","application/json"),t.set("X-Office-Application","120"),t.set("X-Office-Platform","Web"),t.set("X-Office-Version","aec61d34-20ca-455f-ba08-4fbe7e366f81"),t.set("X-CorrelationId",a.Guid.newGuid().toString()),{headers:t}},e}(),Pt=function(){function e(e){this._httpClient=e.serviceScope.consume(i.HttpClient.serviceKey),this._cultureName=e.serviceScope.consume(n.PageContext.serviceKey).cultureInfo.currentUICultureName,this._qosPrefix=e.qosPrefix}return e.prototype.getLocationSuggestions=function(e,t){void 0===t&&(t=5);var r=new j._QosMonitor(this._qosPrefix+".BingLocationDataProvider.GetLocationSuggestions"),n=new y.Uri("https://www.bingapis.com/api/v6/Places/AutoSuggest");return n.setQueryParameter("q",e),n.setQueryParameter("appid","DEFC13FBC2E876A56E00AD5BDB9B690CD6B55B16"),n.setQueryParameter("structuredaddress","true"),n.setQueryParameter("setmkt",this._cultureName),n.setQueryParameter("setlang",this._cultureName),n.setQueryParameter("count",String(t)),"zh-cn"===this._cultureName.toLowerCase()?(n.setQueryParameter("localmapview","40.173091266970914,116.1689437866211,39.68604237738654,116.63105621337891"),n.setQueryParameter("localcircularview","39.9295,116.4,100")):"ja-jp"===this._cultureName.toLowerCase()&&(n.setQueryParameter("localmapview","36.266035662679684,139.24756548070306,35.10266624641582,140.5796577658593"),n.setQueryParameter("localcircularview","39.9785614013672,116.308280944824,100")),this._httpClient.get(n.toString(),i.HttpClient.configurations.v1).catch(function(e){return Promise.reject(new c.UnexpectedFailure("NetworkError",e))}).then(this._parseResponse).then(function(e){if(e&&e.value)return r.writeSuccess(),e.value.filter(function(e){return e.address});r.writeUnexpectedFailure("BingLocationDataProvider: value data does not exist in response.")})},e.prototype.getLocationInfo=function(e,t){void 0===t&&(t=1);var r=new j._QosMonitor(this._qosPrefix+".BingLocationDataProvider.GetLocationInfo"),n=new y.Uri("https://dev.virtualearth.net/REST/v1/Locations");return n.setQueryParameter("query",e),n.setQueryParameter("o","json"),n.setQueryParameter("c",this._cultureName),n.setQueryParameter("maxResults",t.toString()),n.setQueryParameter("key","AmOSPT8X9eXz5u_8hQauiEyLHFJOG522w2XBbewYRhDtcEAUpsVIbvpApHbDAtyA"),this._httpClient.get(n.toString(),i.HttpClient.configurations.v1).catch(function(e){return r.writeUnexpectedFailure("BingLocationDataProvider.getLocationInfo: network error."),Promise.reject(new c.UnexpectedFailure("NetworkError",e))}).then(this._parseResponse).then(function(e){try{var t=e.resourceSets[0].resources.map(function(e){return{name:e.name,coordinates:{latitude:e.point.coordinates[0],longitude:e.point.coordinates[1]}}});return r.writeSuccess(),t}catch(e){return r.writeUnexpectedFailure("BingLocationDataProvider.getLocationInfo: invalid response."),Promise.reject(e)}})},e.prototype._parseResponse=function(e){return e.ok?e.json().catch(function(t){return Promise.reject(new c.UnexpectedFailure("FailedToParseResponse",t,{statusCode:e.status}))}):e.json().catch(function(t){return Promise.reject(new c.UnexpectedFailure("FailedToParseError",t,{statusCode:e.status}))}).then(function(t){return Promise.reject(new c.UnexpectedFailure("RequestFailure",JSON.stringify(t),{statusCode:e.status}))})},e}(),Ct=function(){function e(e){this._guid=a.Guid.parse(e)}return e.prototype.isActivated=function(){return a._SPKillSwitch.isActivated(this._guid,"","")},e}();function bt(){return a._SPKillSwitch.isActivated("03fe1e3a-35a4-4d30-9d7d-eba1b4537dbb")}function Tt(e){var t,r,n;if(403===(null===(t=e)||void 0===t?void 0:t.status)){var i=new Date((new Date).getTime()+36e5);(null===(r=sessionStorage)||void 0===r?void 0:r.setItem)&&(sessionStorage.setItem("cortexDisableFlag",i.toISOString()),bt()?s._EngagementLogger.logEvent("CSIKM.CortexEnabledFlag.Set.True"):function(e,t){var r,n,i;void 0===t&&(t=!0),(null===(r=sessionStorage)||void 0===r?void 0:r.getItem)&&(null!=(n=sessionStorage.getItem("lastCortexDisableFlagLogged"))?n:"")!==e&&(null===(i=sessionStorage)||void 0===i?void 0:i.setItem)&&(t&&s._EngagementLogger.logEvent(e),sessionStorage.setItem("lastCortexDisableFlagLogged",e))}("CSIKM.CortexEnabledFlag.Set.True"),!bt()&&(null===(n=sessionStorage)||void 0===n?void 0:n.removeItem)&&sessionStorage.removeItem("lastCortexDisableFlagLogged"))}}!function(){function e(){}e.newYoutubeUrlRegexKS=new Ct("93326c3b-13a0-4ea5-9979-87eddec6d21a"),e.urlUtilityRefactor=new Ct("77727f04-2ebb-4f7a-b916-692003f4dec7")}();var It,Dt=function(){function e(){}return e.parseClientCachableResponse=function(e,t,r,n,i,o,u){var l=this;if(a.Validate.isNotNullOrUndefined(e,"response"),a.Validate.isNotNullOrUndefined(t,"isRawData"),a.Validate.isNotNullOrUndefined(r,"isCachedDataEmpty"),a.Validate.isNotNullOrUndefined(n,"processRawData"),a.Validate.isNotNullOrUndefined(i,"qosMonitor"),a.Validate.isNonemptyString(o,"qosTagPrefix"),!e.cachedResponse&&!e.serverResponse){var p=new Error("ParseClientCachableResponse_EmptyResponse");throw i.writeUnexpectedFailure(p.message),p}var d,h=u&&this._isIdInvalidForCacheUsage(u);if((!e.cachedResponse||h)&&e.serverResponse)return e.serverResponse.then(function(e){return h&&l._clearIdFromInvalidCacheUsage(u),l._processHttpResponse(e,i,o)});var g=new s._QosMonitor(o+".IndexedDB.CacheOnly.DP"),_=f.processResponseRawData(e.cachedResponse,t,n.bind(this)).then(function(e){return d=JSON.stringify(e),g.writeSuccess(),r(e)?Promise.reject("Indexed DB cached data is empty"):e});if(!e.serverResponse)return _;var m=!1,v=e.serverResponse.then(function(e){if(m=!0,d)try{l._logCacheRefreshedQos(d,e,n.bind(l),o)}catch(e){}return l._processHttpResponse(e,i,o)}),y=a.Guid.parse("fdbcc3e7-1aa1-4bc5-809c-fd4b4cf3ce56"),S=a.Guid.parse("ae67b80b-7315-447c-94bc-8d51c712bfb8"),w=[{raceablePromise:_,raceId:y},{raceablePromise:v,raceId:S}];return c.SmartRace.race(w).then(function(e){return e.raceId!==y||m||v.then(function(e){return e}).catch(function(e){throw e}),m?v:_})},e.getUniquePageId=function(e,t,r){var n,i,a;return(null===(n=e)||void 0===n?void 0:n.toString().length)&&(null===(i=t)||void 0===i?void 0:i.toString().length)&&(null===(a=r)||void 0===a?void 0:a.toString().length)?{siteId:e.toString(),webId:t.toString(),uniqueId:r.toString()}:void 0},e.setInvalidForCacheUsage=function(e){var t;a.Validate.isNotNullOrUndefined(e.uniqueId,"uniquePageId.uniqueId"),a.Validate.isNotNullOrUndefined(e.siteId,"uniquePageId.siteId"),a.Validate.isNotNullOrUndefined(e.webId,"uniquePageId.webId");var r=null!=(t=this._getInvalidIdsFromStorage())?t:[];this._getIndexOf(e,r)===this._indexNotPresent&&(r.push(e),sessionStorage.setItem("CortexInvalidIDBPages",JSON.stringify(r)))},e._clearIdFromInvalidCacheUsage=function(e){var t=this._getInvalidIdsFromStorage();if(t){var r=this._getIndexOf(e,t);r!==this._indexNotPresent&&(1===t.length?sessionStorage.removeItem("CortexInvalidIDBPages"):(t.splice(r,1),sessionStorage.setItem("CortexInvalidIDBPages",JSON.stringify(t))))}},e._isIdInvalidForCacheUsage=function(e){var t=this._getInvalidIdsFromStorage();return!!t&&this._getIndexOf(e,t)!==this._indexNotPresent},e._getIndexOf=function(e,t){return Object(Q.findIndex)(t,function(t){return t.uniqueId===e.uniqueId&&t.siteId===e.siteId&&t.webId===e.webId})},e._getInvalidIdsFromStorage=function(){var e,t;if(null===(e=sessionStorage)||void 0===e?void 0:e.getItem){var r=null!=(t=sessionStorage.getItem("CortexInvalidIDBPages"))?t:"";return r?JSON.parse(r):void 0}},e._logCacheRefreshedQos=function(e,t,r,n){var i=this;t.clone&&200===t.status&&t.clone().json().then(function(t){var a,o=r(t);a=i._compareResponseData(e,JSON.stringify(o))?"RefreshedNoChanges.DP":"Refreshed.DP",new s._QosMonitor(n+".IndexedDB."+a).writeSuccess()}).catch(function(e){return Promise.reject(e)})},e._compareResponseData=function(e,t){var r;return!!(null===(r=e)||void 0===r?void 0:r.length)&&e===t},e._getExtraData=function(e){return{mscv:e.headers.get("ms-cv"),status:e.status}},e._processAPIError=function(e,t,r,n){var i;if(403!==(null===(i=n)||void 0===i?void 0:i.status))return a=new Error(t+": Error:: "+r),e.writeUnexpectedFailure("UnexpectedHttpStatus",a,n),a;var a=new Error(t+": Error:: "+n.status);e.writeExpectedFailure("Expected403",a,n)},e._processHttpResponse=function(e,t,r){if(Tt(e),e.status>=200&&e.status<=299&&204!==e.status)return t.writeSuccess(this._getExtraData(e)),e.json();var n=this._processAPIError(t,r+" API failure",JSON.stringify(e.body),this._getExtraData(e));return n?Promise.reject(n):Promise.resolve(void 0)},e.onlyIndexedDB=f.onlyIndexedDB,e._indexNotPresent=-1,e}(),Et=function(){function e(t){var r=this;this._warmUpQueryRun=!1,this._processRawData=function(e){return e.value},a.Validate.isNotNullOrUndefined(t,"serviceScope"),t.whenFinished(function(){r._spHomeHttpClient=t.consume(_.serviceKey)}),this._indexedDBEnabled=a._SPFlight.isEnabled(1703)&&(1===a._SPExperiment.getVariantAndLogExposure(90041)||a._SPFlight.isEnabled(1082))&&!a._SPKillSwitch.isActivated("040e5812-ee72-430b-93d9-42b62ff8ce13"),this._shouldWarmUpSuggestionsApi()&&(e._lastInitQueryTime=(new Date).getTime(),this._warmUpSuggestionsApi())}return e.prototype.getTopicSuggestions=function(t,r,n,o){return void 0===o&&(o=0),Object(p.__awaiter)(this,void 0,void 0,function(){var u,c,l;return Object(p.__generator)(this,function(p){if(this._isRunTAB())return(u=this._getMockData())?[2,Promise.resolve(JSON.parse(u))]:[2,Promise.resolve({value:[]})];if(c=new s._QosMonitor(e._legacyQosTag),0===r.length||n<1)throw c.writeUnexpectedFailure(e._legacyQosTag,new Error("Invalid argument languageId or count")),new Error("Invalid argument languageId or count");return 0===t.length&&this._topicSuggestionData?[2,this._topicSuggestionData]:(l=a.Text.format("knowledgebase/entities/suggestions(query='{0}',lcid={1},count={2},relationCount={3})",t,r,n,o),this._indexedDBEnabled?[2,this._requestData(l,i._CacheStrategy.CacheAndNetwork)]:[2,this._requestDataLegacy(l,c)])})})},e.prototype._requestData=function(t,r,n,i){var a=this,o=i||new s._QosMonitor(e._qosTagPrefix+".SuggestionsQuery.DP");return this._executeRequest(t,r,n).then(function(t){return Dt.parseClientCachableResponse(t,a._isRawData,a._isCachedDataEmpty,a._processRawData,o,e._qosTagPrefix).then(function(e){var t=!0;return a._isRawData(e)&&(e=a._processRawData(e),t=!1),{value:e,isCachedResponse:t}}).catch(function(e){return Promise.reject(e)})}).catch(function(e){return o.writeUnexpectedFailure("UnexpectedFailure",e),Promise.reject(e)})},e.prototype._executeRequest=function(e,t,r){void 0===r&&(r=864e5);var n={alias:"FirstParty_KMTopicSuggestionSearchDP",id:"KMTopicSuggestionSearchDP",expirationDuration:r,cacheStrategy:t,extraProps:new Map([[Dt.onlyIndexedDB,!0]])};return this._spHomeHttpClient.get(e,2,void 0,n)},e.prototype._requestDataLegacy=function(t,r){var n=this;return this._spHomeHttpClient.get(t,2).then(function(e){if(Tt(e),n._qosLog(e,r),e.ok)return n._topicSuggestionData=e.json(),n._topicSuggestionData;throw new Error(e.statusText)}).catch(function(t){return r.writeUnexpectedFailure(e._legacyQosTag,t),Promise.reject(t)})},Object.defineProperty(e.prototype,"_isPageInEditMode",{get:function(){return-1!==new URLSearchParams(window.location.search).toString().indexOf("Mode=Edit")},enumerable:!0,configurable:!0}),e.prototype._isRawData=function(e){return e&&e.value},e.prototype._isCachedDataEmpty=function(e){return 0===e.length},e.prototype._warmUpSuggestionsApi=function(){var t=this;if(this._isPageInEditMode&&!this._warmUpQueryRun){if(this._warmUpQueryRun=!0,this._isRunTAB()){var r=this._getMockData();return void(this._topicSuggestionData=r?Promise.resolve(JSON.parse(r)):Promise.resolve({value:[]}))}var n=e._qosTagPrefix+".Init.DP",o=new s._QosMonitor(n),u=a.Text.format("knowledgebase/entities/suggestions(query='{0}',lcid={1},count={2},relationCount={3})","","1033",5,4);this._indexedDBEnabled?this._topicSuggestionData=this._requestData(u,i._CacheStrategy.CacheThenNetwork,3e5,o):this._spHomeHttpClient.get(u,2).then(function(e){if(Tt(e),t._qosLog(e,o,"FailedStatusOnWarmUp"),e.ok)return t._topicSuggestionData=e.json(),e.json()}).catch(function(e){o.writeUnexpectedFailure("FailedOnWarmUp",e)})}},e.prototype._getExtraData=function(e){return{mscv:e.headers.get("ms-cv"),status:e.status}},e.prototype._qosLog=function(e,t,r){if(e.ok)t.writeSuccess(this._getExtraData(e));else{var n=new Error(e.statusText);403===e.status?t.writeExpectedFailure("ExpectedFailure403",n,this._getExtraData(e)):t.writeUnexpectedFailure(r,n,this._getExtraData(e))}},e.prototype._shouldWarmUpSuggestionsApi=function(){var t=(new Date).getTime()-e._lastInitQueryTime;return!e._lastInitQueryTime||t>3e5},e.prototype._isRunTAB=function(){return"true"===window.sessionStorage.getItem("isRunTAB")},e.prototype._getMockData=function(){return window.sessionStorage.getItem("MOCK_TOPIC_SUGGESTION_RESPONSE")},e._qosTagPrefix="CSIKM.HashTagging",e._legacyQosTag=e._qosTagPrefix+".DP",e}();!function(e){e.GetFirstRunHTTPError403="GetFirstErrorHTTP403",e.GetFirstRunHTTPStatusError="GetFirstHTTPStatusError",e.GetFirstRunHTTPRequestError="GetFirstHTTPRequestError"}(It||(It={}));var xt,Rt=It,Ut={true:!0,false:!1},Ft=function(){function e(){}return e.getIsFirstRun=function(e){var t=window.localStorage.getItem(e);return Ut[t]},e.setIsFirstRun=function(t,r){var n=window.localStorage.getItem(t),i=String(r);if(n!==i)try{window.localStorage.setItem(t,i)}catch(t){s._TraceLogger.logError(e._logSource,t)}},e._logSource=s._LogSource.create("CortexFirstRunCacheManager"),e}();!function(e){e.KnowledgeCenter="KnowledgeCenterFirstRun",e.KnowledgeManagementTopicPage="KnowledgeManagementTopicPageFirstRun"}(xt||(xt={}));var Nt,At=xt,Ot=function(){function e(){}return e.topicFirstRun="CSIKM.FirstRun",e.topicFirstRunDPLogPrefix=e.topicFirstRun+".DP",e.topicFirstRunGetAPIDPPrefix=e.topicFirstRun+"GetAPI.DP",e.topicFirstRunSetAPIDPPrefix=e.topicFirstRun+"SetAPI.DP",e}(),Lt=((Nt={})[At.KnowledgeCenter]="sharePointKnowledgeCenterFirstRun",Nt[At.KnowledgeManagementTopicPage]="sharePointKnowledgeManagementTopicPageFirstRun",Nt),qt=function(){function e(e,t){this._spHttpClient=t,this._pageContext=e}return e._domainUrl=function(){return decodeURIComponent(window.location.protocol+"//"+window.location.host)},e._getErrorExtraData=function(e){var t=e.headers.get("sprequestguid")||"",r=e.headers.get("microsoftsharepointteamservices")||"";return{status:e.status,correlationId:t,spVersion:r}},e.prototype.getIsFirstRun=function(t){return Object(p.__awaiter)(this,void 0,void 0,function(){var r;return Object(p.__generator)(this,function(n){switch(n.label){case 0:return"boolean"!=typeof(r=Ft.getIsFirstRun(t))?[3,1]:(s._TraceLogger.logVerbose(e._logSource,Ot.topicFirstRun+" is "+r+" in the local storage"),[2,r]);case 1:return[4,this._getServerIsFirstRun(t)];case 2:return[2,n.sent()]}})})},e.prototype.setIsFirstRun=function(e,t){return Object(p.__awaiter)(this,void 0,void 0,function(){return Object(p.__generator)(this,function(r){switch(r.label){case 0:return[4,this.setServerIsFirstRun(e,t)];case 1:return r.sent(),this.setLocalIsFirstRun(e,t),[2]}})})},e.prototype.setServerIsFirstRun=function(t,r){return Object(p.__awaiter)(this,void 0,void 0,function(){var n,a,o,u,c;return Object(p.__generator)(this,function(l){switch(l.label){case 0:return n=!r,a=new j._QosMonitor(Ot.topicFirstRunGetAPIDPPrefix),(o={})[Lt[t]]=n,[4,this._spHttpClient.post(this._bitRestUrl,i.SPHttpClient.configurations.v1,{body:JSON.stringify(o),headers:{Accept:"*/*, application/json; odata=minimalmetadata","X-HTTP-Method":"PATCH","Content-Type":"application/json; odata=minimalmetadata","X-ClientType":"PageAuthoring_SetFirstRunBit"}})];case 1:if(!(u=l.sent()).ok)throw c=new Error(u.statusText),s._TraceLogger.logError(e._logSource,c),a.writeUnexpectedFailure(Ot.topicFirstRunSetAPIDPPrefix,c,e._getErrorExtraData(u)),c;return s._TraceLogger.logVerbose(e._logSource,"Request successfully for setting page authoring first run, the status: "+n),a.writeSuccess(),[2]}})})},e.prototype.setLocalIsFirstRun=function(e,t){Ft.setIsFirstRun(e,t)},e.prototype._getServerIsFirstRun=function(t){return Object(p.__awaiter)(this,void 0,void 0,function(){var r,n,a,o,u,c,l;return Object(p.__generator)(this,function(p){switch(p.label){case 0:r=new j._QosMonitor(Ot.topicFirstRunGetAPIDPPrefix),p.label=1;case 1:return p.trys.push([1,6,,7]),[4,this._spHttpClient.get(this._retrieveBitRestUrl(t),i.SPHttpClient.configurations.v1,{headers:{"X-ClientType":"PageAuthoring_GetFirstRunBit"}})];case 2:return(n=p.sent()).ok?[4,n.json()]:[3,4];case 3:return a=p.sent(),o=a[Lt[t]],s._TraceLogger.logVerbose(e._logSource,"Retrieving first run bit "+t+" successfully, the status: "+!o),r.writeSuccess(),[2,!o];case 4:return u=new Error(n.statusText),c=e._getErrorExtraData(n),403===n.status?(r.writeExpectedFailure(Rt.GetFirstRunHTTPError403,u,c),[2,!1]):(s._TraceLogger.logError(e._logSource,u),r.writeUnexpectedFailure(Rt.GetFirstRunHTTPStatusError,u,c),[2,Promise.reject(u)]);case 5:return[3,7];case 6:return l=p.sent(),s._TraceLogger.logError(e._logSource,l),r.writeUnexpectedFailure(Rt.GetFirstRunHTTPRequestError,l),[2,Promise.reject(l)];case 7:return[2]}})})},e.prototype._retrieveBitRestUrl=function(e){return this._bitRestUrl+"?$select="+Lt[e]},Object.defineProperty(e.prototype,"_bitRestUrl",{get:function(){return e._domainUrl()+"/_api/SP.Directory.DirectorySession/GetGraphUser(principalName='"+y.UriEncoding.encodeURIComponent(this._pageContext.legacyPageContext.userLoginName)+"')"},enumerable:!0,configurable:!0}),e._logSource=s._LogSource.create(Ot.topicFirstRunDPLogPrefix),e}(),Mt={HighlightedContent:1,SiteActivity:2,Sites:3,RecentDocuments:4,OfficeFeed:5,MyTopics:6,Other:999}},oxet:function(e,t,r){e.exports=r.p+"Modernize_News_a3fe9f83e59c20415da4c571d192296b.svg"},ui8f:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n={Text:1,Integer:2,Decimal:3,DateTime:4,YesNo:5,Binary:6,Double:7}},ut3N:function(e,t){e.exports=p},vlQI:function(e,t){e.exports=d},y88i:function(e,t){e.exports=h}})});