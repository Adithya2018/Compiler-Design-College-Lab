define("cbe7b0a9-3504-44dd-a3a3-0e5cacd07788_0.0.1",["tslib","@ms/sp-telemetry","@ms/sp-load-themed-styles","@microsoft/sp-image-helper","@microsoft/sp-loader","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","@microsoft/sp-webpart-base","react","react-dom","@ms/sp-component-utilities","@microsoft/load-themed-styles","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(e,t,r,n,i,o,a,c,s,l,u,d,p,f,h,_,g){return function(e){function t(t){for(var r,i,o=t[0],a=t[1],c=0,s=[];c<o.length;c++)i=o[c],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&s.push(n[i][0]),n[i]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);for(l&&l(t);s.length;)s.shift()()}var r={},n={16:0};function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(t){for(var r=[],a=function(e){var t={i:"c83d5509-ccd5-4c67-919f-2440f237927a",v:"0.2.223",m:"Ycni"},r={i:"914330ee-2df2-4f6e-a858-30c23a812408",v:"1.15.42",m:"U4ag"},n={i:"2e09fb9b-13bb-48f2-859f-97d6fff71176",v:"1.1.4",m:"K9kD"},i={i:"17ce0976-e69a-4355-be84-89b69a74717d",v:"0.1.0",m:"fglE"};return{15:[t],20:[r,t],21:[r,t],23:[{i:"49d290fb-a38e-4001-97d3-a2db486db2fa",v:"0.1.0",m:"HVbJ"}],27:[n],29:[i,n],17:[{i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:"9poL"}],24:[i]}[e]||[]}(t),c=0;c<a.length;c++)e[a[c].m]||function(t){r.push(o.SPComponentLoader.loadComponentById(t.i,t.v).then(function(r){e[t.m]=function(e){e.exports=r}}))}(a[c]);var s=n[t];if(0!==s)if(s)r.push(s[2]);else{var l=new Promise(function(e,r){s=n[t]=[e,r]});r.push(s[2]=l);var u,d=document.createElement("script");d.charset="utf-8",d.timeout=120,i.nc&&d.setAttribute("nonce",i.nc),d.src=function(e){return i.p+"chunk."+({7:"live-persona-card-loader",15:"sp-title-region-publishdate",17:"sp-title-region-webpart-edit-mode",18:"title-region-authorbylinedataprovider",19:"title-region-color-block-layout",20:"title-region-event-layout",21:"title-region-event-no-image-layout",22:"title-region-news-digest-layout",23:"title-region-topic-page-layout",24:"vendors~data-sync-nucleus",27:"vendors~live-persona-card-loader",29:"vendors~sp-title-region-webpart-edit-mode"}[e]||e)+"_"+(["en-us","none"])[{"7":0,"15":0,"17":0,"18":1,"19":1,"20":0,"21":0,"22":1,"23":0,"24":1,"27":1,"29":0}[e]]+"_"+{7:"f89496821062ca0a6ef9",15:"619f2069ed554408fd64",17:"8ee5360126e3b2a660db",18:"decdbbc16e2d2c160ff2",19:"fa4e5bf796f624e9159d",20:"8739a6bb9a26db153dec",21:"c5dbaa61aeb74b6663e5",22:"1adb66dd7c67c6c34e27",23:"bd61f66ee020842df441",24:"263c1f1a60037dfa935d",27:"67ab982a1a9daec23403",29:"da1df0607596e9924cff"}[e]+".js"}(t);var p=new Error;u=function(e){d.onerror=d.onload=null,clearTimeout(f);var r=n[t];if(0!==r){if(r){var i=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;p.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",p.name="ChunkLoadError",p.type=i,p.request=o,r[1](p)}n[t]=void 0}};var f=setTimeout(function(){u({type:"timeout",target:d})},12e4);d.onerror=d.onload=u,document.head.appendChild(d)}return Promise.all(r)},i.m=e,i.c=r,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var o=i("I6O9");i.oe=function(e){throw console.error(e),e};var a=window.webpackJsonp_8c4a6a562ec36ed6536c907cfb0e02ee=window.webpackJsonp_8c4a6a562ec36ed6536c907cfb0e02ee||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var l=c;return function(){var e,t=document.getElementsByTagName("script"),r="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-title-region-webpart_en-us_39f05ee8d592b52e88a0\.js/i;if(t&&t.length)for(var n=0;n<t.length;n++)if(t[n]){var o=t[n].getAttribute("src");if(o&&o.match(r)){e=o.substring(0,o.lastIndexOf("/")+1);break}}if(!e)for(var a in window.__setWebpackPublicPathLoaderSrcRegistry__)if(a&&a.match(r)){e=a.substring(0,a.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="tp9l")}({"+L0y":function(e,t,r){"use strict";r.d(t,"a",function(){return l});var n=r("17wl"),i=r("KL1q"),o=r("UWqr"),a=r("cDcd");r("OM4a");var c=function(e){function t(t){var r=e.call(this,t)||this;return r.update=function(){r._textContainerElementRef.current&&r._async.requestAnimationFrame(r._truncateLines)},r._truncateLines=function(){if(r._textContainerElementRef.current){var e=r.props.text||"";r._textContainerElementRef.current.textContent=e;var t=Math.round(r.props.lines),n=window.getComputedStyle(r._textContainerElementRef.current,void 0).getPropertyValue("line-height"),i=t*parseFloat(n),o=r._contentHeight;r._textArray=e.split("");var a=o>i&&t>0;if(a){var c=r._trimAndCalculateLength(o,i);r._applyTextNumber(c)}a&&r.props.autoShowTitle?r._textContainerElementRef.current.title=e:r._textContainerElementRef.current.removeAttribute("title"),r.props.onAfterTruncate&&r.props.onAfterTruncate(a)}},r._async=new i.Async(r),r._eventGroup=new i.EventGroup(r),r._handleWindowResize=r._async.debounce(r._handleWindowResizeCore,1010),r._textContainerElementRef=a.createRef(),r}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){this._async.setTimeout(this.update,0),this._eventGroup.on(window,"resize",this._handleWindowResize)},t.prototype.componentDidUpdate=function(){this.update()},t.prototype.componentWillUnmount=function(){this._eventGroup.off(window,"resize",this._handleWindowResize),this._eventGroup.dispose(),this._async.dispose()},t.prototype.render=function(){return a.createElement("div",Object(n.__assign)({},Object(i.getNativeProps)(this.props,i.divProperties),{"data-automation-id":"less-text",ref:this._textContainerElementRef,className:Object(i.css)("a_a_658c9e0a",this.props.className)}),this.props.text)},Object.defineProperty(t.prototype,"_omission",{get:function(){return this.props.omission||"â€¦"},enumerable:!0,configurable:!0}),t.prototype._handleWindowResizeCore=function(){this.update()},Object.defineProperty(t.prototype,"_contentHeight",{get:function(){if(this._textContainerElementRef.current){var e=window.getComputedStyle(this._textContainerElementRef.current),t=0;return e&&e.paddingTop&&e.paddingBottom&&(t=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)),this._textContainerElementRef.current.offsetHeight-t}return 0},enumerable:!0,configurable:!0}),t.prototype._trimAndCalculateLength=function(e,t){var r=this._textArray.length;if(!this._textContainerElementRef.current)return r;var n=1,i=r;do{var o=Math.floor((n+i+1)/2);this._applyTextNumber(o),this._contentHeight>t?i=o-1:n=o}while(n<i);return n},t.prototype._applyTextNumber=function(e){var t=this._textArray.slice(0,e).join("");this._textContainerElementRef.current&&(this._textContainerElementRef.current.textContent=this._textContainerElementRef.current.textContent===t?t:t+this._omission)},t}(a.PureComponent),s=r("q0io");r("CWI6");var l=function(e){function t(t){var r=e.call(this,t)||this;return r._renderEditMode=function(e){return a.createElement(e.TitleInput,Object(n.__assign)({},r.props,{className:r._textClassName}))},r._renderViewMode=function(){return r.props.maxLines?r._renderTitleWithTruncation(r.state.isInMobileView?3:r.props.maxLines):a.createElement("span",{className:r._textClassName,tabIndex:-1,role:"heading","aria-level":1},r.props.title)},r._handleWindowResize=function(){r.state.isInMobileView!==r._isInMobileView&&r.setState({isInMobileView:r._isInMobileView})},r.state={isInMobileView:r._isInMobileView},r}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){window.addEventListener("resize",this._handleWindowResize)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this._handleWindowResize)},t.prototype.render=function(){return a.createElement(s.a,{editMode:this.props.editMode,renderEditMode:this._renderEditMode,renderViewMode:this._renderViewMode})},t.prototype._renderTitleWithTruncation=function(e){var r=Object(i.mergeStyles)(this._textClassName,function(e,t){void 0===t&&(t=1.35);var r=void 0;if("number"==typeof t)r=e*t+"em";else try{var n=e*Number(t.substr(0,t.length-2));if(isNaN(n))throw"Invalid line height input";r=n+"px"}catch(e){throw new e("Invalid line-height input format")}return{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":e.toString(),boxSizing:"content-box",maxHeight:r,textOverflow:1===e?"ellipsis":void 0}}(e));return t._shouldUseCssClamp?a.createElement("div",{className:r,role:"heading","aria-level":1,title:this.props.title},this.props.title):a.createElement(c,{className:this._textClassName,text:this.props.title,lines:e,autoShowTitle:!0,role:"heading","aria-level":1,"data-alignment":this.props.alignment.toString()})},Object.defineProperty(t.prototype,"_textClassName",{get:function(){return Object(i.mergeStyles)(this.props.className,"Center"===this.props.alignment&&"im_ap_9f38462c","lm_ap_9f38462c",this.props.isFluent&&"ce_ap_9f38462c")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_isInMobileView",{get:function(){return window.innerWidth<640},enumerable:!0,configurable:!0}),t._shouldUseCssClamp=o._BrowserDetection.getBrowserInformation().browser!==o._Browser.IE,t}(a.PureComponent)},"/l6g":function(e,t,r){"use strict";r.d(t,"q",function(){return o}),r.d(t,"f",function(){return a}),r.d(t,"e",function(){return c}),r.d(t,"l",function(){return s}),r.d(t,"d",function(){return l}),r.d(t,"i",function(){return u}),r.d(t,"m",function(){return d}),r.d(t,"a",function(){return p}),r.d(t,"p",function(){return f}),r.d(t,"h",function(){return h}),r.d(t,"o",function(){return _}),r.d(t,"b",function(){return g}),r.d(t,"r",function(){return m}),r.d(t,"j",function(){return b}),r.d(t,"c",function(){return v}),r.d(t,"k",function(){return y}),r.d(t,"g",function(){return w}),r.d(t,"n",function(){return P});var n=r("UWqr"),i=r("hiL/"),o=new i.KillSwitch("7e3ee066-0e56-4b8a-9b1e-94e15d634e90"),a=new i.KillSwitch("6d689ad3-2665-452b-a572-6aa2aaebd684"),c=new i.KillSwitch("74963ef8-0f5c-4134-8b2b-2ce0f481468c"),s=new i.KillSwitch("2ee11e2e-1654-49f9-bc0d-2fd8e472cb8c"),l=new i.KillSwitch("6fb63729-6696-4387-bd99-cc6f7102c014"),u=new i.KillSwitch("9e1834cf-21fa-4e0f-baf6-9d8bae6d017f");function d(){return n._SPKillSwitch.isActivated("5cbbf416-ac6e-43b7-bd80-71d7f74c3571")}var p=function(){return!n._SPKillSwitch.isActivated("6f27a5c3-f19a-4fb5-85a1-56fde3950939")},f=function(){return!n._SPKillSwitch.isActivated("fa258167-7f4d-49c6-9db0-afff16478935")},h=function(){return n._SPKillSwitch.isActivated("39c43778-2d04-403c-8eb0-0832a1d581d9")},_=function(){return n._SPKillSwitch.isActivated("446a3fce-0920-499b-bb0a-0aaf6975eadb")},g=function(){return n._SPKillSwitch.isActivated("1c1a692e-f1c3-4ef9-90f2-1fae1ae8b94a")},m=function(){return n._SPKillSwitch.isActivated("1ea597c4-f384-4694-94b6-7d07c743c457")},b=function(){return n._SPKillSwitch.isActivated("32a9413e-c0c4-4519-8dee-014a7f3989f2")};function v(){return n._SPKillSwitch.isActivated("d4774c7d-f72f-4507-ad44-25fc54ad17f7")}function y(){return n._SPKillSwitch.isActivated("0ad94947-baae-45f8-9801-a5fc71ca2823")}function w(){return n._SPKillSwitch.isActivated("f7976625-1ce2-46b3-8425-f0f8dfd0e38a")}var P=function(){return n._SPKillSwitch.isActivated("ef1ae887-4739-45a4-919a-a61b9df6b0c8")}},"17wl":function(t,r){t.exports=e},"2q6Q":function(e,r){e.exports=t},"4qZb":function(e,t,r){var n=r("iLQm"),i=r("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var o=0;o<n.length;o++)i.loadStyles(n[o][1],!0);n.locals&&(e.exports=n.locals)},"4qiQ":function(e,t,r){(e.exports=r("5ADk")(!1)).push([e.i,".iz_x_9f38462c{width:100%;box-sizing:border-box}.ik_x_9f38462c .iz_x_9f38462c{visibility:hidden}.ja_x_9f38462c{height:100%;box-sizing:border-box;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.ja_x_9f38462c.jb_x_9f38462c{margin-left:auto;margin-right:auto}@media screen and (max-width:639.99999px) and (min-width:480px){[dir=ltr] .iz_x_9f38462c{padding-left:28px}[dir=ltr] .iz_x_9f38462c,[dir=rtl] .iz_x_9f38462c{padding-right:28px}[dir=rtl] .iz_x_9f38462c{padding-left:28px}.iz_x_9f38462c>.ja_x_9f38462c{max-width:100%}}@media screen and (max-width:479.99999px) and (min-width:320px){[dir=ltr] .iz_x_9f38462c{padding-left:20px}[dir=ltr] .iz_x_9f38462c,[dir=rtl] .iz_x_9f38462c{padding-right:20px}[dir=rtl] .iz_x_9f38462c{padding-left:20px}.iz_x_9f38462c>.ja_x_9f38462c{max-width:100%}}@media screen and (min-width:640px){[dir=ltr] :not(.withVerticalSection) .iz_x_9f38462c{padding-left:32px}[dir=rtl] :not(.withVerticalSection) .iz_x_9f38462c{padding-right:32px}[dir=ltr] :not(.withVerticalSection) .iz_x_9f38462c{padding-right:24px}[dir=rtl] :not(.withVerticalSection) .iz_x_9f38462c{padding-left:24px}:not(.withVerticalSection) .iz_x_9f38462c>.ja_x_9f38462c{max-width:1212px}[dir=ltr] :not(.withVerticalSection) .iz_x_9f38462c.gw_x_9f38462c{padding-left:56px}[dir=rtl] :not(.withVerticalSection) .iz_x_9f38462c.gw_x_9f38462c{padding-right:56px}[dir=ltr] :not(.withVerticalSection) .iz_x_9f38462c.gw_x_9f38462c{padding-right:32px}[dir=rtl] :not(.withVerticalSection) .iz_x_9f38462c.gw_x_9f38462c{padding-left:32px}:not(.withVerticalSection) .iz_x_9f38462c.gw_x_9f38462c>.ja_x_9f38462c{max-width:1180px}[dir=ltr] .withVerticalSection .iz_x_9f38462c{padding-left:32px}[dir=rtl] .withVerticalSection .iz_x_9f38462c{padding-right:32px}[dir=ltr] .withVerticalSection .iz_x_9f38462c{padding-right:24px}[dir=rtl] .withVerticalSection .iz_x_9f38462c{padding-left:24px}.withVerticalSection .iz_x_9f38462c>.ja_x_9f38462c{max-width:1584px}[dir=ltr] .withVerticalSection .iz_x_9f38462c.gw_x_9f38462c{padding-left:56px}[dir=rtl] .withVerticalSection .iz_x_9f38462c.gw_x_9f38462c{padding-right:56px}[dir=ltr] .withVerticalSection .iz_x_9f38462c.gw_x_9f38462c{padding-right:32px}[dir=rtl] .withVerticalSection .iz_x_9f38462c.gw_x_9f38462c{padding-left:32px}.withVerticalSection .iz_x_9f38462c.gw_x_9f38462c>.ja_x_9f38462c{max-width:1528px}}",""])},"4xiJ":function(e,t,r){var n=r("OL2s"),i=r("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var o=0;o<n.length;o++)i.loadStyles(n[o][1],!0);n.locals&&(e.exports=n.locals)},"52W1":function(e,t,r){(e.exports=r("5ADk")(!1)).push([e.i,".a_a_658c9e0a{word-wrap:break-word!important}",""])},"5ADk":function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r=function(e,t){var r,n,i,o=e[1]||"",a=e[3];if(!a)return o;if(t&&"function"==typeof btoa){var c=(r=a,n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),"/*# ".concat(i," */")),s=a.sources.map(function(e){return"/*# sourceURL=".concat(a.sourceRoot).concat(e," */")});return[o].concat(s).concat([c]).join("\n")}return[o].join("\n")}(t,e);return t[2]?"@media ".concat(t[2],"{").concat(r,"}"):r}).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},i=0;i<this.length;i++){var o=this[i][0];null!=o&&(n[o]=!0)}for(var a=0;a<e.length;a++){var c=e[a];null!=c[0]&&n[c[0]]||(r&&!c[2]?c[2]=r:r&&(c[2]="(".concat(c[2],") and (").concat(r,")")),t.push(c))}},t}},"5z2F":function(e,t){e.exports=r},"6ddY":function(e,t,r){(e.exports=r("5ADk")(!1)).push([e.i,".a_a_434b99a9{cursor:pointer}.a_a_434b99a9:hover{outline:0}",""])},"75MU":function(e,t,r){"use strict";r.d(t,"a",function(){return V});var n=r("17wl"),i=r("KL1q"),o=r("ut3N"),a=r("8dK2"),c=r("X+PM"),s=r("hiL/"),l=r("cDcd"),u=r("faye"),d=r("UWqr"),p=r("2q6Q"),f=function(){function e(){}return e.isAFDPrivateCDNURLParsingKsActivated=function(){return d._SPKillSwitch.isActivated("79790285-358d-43ca-925d-ba0a42287e67")},e}();function h(){return d._SPKillSwitch.isActivated("d90f453c-fa57-47ca-bfa4-236ad93d4b23")}var _=function(){function e(){}return e.tryConsumePreAllocatedImageTag=function(t){var r,n=null===(r=e._preAllocatedImages)||void 0===r?void 0:r[t];return n&&!n.isConsumed?(n.isConsumed=!0,n):void 0},Object.defineProperty(e,"_preAllocatedImages",{get:function(){return window._preAllocatedImageTags},enumerable:!0,configurable:!0}),e}(),g=["vroom","docViz","vroomCrossGeo","staticImage","external","cdn"],m=o._LogSource.create("UseImageFallback"),b=[],v=!1;function y(e){var t=l.useState(void 0),r=t[0],i=t[1],c=l.useRef(void 0),u=l.useRef([]),p=l.useRef(e.services),f=function(t){(function(e,t){var r,i,a;return Object(n.__awaiter)(this,void 0,void 0,function(){var c,s,l,u,p,f,h,_,g,y,w;return Object(n.__generator)(this,function(n){switch(n.label){case 0:if(c=t?t.serviceName:void 0,s=[],e.forEach(function(e,t){c?c===t&&(c=void 0):s.push([t,e])}),!d._SPKillSwitch.isActivated("6e1eb8f9-afee-4540-b1ea-b806873475f8")&&(l=window._preloadMetadata)&&!v)for(u in v=!0,l)u&&(l[u].isPreLoaded=!0,b[u]=l[u]);p=0,f=s,n.label=1;case 1:if(!(p<f.length))return[3,6];h=f[p],_=h[0],g=h[1],n.label=2;case 2:return n.trys.push([2,4,,5]),[4,g()];case 3:return y=n.sent(),"cdn"===_&&-1!==(null===(r=y)||void 0===r?void 0:r.indexOf("AuthVer"))&&-1===(null===(i=y)||void 0===i?void 0:i.indexOf("_eat_"))?[2,{serviceName:_,src:y,httpRequest:void 0,duration:0,loadingError:{error:"Unexpected CDN request without auth token"},isPreLoaded:!1}]:y&&y!==(null===(a=t)||void 0===a?void 0:a.src)?[2,P(_,y)]:[3,5];case 4:return w=n.sent(),o._TraceLogger.logError(m,w,"getValidNextState"),[3,5];case 5:return p++,[3,1];case 6:return[2,void 0]}})})})(h()?e.services:p.current,t).then(function(e){i(e),e&&u.current.push(e.serviceName)}).catch(function(){return i(void 0)})};if(l.useEffect(function(){h()||(p.current=e.getServices()),f(void 0),c.current=new o._QosMonitor("ImageElementRender."+e.callerId)},[e.thumbnailWidth&&a._PreviewUtility.normalizeWidth(e.thumbnailWidth),e.imageData.imageUrl,e.imageData.uniqueId,e.imageData.webId,e.imageData.listId,e.imageData.cropData]),!r)return{};var _=r.serviceName,y=r.src,x=r.httpRequest,S=r.isPreLoaded,E=a._ThumbnailUrlGenerator.getThumbnailProvider(y,s.DefaultImageHelper.isStockImage(e.imageData.imageUrl)),C=a._ThumbnailUrlGenerator.getThumbnailWidth(y,E),L=a._ThumbnailProviderType[E],T=new o._QosMonitor("ImageElementRenderService."+L),j=!d._SPKillSwitch.isActivated("1e63000a-b1fe-482c-82c2-35c3f3d04786"),R=!d._SPKillSwitch.isActivated("d886341c-7003-4b36-92fc-5980fac1caeb"),O=new Date;return{src:y,onLoad:function(t){var n,i,o,l,p=(null===(n=x)||void 0===n?void 0:n.status)||w(t);null===(o=(i=e).onImageLoad)||void 0===o||o.call(i,t,_),function(e,t,r,n,i,o,a,c,s){var l,u=e.serviceName,p=e.src,f=e.httpRequest,h=e.duration,_=e.isPreLoaded,g={service:u,alias:a,duration:h,statusCode:c,isPreLoaded:_,flights:I(_)};if(t&&(s&&(g.width=s),o&&(g.fallbacks=o.length)),t&&f){var m=f.getResponseHeader("sprequestguid");if(m&&(g.CorrelationId=m),"cdn"===u){var b=f.getResponseHeader("x-cache");b&&("TCP_MISS"!==(b=b.split(" ")[0])||d._SPKillSwitch.isActivated("8fabcf78-41ae-4fa4-8642-0230b918d3f7")||(b="TCP_MISS"===(b=(null===(l=f.getResponseHeader("x-cache-remote"))||void 0===l?void 0:l.split(" ")[0])||b)?b:b+"_REMOTE"),g.CDNCache=b),p.indexOf("/_vti_bin/afdcache.ashx/")>-1&&(g.cacheCountryCode=f.getResponseHeader("x-ccc"))}var v=!d._SPKillSwitch.isActivated("9fad0c2c-a2a6-43bd-9354-1680d859c257");if(("cdn"===u||"vroom"===u)&&v){var y=f.getResponseHeader("x-cache-origin");y&&(g.OriginCache=y)}if(f.response&&(g.size=f.response.size,g.source=f.response.type),r){var w=f.getResponseHeader("date");if(w){var P=new Date(w),x=i.getTime()-P.getTime();g.responseStatus=x>=2500||x>-500&&h<=10?h<=1?"memoryCacheHit":"coldCacheHit":"cacheMiss"}}}n.writeSuccess(g)}(r,j,R,T,O,u.current,e.callerId,p,C);var f=!d._SPKillSwitch.isActivated("d936d1f1-b1a5-4ec6-9d69-b016fb2eabf8"),h={isPreLoaded:S,fallbacks:u.current.length,width:C,service:_,statusCode:p,flights:I(S)};if((null===(l=x)||void 0===l?void 0:l.response)&&(h.size=x.response.size,h.source=x.response.type),c.current)if(f?1===u.current.length:-1!==g.indexOf(_))c.current.writeSuccess(h);else{var m=!d._SPKillSwitch.isActivated("9cced250-fcf4-47d2-b70a-cf7d3685b475"),b=_+" passed",v=m&&1===u.current.length?new Error("Directly loaded full Url: <url>"+Object(s.scrubUrl)(E,y)+"</url>"):new Error("Fallback order: "+u.current.join("->")),P=f&&y?a._PreviewUtility.getFileExtension(new a._SPResourcePath(y)):void 0;"fullImage"===_&&"gif"!==P?c.current.writeUnexpectedFailure(b,v,h):c.current.writeExpectedFailure(b,v,h)}},onError:function(t){var n,i;null===(i=(n=e).onImageLoadFailure)||void 0===i||i.call(n,_,t),function(e,t,r,n,i,o,a,c){var l,u,p,f,h,_=e.serviceName,g=e.src,m=e.duration,b=e.loadingError,v=(null===(l=b)||void 0===l?void 0:l.statusCode)?null===(u=b)||void 0===u?void 0:u.statusCode:w(o),y=d._SPKillSwitch.isActivated("33cf19e5-bc93-4d1c-830a-c89ab8941e1b"),P=new Error("<url>"+Object(s.scrubUrl)(a,g)+"</url> <statusCode>"+v+"</statusCode> Error:"+(null===(p=b)||void 0===p?void 0:p.error)),x={alias:c,statusCode:v};if(t&&m>0&&(x.duration=m),t&&(null===(f=b)||void 0===f?void 0:f.httpRequest)){var S=b.httpRequest.getResponseHeader("sprequestguid"),I=b.httpRequest.getAllResponseHeaders();S&&(x.CorrelationId=S),I&&(x.headers=I)}y||function(e){return void 0===e||!(e<=399)&&(e>=500?503!==e:401!==e&&403!==e&&404!==e&&429!==e)}(v)?r.writeUnexpectedFailure(_+" failed",P,x):r.writeExpectedFailure(_+" failed",P,x),"stockImage"===_&&(null===(h=n.current)||void 0===h||h.writeUnexpectedFailure("stock failed",new Error("services failed: "+i.current.join("->"))))}(r,j,T,c,u,t,E,e.callerId),f(r)}}}function w(e){if(e){var t=e.currentTarget;return Boolean(t.src&&t.src.indexOf("encodeFailures=1")>=0)&&1===t.naturalWidth&&t.naturalHeight>6e4?t.naturalHeight-6e4:void 0}}function P(e,t){var r,i,c;return Object(n.__awaiter)(this,void 0,void 0,function(){var s,l,u,p,f,h,_,g,v,y,w,P,I;return Object(n.__generator)(this,function(n){switch(n.label){case 0:if(s=d._SPKillSwitch.isActivated("bdcb9adb-bb78-4a25-a64f-9abcf7afbfc0"),p=-1,!d._SPFlight.isEnabled(1866))return[3,11];f=new a._SPResourcePath(t),h="cdn"===e&&(x(f)||S(f)),_={},p=performance.now(),h&&(t=function(e,t){var r=[],n=new a._SPResourcePath(e);return S(n)&&(r.push("P1"),r.push("P2"),r.push("P3"),r.push("P4")),x(n)&&(r.push("_eat_"),r.push("_oat_")),r.forEach(function(e){var r=n.getQueryParameter(e);if(r){if(n.removeQueryParameter(e),d._SPFlight.isEnabled(60041))switch(e){case"P1":e="X-MSEdge-TluExpiration";break;case"P2":e="X-MSEdge-TluKeyNumber";break;case"P3":e="X-MSEdge-TluAlgorithmId";break;case"P4":e="X-MSEdge-TluSignature"}t[e]=r}}),n.toString()}(t,_)),n.label=1;case 1:return n.trys.push([1,9,,10]),!s&&b[t]?[3,3]:(g=function e(t,r){return new Promise(function(n,i){var o=new XMLHttpRequest;for(var a in o.open("GET",t),r)r.hasOwnProperty(a)&&o.setRequestHeader(a,r[a]);o.responseType="blob",o.onload=function(){if(o.status>=200&&o.status<300&&o.response)return n(o);var t=o.getResponseHeader("location");t&&o.status>=300&&o.status<400?e(t).then(n).catch(i):i({httpRequest:o,statusCode:o.status,error:"Request Failed"})},o.onerror=function(){return i({httpRequest:o,statusCode:void 0,error:"Network Failed"})},o.send()})}(t,_),s||(b[t]=g),[4,g]);case 2:return u=n.sent(),s?[3,8]:(b[t]={httpRequest:u,duration:performance.now()-p,isPreLoaded:!1},h&&(null===(r=u)||void 0===r?void 0:r.response)&&(b[t].blobUrl=URL.createObjectURL(u.response)),[2,{serviceName:e,src:b[t].blobUrl||t,httpRequest:u,duration:b[t].duration,loadingError:l,isPreLoaded:b[t].isPreLoaded}]);case 3:return s||!b[t]?[3,8]:(v=b[t],Promise.resolve(v)!==v?[3,5]:[4,v]);case 4:n.sent(),n.label=5;case 5:return(y=b[t]).httpRequest.readyState<4?(w=y.duration,[4,new Promise(function(e,t){y.httpRequest.onloadend=function(){y.duration=performance.now()-w,y.httpRequest.status&&y.httpRequest.status<400?e(y.httpRequest):t(y.httpRequest)}})]):[3,7];case 6:n.sent(),n.label=7;case 7:return!(P=!!function(e){var t,r,n;return null===(n=null===(r=null===(t=window._preAllocatedImageTags)||void 0===t?void 0:t[e])||void 0===r?void 0:r.imageElement)||void 0===n?void 0:n.src}(t))&&h&&!y.blobUrl&&(null===(i=y.httpRequest)||void 0===i?void 0:i.response)&&(y.blobUrl=URL.createObjectURL(null===(c=y.httpRequest)||void 0===c?void 0:c.response)),[2,{serviceName:e,src:!P&&y.blobUrl||t,httpRequest:y.httpRequest,duration:y.duration,loadingError:l,isPreLoaded:y.isPreLoaded}];case 8:return[3,10];case 9:return I=n.sent(),o._TraceLogger.logError(m,I,"_generateStateFromSrc"),l=I,[3,10];case 10:p=performance.now()-p,n.label=11;case 11:return[2,{serviceName:e,src:t,httpRequest:u,duration:p,loadingError:l,isPreLoaded:!1}]}})})}function x(e){return d._SPFlight.isEnabled(1994)&&"2"===e.getQueryParameter("AuthVer")}function S(e){return d._SPFlight.isEnabled(60041)&&void 0!==e.getQueryParameter("_oat_")&&void 0!==e.getQueryParameter("P1")&&void 0!==e.getQueryParameter("P4")}function I(e){if(!d._SPKillSwitch.isActivated("e83bad45-afe1-427f-a4a5-b000e7d5aea1"))return e?E(p._PerformanceExperiment.WEXImagePreAllocate)+","+E(p._PerformanceExperiment.WEXTitleRegionCroppingExperiment):E(p._PerformanceExperiment.WEXTitleRegionCroppingExperiment)}function E(e){return e+"_"+p._PerformanceLogger.getExperimentStatusString(p._SPPerfExperiment.getExperimentStatus(p._SPPerfExperiment.getVariantAndTrackExperiment(e)))}var C=r("y88i"),L=r("kgWS"),T=r("vlQI"),j=/(\/thumbnails\/\d\/(.*?))\/content.*$/i,R=new Map;function O(e,t,r){if(!e)return!1;if((r=r||a._ThumbnailUrlGenerator.getThumbnailProvider(e))===a._ThumbnailProviderType.VROOMMeTACache){var n=t.consume(c.PageContext.serviceKey),i=new C.Uri(e),o=new C.Uri(n.web.absoluteUrl);if(!R.has(e)){for(var s=n.legacyPageContext.multiGeoInfo,l=!1,u=0;u<s.length;u++){var d=new C.Uri(s[u].PortalUrl),p=new C.Uri(s[u].MySiteHostUrl);if(i.getHost()===d.getHost()||i.getHost()===p.getHost()){l=!0;break}}R.set(e,l)}return Boolean(R.get(e)&&i.getHost()!==o.getHost())}return!1}function U(e,t){if(!e)return Promise.resolve(void 0);var r=new C.Uri(e).getLeftPart(1),n=new T.AadHttpClient(t,r,{configuration:T._AadTokenProviders.preAuthorizedConfiguration}),i=new Headers;i.append("accept","application/json; odata.metadata=minimal"),i.append("odata-version","4.0");var a=new o._QosMonitor("CrossGeoThumbnail.getCrossGeoThumbnailUrl");return n.get(e.replace(j,"$1"),T.AadHttpClient.configurations.v1,{headers:i}).then(function(e){if(e.status>=200&&e.status<300)return e.json();throw new Error(JSON.stringify(e))}).then(function(e){return a.writeSuccess(),e.url}).catch(function(e){throw a.writeUnexpectedFailure("FailedToGet",e),e})}var D=o._LogSource.create("ImageFallbackHelper");function A(e){var t=this,r=new Map,i=function(e){var t=e.imageData,r=t.cropData,n=t.imageNaturalHeight,i=t.imageNaturalWidth,o=t.imageUrl,s=t.listId,l=t.siteId,u=t.uniqueId,d=t.webId,p=t.cropMode;if(o){var f=a._PreviewUtility.getFileExtension(new a._SPResourcePath(o)),h={absoluteUrl:e.serviceScope&&e.serviceScope.consume(c.PageContext.serviceKey).web.absoluteUrl,callerId:e.callerId,fileType:f,height:e.thumbnailHeight,listId:s,originalHeight:n,originalWidth:i,siteId:l,spResource:o,uniqueId:u,webId:d,width:e.thumbnailWidth,cropMode:p};return r&&function(e){var t=e.cropData;return void 0!==t&&t.x>=0&&t.y>=0&&t.width>0&&t.height>0&&!function(e){var t=e.cropData,r=e.imageNaturalHeight,n=e.imageNaturalWidth;return void 0!==t&&0===t.x&&0===t.y&&t.width>0&&t.height>0&&t.width===n&&t.height===r}(e)}(e.imageData)&&(h.viewportLeft=r.x,h.viewportTop=r.y,h.viewportWidth=r.width,h.viewportHeight=r.height),h}}(e);if(!i)return r;var l=i.spResource?s.DefaultImageHelper.getDefaultImage(new a._SPResourcePath(i.spResource),i.width):void 0,u=a._ThumbnailUrlGenerator.getThumbnailUrl(i,l)||"",p=a._ThumbnailUrlGenerator.getThumbnailProvider(u),h=!d._SPKillSwitch.isActivated("d2787edc-5431-41f3-9a65-dd4a27e48642");return p===a._ThumbnailProviderType.PublicCDN||p===a._ThumbnailProviderType.PrivateCDN||!f.isAFDPrivateCDNURLParsingKsActivated()&&p===a._ThumbnailProviderType.AFDPrivateCDN?(r.set("cdn",function(){return Promise.resolve(u)}),h?r.set("vroom",function(){return Object(n.__awaiter)(t,void 0,void 0,function(){var t;return Object(n.__generator)(this,function(r){return O(t=a._ThumbnailUrlGenerator.getVROOMThumbnailUrl(i),e.serviceScope,a._ThumbnailProviderType.VROOMMeTACache)?[2,U(t,e.serviceScope)]:[2,t]})})}):(r.set("vroom",function(){return Promise.resolve(a._ThumbnailUrlGenerator.getVROOMThumbnailUrl(i))}),r.set("vroomCrossGeo",function(){return Object(n.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return t=void 0,[4,r.get("vroom")()];case 1:return O(i=n.sent(),e.serviceScope)&&(t=U(i,e.serviceScope)),[2,t]}})})})),r.set("docViz",function(){return Promise.resolve(a._ThumbnailUrlGenerator.getDocVizUrl(i))}),r.set("fullImage",function(){return Promise.resolve(M(u,i))}),r.set("stockImage",function(){return Promise.resolve(L)})):p===a._ThumbnailProviderType.VROOMMeTACache?(h?r.set("vroom",function(){return O(u,e.serviceScope,a._ThumbnailProviderType.VROOMMeTACache)?Promise.resolve(U(u,e.serviceScope)):Promise.resolve(u)}):(r.set("vroom",function(){return Promise.resolve(u)}),r.set("vroomCrossGeo",function(){var t=void 0;return O(u,e.serviceScope)&&(t=U(u,e.serviceScope)),t||Promise.resolve(void 0)})),r.set("docViz",function(){return Promise.resolve(a._ThumbnailUrlGenerator.getDocVizUrl(i))}),r.set("fullImage",function(){return Promise.resolve(M(u,i))}),r.set("stockImage",function(){return Promise.resolve(L)})):p===a._ThumbnailProviderType.DocViz?(r.set("docViz",function(){return Promise.resolve(u)}),r.set("fullImage",function(){return Promise.resolve(M(u,i))}),r.set("stockImage",function(){return Promise.resolve(L)})):p===a._ThumbnailProviderType.Stock||p===a._ThumbnailProviderType.PublicCDNDefault?(r.set("staticImage",function(){return Promise.resolve(u)}),r.set("stockImage",function(){return Promise.resolve(L)})):p===a._ThumbnailProviderType.External?(r.set("external",function(){return Promise.resolve(u)}),r.set("stockImage",function(){return Promise.resolve(L)})):(o._TraceLogger.logError(D,new Error("_ThumbnailUrlGenerator is providing an unexpected type of url")),r.set("fullImage",function(){return Promise.resolve(u)}),r.set("stockImage",function(){return Promise.resolve(L)})),r}function M(e,t){if(e!==t.spResource&&t.spResource){var r=a._ThumbnailUrlGenerator.getThumbnailProvider(t.spResource),n=t.spResource;if(r===a._ThumbnailProviderType.PublicCDN||r===a._ThumbnailProviderType.PrivateCDN||!f.isAFDPrivateCDNURLParsingKsActivated()&&r===a._ThumbnailProviderType.AFDPrivateCDN)n="https://"+new C.Uri(t.spResource).getPathSegments().join("/");else if(r===a._ThumbnailProviderType.DocViz&&-1!==t.spResource.indexOf("path=")){var i=new C.Uri(t.spResource);n=t.spResource.split("/_layouts/15/getPreview.aspx")[0]+i.getQueryParameter("path")}else r!==a._ThumbnailProviderType.SharePointHost&&r!==a._ThumbnailProviderType.MySite||(n=a._ThumbnailUrlGenerator.updateThumbnailWidth(n,t.width||a._PreviewUtility.smallestBreakPointWidth));return n}}var N=l.forwardRef(function(e,t){var r=e.callerId,i=e.cdnBaseUrls,o=e.imageData,a=e.onImageLoad,c=e.onImageLoadFailure,s=e.serviceScope,u=e.thumbnailWidth,p=e.thumbnailHeight,f=Object(n.__rest)(e,["callerId","cdnBaseUrls","imageData","onImageLoad","onImageLoadFailure","serviceScope","thumbnailWidth","thumbnailHeight"]),_={callerId:r,cdnBaseUrls:i,imageData:o,serviceScope:s,thumbnailWidth:u,thumbnailHeight:d._SPFlight.isEnabled(630)&&d._SPExperiment.getVariantAndLogExposure(90070)>0?p:void 0},g=y({onImageLoad:a,onImageLoadFailure:c,imageData:o,callerId:r,thumbnailWidth:u,services:h()?A(_):void 0,getServices:function(){return A(_)}});return(d._SPFlight.isEnabled(60041)||d._SPFlight.isEnabled(1994))&&l.useEffect(function(){return function(){var e;(null===(e=g.src)||void 0===e?void 0:e.startsWith("blob:"))&&URL.revokeObjectURL(g.src)}},[]),l.createElement("img",Object(n.__assign)({ref:t},f,g))});function F(e,t){return Object(n.__assign)(Object(n.__assign)({},e),{target:t,currentTarget:t,nativeEvent:e,isDefaultPrevented:function(){return!1},isPropagationStopped:function(){return!1},persist:function(){}})}var k={display:"none"};function z(e){if(!e.src)return null;var t=e.imgTagFallbackOptions,r=e.objectFit,o=Object(n.__rest)(e,["imgTagFallbackOptions","objectFit"]),a=l.createRef(),c=l.createRef(),s=l.createRef(),u=l.useMemo(function(){return e.src?_.tryConsumePreAllocatedImageTag(e.src):void 0},[e.src]);l.useLayoutEffect(function(){var n,i,o,l,d,p=c.current;if(a.current&&p&&u){var f=u.imageElement,h=u.loadEvent;if(p.getAttributeNames)p.getAttributeNames().forEach(function(e){f.setAttribute(e,p.getAttribute(e))});else if(p.hasAttributes())for(var _=p.attributes,g=0;g<_.length;g++)f.setAttribute(_[g].name,_[g].value);r&&(f.style.objectFit=r);var m=function(t){var r,n;return null===(n=(r=e).onLoad)||void 0===n?void 0:n.call(r,F(t,f))};f.parentElement||(a.current.appendChild(f),null===(o=null===(n=t)||void 0===n?void 0:(i=n).imgRef)||void 0===o||o.call(i,f),h?m(h):(f.onload=m,f.onerror=function(t){var r,n;return null===(n=(r=e).onError)||void 0===n?void 0:n.call(r,F(t,f))}))}else s.current&&t&&(null===(d=(l=t).imgRef)||void 0===d||d.call(l,s.current))}),(d._SPFlight.isEnabled(60041)||d._SPFlight.isEnabled(1994))&&l.useEffect(function(){return function(){var t;(null===(t=e.src)||void 0===t?void 0:t.startsWith("blob:"))&&URL.revokeObjectURL(e.src)}},[]);var p=Object(i.getNativeElementProps)("img",o,["src","onLoad","onError"]);return u?l.createElement("div",{role:"presentation"},l.createElement("div",{ref:a,role:"presentation"}),l.createElement("div",{style:k,"aria-hidden":"true"},l.createElement("img",Object(n.__assign)({ref:c},p)))):e.imgTagFallbackOptions?l.createElement("img",Object(n.__assign)({},o,{ref:s})):l.createElement(i.Image,Object(n.__assign)({},o))}var q=function(e){var t=e.callerId,r=e.cdnBaseUrls,i=e.imageData,o=e.onImageLoad,a=e.onImageLoadFailure,c=e.serviceScope,s=e.thumbnailWidth,u=e.thumbnailHeight,f=e.renderedInDetachedDOM,_=e.imgRef,g=Object(n.__rest)(e,["callerId","cdnBaseUrls","imageData","onImageLoad","onImageLoadFailure","serviceScope","thumbnailWidth","thumbnailHeight","renderedInDetachedDOM","imgRef"]),m={callerId:t,cdnBaseUrls:r,imageData:i,serviceScope:c,thumbnailWidth:s,thumbnailHeight:u},b=y({onImageLoad:o,onImageLoadFailure:a,imageData:i,callerId:t,thumbnailWidth:s,services:h()?A(m):void 0,getServices:function(){return A(m)}}),v=l.useCallback(function(e){var t;return null===(t=_)||void 0===t?void 0:t(e)},[_]);return(d._SPFlight.isEnabled(60041)||d._SPFlight.isEnabled(1994))&&l.useEffect(function(){return function(){var e;(null===(e=b.src)||void 0===e?void 0:e.startsWith("blob:"))&&URL.revokeObjectURL(b.src)}},[]),0===p._SPPerfExperiment.getVariantAndTrackExperiment(p._PerformanceExperiment.WEXImagePreAllocate,!0)||f?l.createElement("img",Object(n.__assign)({},g,b,{ref:v})):l.createElement(z,Object(n.__assign)({imgTagFallbackOptions:{imgRef:_}},g,b))},H=function(){function e(){}return e.loadImage=function(e){return new Promise(function(t,r){var n=document.createElement("img");n.onload=function(e){t(n)},n.onerror=function(e){r(e)},n.setAttribute("src",e)})},e.readImageRatio=function(t){return Object(n.__awaiter)(this,void 0,void 0,function(){var r;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return[4,e.loadImage(t)];case 1:return[2,(r=n.sent()).naturalWidth/r.naturalHeight]}})})},e.loadThumbnailImage=function(e){return new Promise(function(t,r){var i=document.createElement("div");u.render(l.createElement(d._SPKillSwitch.isActivated("a760cc7c-353a-4a88-9e39-3e99ee22ca86")?N:q,Object(n.__assign)(Object(n.__assign)({},e),{onImageLoad:function(e){t(e.target),u.unmountComponentAtNode(i)},onImageLoadFailure:function(e,t){"stockImage"===e&&(r(e),u.unmountComponentAtNode(i))},renderedInDetachedDOM:!0})),i)})},e.readThumbnailImageRatio=function(t){return Object(n.__awaiter)(this,void 0,void 0,function(){var r;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return[4,e.loadThumbnailImage(t)];case 1:return[2,(r=n.sent()).naturalWidth/r.naturalHeight]}})})},e}(),B=r("P/oh"),W=r("/l6g"),V=function(){function e(e){var t=this;this.getFullSizeUrl=function(e){var r,n,i,o;if("SharePointImage"===e.image.type){var c=e.image,l=new a._SPResourcePath(c.source);return a._ThumbnailUrlGenerator.getThumbnailUrl({absoluteUrl:t._pageContext.web.absoluteUrl,spResource:c.source,siteId:c.siteId&&(null===(r=c.siteId)||void 0===r?void 0:r.toString()),webId:c.webId&&(null===(n=c.webId)||void 0===n?void 0:n.toString()),listId:c.listId&&(null===(i=c.listId)||void 0===i?void 0:i.toString()),uniqueId:c.uniqueId&&(null===(o=c.uniqueId)||void 0===o?void 0:o.toString()),fileType:a._PreviewUtility.getFileExtension(l),width:window.innerWidth,height:void 0,callerId:"titleRegion",cropMode:void 0},s.DefaultImageHelper.getDefaultImage(l,window.innerWidth))}},this._tryImageURL=function(e){return new Promise(function(t,r){var n=new Image;n.onload=function(){return t(e)},n.onerror=function(t){var n=t.error||new Error("Fail to load image "+e);o._TraceLogger.logError(o._LogSource.create("ImageReader"),n),r(n)},n.src=e})},this._pageContext=e.consume(c.PageContext.serviceKey),this._serviceScope=e,this._fileReader=new FileReader}return Object.defineProperty(e,"defaultImage",{get:function(){return Object(i.getTheme)().isInverted?e._darkThemeImage:e._lightThemeImage},enumerable:!0,configurable:!0}),e.convertFocalPointToCropMode=function(e){if(Object(B.c)())return void 0===e?a._CropMode.Fill:0===Math.trunc(e.y)?a._CropMode.Top:100===Math.trunc(e.y)?a._CropMode.Bottom:50===Math.trunc(e.y)?a._CropMode.Fill:void 0},e.prototype.getImageURL=function(t){var r=this;switch(t.image.type){case"DefaultImage":return this._getDefaultImageURL(t.image);case"SharePointImage":return this._getSharePointImageURL(t).catch(function(){return r._getDefaultImageURL(e.defaultImage)});case"LocalImage":return this._getLocalImageURL(t.image);case"ExternalImage":return this._getExternalImageURL(t.image);default:return Promise.reject(new Error("Unexpected image type"))}},e.prototype._getDefaultImageURL=function(t){return this._tryImageURL("Dark"===t.theme?e._defaultImageDark:e._defaultImageLight)},e.prototype._getSharePointImageURL=function(e){var t=this;return this._generateThumbnailUrl(e).catch(function(){return t._trySharePointURL(e.image)}).catch(function(){throw new s.UnexpectedFailure("Failure")})},e.prototype._getLocalImageURL=function(e){var t=this;return new Promise(function(r,n){t._fileReader.onloadend=function(){return r(t._fileReader.result)},t._fileReader.onerror=n,t._fileReader.readAsDataURL(e.file)})},e.prototype._getExternalImageURL=function(e){return this._tryImageURL(e.source)},e.prototype._generateThumbnailUrl=function(t){var r,n,i,o,c=t.image;if(!c)return Promise.reject(new s.UnexpectedFailure("ImageTypeIncorrect"));var l=e.convertFocalPointToCropMode(t.focalPoint),u=void 0!==l&&1===p._SPPerfExperiment.getVariantAndTrackExperiment(p._PerformanceExperiment.WEXTitleRegionCroppingExperiment,!0);return H.loadThumbnailImage({imageData:{imageUrl:c.source,siteId:null===(r=c.siteId)||void 0===r?void 0:r.toString(),webId:null===(n=c.webId)||void 0===n?void 0:n.toString(),listId:null===(i=c.listId)||void 0===i?void 0:i.toString(),uniqueId:null===(o=c.uniqueId)||void 0===o?void 0:o.toString(),cropMode:u?l:void 0},serviceScope:this._serviceScope,thumbnailWidth:window.innerWidth,thumbnailHeight:u?t.requestedHeight:void 0,callerId:"titleRegion"}).then(function(e){return W.i.isActivated()&&s.DefaultImageHelper.isStockImage(new a._SPResourcePath(e.src))?Promise.reject(new s.ExpectedFailure("ServiceNotEnabled")):e.src}).catch(function(){return Promise.reject(new s.ExpectedFailure("ServiceNotEnabled"))})},e.prototype._trySharePointURL=function(e){var t=e.source;return this._tryImageURL(t)},e._darkThemeImage={id:"DefaultImage-Dark",type:"DefaultImage",theme:"Dark"},e._lightThemeImage={id:"DefaultImage-Light",type:"DefaultImage",theme:"Light"},e._defaultImageLight=r("a87W"),e._defaultImageDark=r("mFdQ"),Object(n.__decorate)([Object(s.monitor)("TitleRegion.GetImageURL")],e.prototype,"getImageURL",null),Object(n.__decorate)([Object(s.monitor)("TitleRegion.GetDefaultImageURL")],e.prototype,"_getDefaultImageURL",null),Object(n.__decorate)([Object(s.monitor)("TitleRegion.GetSharePointImageURL")],e.prototype,"_getSharePointImageURL",null),Object(n.__decorate)([Object(s.monitor)("TitleRegion.GetLocalImageURL")],e.prototype,"_getLocalImageURL",null),Object(n.__decorate)([Object(s.monitor)("TitleRegion.GetExternalImageURL")],e.prototype,"_getExternalImageURL",null),Object(n.__decorate)([Object(s.monitor)("TitleRegion.TryMediaService")],e.prototype,"_generateThumbnailUrl",null),Object(n.__decorate)([Object(s.monitor)("TitleRegion.TrySharePointURL")],e.prototype,"_trySharePointURL",null),e}()},"8dK2":function(e,t){e.exports=n},"9eD7":function(e,t,r){(e.exports=r("5ADk")(!1)).push([e.i,'.jc_y_9f38462c{position:relative;height:150px}@media screen and (min-width:640px){.jc_y_9f38462c{height:228px}}@media screen and (min-width:1920px){.jc_y_9f38462c{height:280px}}.jc_y_9f38462c>*{position:absolute;left:0;right:0;top:0;bottom:0}.ja_y_9f38462c{width:100%;position:relative;top:-44px;margin-bottom:-44px}.je_y_9f38462c{position:relative;z-index:2;margin-left:-12px;margin-right:-12px}@media screen and (min-width:480px){.je_y_9f38462c{margin-left:-16px;margin-right:-16px}}@media screen and (min-width:640px){.je_y_9f38462c{margin-left:-20px;margin-right:-20px}}.je_y_9f38462c .jf_y_9f38462c{left:0;right:0;position:absolute;top:-36px}@media screen and (min-width:480px){.je_y_9f38462c .jf_y_9f38462c{top:-44px}}.jg_y_9f38462c{color:"[theme:black, default: #000000]";background:"[theme:white, default: #ffffff]";padding:4px 12px}@media screen and (min-width:480px){.jg_y_9f38462c{padding:8px 16px}}@media screen and (min-width:640px){.jg_y_9f38462c{padding:12px 20px}}.gl_y_9f38462c{margin-top:10px}.jh_y_9f38462c{margin-top:6px}',""])},"9ei3":function(e,t,r){var n=r("A8CG"),i=r("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var o=0;o<n.length;o++)i.loadStyles(n[o][1],!0);n.locals&&(e.exports=n.locals)},A8CG:function(e,t,r){(e.exports=r("5ADk")(!1)).push([e.i,".ja_af_9f38462c{min-height:96px;-ms-flex-pack:end;justify-content:flex-end;padding-top:24px;padding-bottom:12px}.jf_af_9f38462c{margin-bottom:6px}.gl_af_9f38462c{margin-top:10px}.jh_af_9f38462c{margin-top:6px}",""])},CWI6:function(e,t,r){var n=r("nCbH"),i=r("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var o=0;o<n.length;o++)i.loadStyles(n[o][1],!0);n.locals&&(e.exports=n.locals)},D7HB:function(e,t,r){"use strict";r("4xiJ"),t.a={card:"il_w_9f38462c",center:"im_w_9f38462c",leftPlaceholder:"in_w_9f38462c",editMode:"gw_w_9f38462c",focusWithChild:"io_w_9f38462c",deleteButton:"ip_w_9f38462c",holdSpace:"iq_w_9f38462c",primaryText:"ir_w_9f38462c",secondaryText:"is_w_9f38462c",buttons:"it_w_9f38462c",whiteText:"iu_w_9f38462c",themedWhiteText:"iv_w_9f38462c",persona:"iw_w_9f38462c",personaCoin:"ix_w_9f38462c",personaDetails:"iy_w_9f38462c"}},"DM/N":function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r("KL1q"),i=r("cDcd"),o=r("/l6g");r("Re++");function a(e){var t=Object(n.css)("iz_ar_9f38462c","Center"===e.alignment&&"im_ar_9f38462c",e.className);if(e.value.trim()){var r=Object(n.css)("jf_ar_9f38462c",e.isFluent&&"ce_ar_9f38462c",!o.l.isActivated()&&"jj_ar_9f38462c");return i.createElement("div",{className:t,"data-alignment":e.alignment.toString(),"data-automation-id":"topicHeader"},i.createElement("span",{className:r,title:e.value,"data-automation-id":"topicHeaderText"},e.value))}return i.createElement(i.Fragment,null)}},Expv:function(e){e.exports=JSON.parse('{"a":"Title area."}')},GWJ3:function(e,t,r){var n=r("WfYB"),i=r("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var o=0;o<n.length;o++)i.loadStyles(n[o][1],!0);n.locals&&(e.exports=n.locals)},I6O9:function(e,t){e.exports=i},KEhi:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r("17wl"),i=r("cDcd"),o=i.lazy(function(){return r.e(15).then(r.bind(null,"tsi2")).then(function(e){return{default:e.PublishDate}})});function a(e){return i.createElement(i.Suspense,{fallback:!1},i.createElement(o,Object(n.__assign)({},e)))}},KL1q:function(e,t){e.exports=o},LIhD:function(e,t,r){"use strict";function n(e){return e||{x:50,y:50}}r.d(t,"a",function(){return n})},NQze:function(e,t,r){var n=r("s/fY"),i=r("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var o=0;o<n.length;o++)i.loadStyles(n[o][1],!0);n.locals&&(e.exports=n.locals)},OL2s:function(e,t,r){(e.exports=r("5ADk")(!1)).push([e.i,'.il_w_9f38462c{max-width:100%;display:-ms-inline-flexbox;display:inline-flex;border:1px solid transparent;background:0 0;outline:0}.il_w_9f38462c.im_w_9f38462c{text-align:center}.il_w_9f38462c.in_w_9f38462c,[dir=ltr] .il_w_9f38462c.im_w_9f38462c.gw_w_9f38462c{padding-left:32px}[dir=rtl] .il_w_9f38462c.im_w_9f38462c.gw_w_9f38462c{padding-right:32px}.il_w_9f38462c.gw_w_9f38462c:hover,.il_w_9f38462c.io_w_9f38462c:focus-within,.il_w_9f38462c:focus{border-color:"[theme:neutralTertiaryAlt, default: #c8c6c4]";background:"[theme:neutralLighterAlt, default: #faf9f8]"}.il_w_9f38462c.gw_w_9f38462c:hover .ip_w_9f38462c.iq_w_9f38462c,.il_w_9f38462c.io_w_9f38462c:focus-within .ip_w_9f38462c.iq_w_9f38462c,.il_w_9f38462c:focus .ip_w_9f38462c.iq_w_9f38462c{visibility:visible}.il_w_9f38462c.gw_w_9f38462c:hover .ip_w_9f38462c:not(.iq_w_9f38462c),.il_w_9f38462c.io_w_9f38462c:focus-within .ip_w_9f38462c:not(.iq_w_9f38462c),.il_w_9f38462c:focus .ip_w_9f38462c:not(.iq_w_9f38462c){display:block}.il_w_9f38462c.gw_w_9f38462c:hover .ir_w_9f38462c,.il_w_9f38462c.io_w_9f38462c:focus-within .ir_w_9f38462c,.il_w_9f38462c:focus .ir_w_9f38462c{color:"[theme:neutralPrimary, default: #323130]"!important}.il_w_9f38462c.gw_w_9f38462c:hover .is_w_9f38462c,.il_w_9f38462c.io_w_9f38462c:focus-within .is_w_9f38462c,.il_w_9f38462c:focus .is_w_9f38462c{color:"[theme:neutralSecondary, default: #605e5c]"!important}.it_w_9f38462c{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.it_w_9f38462c .ip_w_9f38462c{color:"[theme:black, default: #000000]"}.it_w_9f38462c .ip_w_9f38462c.iq_w_9f38462c{visibility:hidden}.it_w_9f38462c .ip_w_9f38462c:not(.iq_w_9f38462c){display:none}.ir_w_9f38462c{color:"[theme:neutralPrimary, default: #323130]";font-size:14px}.is_w_9f38462c{color:"[theme:neutralSecondary, default: #605e5c]";font-size:12px}.ir_w_9f38462c,.is_w_9f38462c{display:block;overflow:hidden;white-space:nowrap;font-weight:600;text-overflow:ellipsis}@media screen and (min-width:640px){.iu_w_9f38462c .ir_w_9f38462c,.iu_w_9f38462c .is_w_9f38462c{color:#fff}}.iv_w_9f38462c .ir_w_9f38462c,.iv_w_9f38462c .is_w_9f38462c{color:"[theme:white, default: #ffffff]"}.iw_w_9f38462c{display:-ms-inline-flexbox;display:inline-flex;min-width:0;-ms-flex-align:center;align-items:center;height:40px;cursor:pointer}.iw_w_9f38462c:focus{outline:0}.iw_w_9f38462c .ix_w_9f38462c{-ms-flex:0 0 auto;flex:0 0 auto}.iw_w_9f38462c .iy_w_9f38462c{padding:0 12px;min-width:0;width:100%}',""])},OM4a:function(e,t,r){var n=r("52W1"),i=r("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var o=0;o<n.length;o++)i.loadStyles(n[o][1],!0);n.locals&&(e.exports=n.locals)},Ozj5:function(e,t,r){"use strict";r.d(t,"a",function(){return E});var n=r("17wl"),i=r("KL1q"),o=r("ut3N"),a=r("y88i"),c=r("hiL/"),s=r("cDcd"),l=r("q0io"),u=r("UWqr"),d=r("2q6Q");function p(e){return e instanceof Error?e:new Error(e)}var f=function(){function e(e,t,r){this._tagNameSuffix=e,this._innerError=p(t),this._extraData=r}return Object.defineProperty(e.prototype,"tagNameSuffix",{get:function(){return this._tagNameSuffix},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"innerError",{get:function(){return this._innerError},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extraData",{get:function(){return this._extraData},enumerable:!0,configurable:!0}),e}(),h=function(){function e(e,t,r){this._tagNameSuffix=e,this._innerError=p(t),this._extraData=r}return Object.defineProperty(e.prototype,"tagNameSuffix",{get:function(){return this._tagNameSuffix},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"innerError",{get:function(){return this._innerError},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extraData",{get:function(){return this._extraData},enumerable:!0,configurable:!0}),e}();function _(){return u._SPFlight.isEnabled(1697)}r("ZKpy");var g=new(function(){function e(){}return e.prototype.getLPCLoader=function(){return Promise.all([r.e(27),r.e(7)]).then(r.bind(null,"+Dm3")).then(function(e){return e.default})},Object(n.__decorate)([function(e,t,r){if(r.value){var n=r.value;r.value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=new d._QosMonitor("LivePersonaCard.Load"),i=n.apply(this,e);return i.then(function(e){return r.writeSuccess(),e},function(e){throw e instanceof h?(r.writeExpectedFailure(e.tagNameSuffix,e.innerError,e.extraData),e.innerError):e instanceof f?(r.writeUnexpectedFailure(e.tagNameSuffix,e.innerError,e.extraData),e.innerError):(r.writeUnexpectedFailure("UnexpectedFailure",e),e)})}}}],e.prototype,"getLPCLoader",null),e}()),m=function(e){function t(r){var n=e.call(this,r)||this;return n._isUnMounted=!1,n._bootstrapLivePersonaCard=function(e,r){var i,o,a;return!t._isLivePersonaCardFlightEnabled()||u._BrowserUtilities.isMobileWebView()?Promise.resolve():t.LivePersonaCardHoverTarget?(n._updateBundleMountedState(null===(a=e)||void 0===a?void 0:a.nativeEvent),Promise.resolve()):_()?(n._loadPromise||(n._loadPromise=n._bootstrapCore(null===(i=e)||void 0===i?void 0:i.nativeEvent)),n._loadPromise):(!n._loadPromise&&r&&(n._loadPromise=n._bootstrapCore(null===(o=e)||void 0===o?void 0:o.nativeEvent)),n._loadPromise||Promise.resolve())},n._bootstrapCore=function(e){return o._TraceLogger.logVerbose(n._logSource,"LivePersonaCard._bootstrapCore"),g.getLPCLoader().then(function(e){return e.bootstrap(n.props.serviceScope,n._clientType)}).then(function(){n._isUnMounted||n._updateBundleMountedState(e)}).catch(function(e){o._TraceLogger.logError(n._logSource,e,"BootstrapLivePersonaCard")})},n._manuallyDispatchEventToTriggerCallout=function(e){var t,r,o;_()&&"keydown"===(null===(t=e)||void 0===t?void 0:t.type)&&n._ref.current&&(null===(r=Object(i.getFirstTabbable)(n._ref.current,n._ref.current,!0))||void 0===r||r.focus(),null===(o=n._ref.current.firstElementChild)||void 0===o||o.dispatchEvent(function(){if(KeyboardEvent instanceof Function)return new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Enter",code:"Enter",keyCode:13,which:13});var e=document.createEvent("KeyboardEvent");return e.initKeyboardEvent("keydown",!0,!0,window,"Enter","Enter",0,"",!1),e}()))},n._logTriggerAction=function(e,t){_()&&"Keyboard"===t&&e.keyCode!==i.KeyCodes.enter||(o._EngagementLogger.logEventWithLogEntry(new o._LogEntry("LivePersonaCard",n._logScenario+".Trigger",o._LogType.Event,{hasUPN:Boolean(n.props.upn).toString(),source:t,isBundleLoaded:n.state.isBundleLoaded.toString()})),_()&&n._isLPCBundleLoaded()||n._bootstrapLivePersonaCard(e,!0).catch(n._traceBootstrapFailure))},n._handleCardOpen=function(){o._EngagementLogger.logEvent("LivePersonaCard."+n._logScenario,"Open");var e=n.props.onCardOpen;e&&e()},n._traceBootstrapFailure=function(e){o._TraceLogger.logError(n._logSource,e,"LivePersonaCard.bootstrap")},n._logSource=o._LogSource.create("LivePersonaCard"),n._ref=s.createRef(),n.state={isBundleLoaded:!1},n}return Object(n.__extends)(t,e),t._isLivePersonaCardFlightEnabled=function(){return u._SPFlight.isEnabled(809)},Object.defineProperty(t,"LivePersonaCardHoverTarget",{get:function(){return window.LivePersonaCardHoverTargetV2},enumerable:!0,configurable:!0}),t.prototype.componentDidMount=function(){_()||this.props.disabled||this._bootstrapLivePersonaCard().catch(this._traceBootstrapFailure)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){_()||!this.props.disabled||e.disabled||this._bootstrapLivePersonaCard().catch(this._traceBootstrapFailure)},t.prototype.componentWillUnmount=function(){this._isUnMounted=!0,this._loadTimeout&&window.clearTimeout(this._loadTimeout)},t.prototype.render=function(){var e=this;if(this.props.disabled)return s.Children.only(this.props.children);if(u._BrowserUtilities.isMobileWebView())return s.cloneElement(s.Children.only(this.props.children),{role:"button","data-sp-action":JSON.stringify({key:"viewUserProfileDetails",args:{upn:this.props.upn}}),onClick:function(){}});var t=function(t){return e._logTriggerAction(t,"Mouse")},r=this.props.useSpan?"span":"div";return s.createElement(r,{className:Object(i.css)(this.props.className,!u._SPKillSwitch.isActivated("df1bcefa-582d-4d8a-9d9e-a6c6817047b0")&&"a_a_434b99a9"),onClickCapture:t,onKeyDownCapture:function(t){return e._logTriggerAction(t,"Keyboard")},onMouseOver:t,ref:_()?this._ref:void 0},this._renderContent())},t.prototype._renderContent=function(){var e={cardParameters:{personaInfo:{identifiers:Object(n.__assign)({PersonaType:this.props.hostAppPersonaInfo&&this.props.hostAppPersonaInfo.PersonaType||"User",Upn:this.props.upn,Smtp:this.props.upn},this.props.hostAppPersonaInfo&&{LocationId:this.props.hostAppPersonaInfo.LocationId,OlsPersonaId:this.props.hostAppPersonaInfo.OlsPersonaId,AadObjectId:this.props.hostAppPersonaInfo.PersonaAadObjectId,DisplayName:this.props.hostAppPersonaInfo.PersonaDisplayName}),displayName:this.props.displayName,personaCoinColor:Object(i.getPersonaInitialsColor)({text:this.props.displayName})},externalAppSessionCorrelationId:this.props.externalAppSessionCorrelationId,behavior:{onCardOpen:this._handleCardOpen,onCardClose:this.props.onCardClose,disableHover:this.props.disableHover,disableClick:this.props.disableClick},ariaLabel:this.props.ariaLabel},tabIndex:this.props.tabIndex};return this.props.upn&&this._isLPCBundleLoaded()?s.createElement(t.LivePersonaCardHoverTarget,Object(n.__assign)({},e,{onCardOpen:this._handleCardOpen}),s.Children.only(this.props.children)):_()&&this.props.upn&&!this._isLPCBundleLoaded()?s.cloneElement(s.Children.only(this.props.children),{tabIndex:0,"data-is-focusable":!0}):s.Children.only(this.props.children)},t.prototype._isLPCBundleLoaded=function(){return this.state.isBundleLoaded&&!!t.LivePersonaCardHoverTarget},Object.defineProperty(t.prototype,"_logScenario",{get:function(){return this.props.clientScenario||"unset"},enumerable:!0,configurable:!0}),t.prototype._updateBundleMountedState=function(e){var t=this;this.setState({isBundleLoaded:!0},function(){return t._manuallyDispatchEventToTriggerCallout(e)})},Object.defineProperty(t.prototype,"_clientType",{get:function(){return this.props.clientType||"SPPeopleWebPart"},enumerable:!0,configurable:!0}),t}(s.PureComponent),b=r("jPq8"),v=r("/l6g"),y=r("D7HB"),w=r("na3E"),P=function(e){function t(t){var r=e.call(this,t)||this;return r._cardRef=s.createRef(),r._personaRef=s.createRef(),r._handleKeyDown=function(e){e.stopPropagation(),e.which===i.KeyCodes.enter&&r._personaRef.current&&r._personaRef.current.click(),e.which===i.KeyCodes.del&&r.props.isEditMode&&r.props.onDeletePerson(1)},r._handleDeletePerson=function(){r.props.onDeletePerson(0)},r._renderPersonaCoin=function(e){return"Left"===r.props.alignment&&s.createElement(i.PersonaCoin,{coinProps:{className:y.a.personaCoin},imageUrl:e,imageShouldStartVisible:!0,size:r.props.personaSize,text:r.props.person.name})},r}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){this._removePersonaTabIndex()},t.prototype.componentDidUpdate=function(){this._removePersonaTabIndex()},t.prototype.render=function(){var e=a.StringHelper.format(w.d,this.props.person.name,this.props.person.role,w.b,this.props.isEditMode?a.StringHelper.format(w.c,this.props.person.name,this.props.person.role):""),t=Object(i.css)(y.a.card,this.props.isEditMode&&y.a.editMode,"Center"===this.props.alignment&&y.a.center,!Object(v.g)()&&y.a.focusWithChild);return s.createElement("div",{className:t,ref:this._cardRef,tabIndex:0,"aria-label":e,onKeyDown:this._handleKeyDown,"data-sp-a11y-skipkeys":"13",role:"button","data-alignment":this.props.alignment.toString()},this._renderPeoplePersona(),this.props.isEditMode&&this._renderButtons())},t.prototype.focus=function(){var e=this;setTimeout(function(){e._cardRef.current&&e._cardRef.current.focus()})},t.prototype._renderButtons=function(){return s.createElement("div",{className:y.a.buttons},s.createElement(i.IconButton,{iconProps:{iconName:"Cancel"},className:Object(i.css)(y.a.deleteButton,y.a.holdSpace),title:w.a,onClick:this._handleDeletePerson,"aria-hidden":!0,"data-automation-id":"deleteAuthor"}))},t.prototype._renderPeoplePersona=function(){var e=this.props,t=e.person,r=e.serviceScope,n=t.email,i=t.name,o=t.role,a=s.createElement("div",{className:y.a.persona,ref:this._personaRef},s.createElement(b.a,{imageUrl:this._getImageUrl(t),renderImage:this._renderPersonaCoin}),s.createElement("div",{className:y.a.personaDetails,"data-automation-id":"personaDetails"},s.createElement("div",{className:y.a.primaryText,title:i},i),s.createElement("div",{className:y.a.secondaryText,title:o},o||"")));return s.createElement(m,{clientScenario:"TitleRegionWebPart",hostAppPersonaInfo:{PersonaType:"User"},displayName:i,serviceScope:r,upn:n,className:y.a.persona},a)},t.prototype._getImageUrl=function(e){if(!Object(v.r)()){var t=e.email||e.id;return t?c.SPUtility.getUserPhotoUrl(t.toLowerCase(),2):""}return e.id?c.SPUtility.getUserPhotoUrl(e.id.toLowerCase(),2):""},t.prototype._removePersonaTabIndex=function(){this._personaRef.current&&this._personaRef.current.setAttribute("tabindex","-1")},t}(s.PureComponent);r("4qZb");var x,S=r("aOaD");function I(e){return r.e(18).then(r.bind(null,"GxSo")).then(function(t){return e.consume(t.AuthorBylineDataProvider.serviceKey)})}function E(e){var t=e.authorByline[0],r=function(e,t){var r,i=window._AuthorByline;if(i){var a=i.split(/[;,]#/);window._AuthorByline=void 0,a&&a.length>=9&&(r={id:a[2],email:a[3],name:a[1],role:a[8],upn:""})}var c=function(e){var t=s.useState(e),r=t[0],i=t[1],o=s.useRef(0);return s.useEffect(function(){return function(){o.current++}},[]),[r,function(e){return Object(n.__awaiter)(this,void 0,void 0,function(){var t,r;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return t=++o.current,[4,e];case 1:return r=n.sent(),t===o.current&&i(r),[2]}})})}]}(r),l=c[0],u=c[1];return s.useEffect(function(){r||u(t?I(e).then(function(e){return e.getPeopleInfo(t)}):Promise.resolve(void 0)).catch(function(e){return o._TraceLogger.logError(o._LogSource.create("TitleRegion"),e,"setAuthorByline")})},[t]),l}(e.serviceScope,t)||(e.selectedPersons[0]?Object(n.__assign)(Object(n.__assign)({},e.selectedPersons[0]),{role:""}):e.selectedPersons[0]),u=s.useRef(!1),d=s.useRef(null),p=s.useRef(null);function f(t){e.onChangeSelectedPersons([t]),I(e.serviceScope).then(function(e){return e.cache(t)}),u.current=!0}s.useEffect(function(){u.current&&(p.current?p.current.focus():d.current&&d.current.focus(),u.current=!1)});var h=Object(i.css)(e.className,"gl_q_9f38462c","Left"===e.alignment&&"gm_q_9f38462c","Center"===e.alignment&&"gn_q_9f38462c"),_=r?s.createElement(P,{isEditMode:e.isEditMode,serviceScope:e.serviceScope,person:r,personaSize:i.PersonaSize.size28,ref:d,alignment:e.alignment,onDeletePerson:function(t){r&&c.ScreenReaderAlert.read(a.StringHelper.format(S.a,r.name),c.ReadingMode.ReadImmediately),e.onChangeSelectedPersons([]),1===t&&(u.current=!0)}}):t?s.createElement("div",{style:{height:42}}):s.createElement(l.a,{editMode:e.isEditMode,renderEditMode:function(t){return s.createElement(t.PeopleCardPlaceholder,{onAddPerson:f,personaSize:i.PersonaSize.size28,serviceScope:e.serviceScope,ref:function(e){return p.current=e}})}});return s.createElement("div",{className:h,"data-automation-id":"authorByLine","data-alignment":e.alignment.toString()},_)}(x=E||(E={})).whiteTextClassName=y.a.whiteText,x.themedWhiteTextClassName=y.a.themedWhiteText},"P/oh":function(e,t,r){"use strict";r.d(t,"c",function(){return i}),r.d(t,"a",function(){return o}),r.d(t,"b",function(){return a});var n=r("UWqr");function i(){return n._SPFlight.isEnabled(630)}function o(){return n._SPExperiment.getVariantAndLogExposure(90070)>0}function a(){return n._SPFlight.isEnabled(1057)}r("/l6g")},Pk8u:function(e,t){e.exports=a},RTdm:function(e,t,r){(e.exports=r("5ADk")(!1)).push([e.i,".go_s_9f38462c{overflow:hidden}.gp_s_9f38462c{height:100%;background-size:cover;background-repeat:no-repeat}",""])},"Re++":function(e,t,r){var n=r("VR2z"),i=r("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var o=0;o<n.length;o++)i.loadStyles(n[o][1],!0);n.locals&&(e.exports=n.locals)},UWqr:function(e,t){e.exports=c},VR2z:function(e,t,r){(e.exports=r("5ADk")(!1)).push([e.i,'.iz_ar_9f38462c{display:-ms-flexbox;display:flex;-ms-flex-pack:start;justify-content:start}.iz_ar_9f38462c.im_ar_9f38462c{-ms-flex-pack:distribute;justify-content:space-around}.jf_ar_9f38462c{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal;padding:4px 12px;letter-spacing:1px;text-transform:uppercase;color:"[theme:white, default: #ffffff]";background-color:"[theme:accent, default: #0078d4]";font-size:11px;font-weight:400;font-weight:600}.jf_ar_9f38462c.ce_ar_9f38462c{border-radius:"[theme:roundedCorner2, default: 2px]"}.jf_ar_9f38462c.jj_ar_9f38462c{max-width:294px}.jf_ar_9f38462c:not(.jj_ar_9f38462c){max-width:262px}@media screen and (min-width:480px){.jf_ar_9f38462c:not(.jj_ar_9f38462c){font-size:12px;font-weight:400;font-weight:600}}',""])},VXhS:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r("UWqr"),i=r("ut3N"),o=r("hiL/"),a=function(){function e(e){this._isDisposed=!1;var t=new Promise(function(e){setTimeout(function(){e()},4e3)});this._pageService=t.then(function(){return e.consume(o.PageService.serviceKey)})}return Object.defineProperty(e.prototype,"instanceId",{get:function(){return"2eb4b1dc-ced3-4afe-bc87-e4060c7475d4"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"componentId",{get:function(){return"47eb5490-fd78-4da8-8954-e95e03d64bed"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0)},e.prototype.subscribe=function(e,t){var r=this;this._pageService.then(function(n){return n.subscribe(r,e,t)}).catch(function(e){i._TraceLogger.logError(i._LogSource.create("TitleRegion"),e,"SubscribePageService")})},e.prototype.unsubscribe=function(e,t){var r=this;this._pageService.then(function(n){return n.unsubscribe(r,e,t)}).catch(function(e){i._TraceLogger.logError(i._LogSource.create("TitleRegion"),e,"UnsubscribePageService")})},e.prototype.getPagePublishInfo=function(){return this._pageService.then(function(e){return e.getPagePublishInfo()})},e.prototype.getCurrentItem=function(){return this._pageService.then(function(e){return e.getCurrentItem()})},e.serviceKey=n.ServiceKey.create("TitleRegion",e),e}()},VmcK:function(e){e.exports=JSON.parse('{"a":"This is the background image of title area."}')},WNWH:function(e,t,r){"use strict";function n(e){var t=e._featureInfo.get("SitePagePublishing");return!!t&&t.enabled}r.d(t,"a",function(){return n})},WbzD:function(e,t,r){"use strict";r.d(t,"a",function(){return m});var n=r("17wl"),i=r("KL1q"),o=r("8dK2"),a=r("hiL/"),c=r("UWqr"),s=r("Pk8u"),l=function(){function e(){var t=this;this.register=function(e,r,n){t._scrollableParents&&t._scrollableParents.length||(t._scrollableParents=n?[n]:t._findScrollableParents(e)),t._scrollableParents.forEach(function(e,r,n){1===t._updateRegisteredChildren(e,1)&&t._listenEvents(e)}),t._listenEvents(window),t._eventListeners.add(r)},this._findScrollableParents=function(t){for(var r=[],n=t;n;)(n=e._findScrollableParent(n))&&(r.push(n),n=n.parentElement);return r.length?r:[document.body]},this._unlistenEvents=function(e){if(e){var r=e===window;(!r||r&&t._isListeningWindow)&&(t._removeEventListener(e),r&&(t._isListeningWindow=!1))}},this._updateRegisteredChildren=function(t,r){var n=r+Number(t.getAttribute(e._eventTrackerAttribute));return n>0?t.setAttribute(e._eventTrackerAttribute,n.toString()):t.removeAttribute(e._eventTrackerAttribute),n},this._eventListeners=new Set,this._isListeningWindow=!1,this._lazyHandler=s.throttle(this._scrollEventHandler,10).bind(this)}return Object.defineProperty(e,"instance",{get:function(){return void 0===e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.unregister=function(e,t){var r=this;c.Validate.isNotNullOrUndefined(t,"unregister callback function"),this._eventListeners.has(t)&&(this._eventListeners.delete(t),(this._scrollableParents&&this._scrollableParents.length?this._scrollableParents:this._findScrollableParents(e)).forEach(function(e,t,n){r._updateRegisteredChildren(e,-1)<=0&&r._unlistenEvents(e)}),0===this._eventListeners.size&&this._unlistenEvents(window))},e.prototype._scrollEventHandler=function(e){var t=this;this._cachedClientRect&&!this._cacheExpired||(this._cachedClientRect=this._scrollableParents[this._scrollableParents.length-1].getBoundingClientRect(),this._cachedClientRectAge=Date.now()),this._eventListeners.forEach(function(r){r(e,t._cachedClientRect)})},e.prototype._listenEvents=function(e){if(e){var t=e===window;(!t||t&&!this._isListeningWindow)&&(this._addEventListener(e),t&&(this._isListeningWindow=!0))}},e.prototype._addEventListener=function(t){t.addEventListener(e.SCROLL,this._lazyHandler,!1),t.addEventListener(e.RESIZE,this._lazyHandler,!1)},e.prototype._removeEventListener=function(t){t.removeEventListener(e.SCROLL,this._lazyHandler),t.removeEventListener(e.RESIZE,this._lazyHandler)},Object.defineProperty(e.prototype,"_cacheExpired",{get:function(){return Date.now()-this._cachedClientRectAge>=e.CACHE_EXPIRED},enumerable:!0,configurable:!0}),e._eventTrackerAttribute="data-sp-scroll-event-listener",e.SCROLL="scroll",e.RESIZE="resize",e.CACHE_EXPIRED=100,e._findScrollableParent=function(t){for(var r=t,n=document.body;r&&r!==n;){if("true"===r.getAttribute("data-is-scrollable"))return r;r=r.parentElement}for(r=t;r&&r!==n;){var i=getComputedStyle(r);if(i){var o=i.getPropertyValue("overflow-y");if(o&&(o===e.SCROLL||"auto"===o))return r}r=r.parentElement}return r&&r!==n||(r=void 0),r},e}(),u=function(){function e(){var e=this;this._parallaxElements=new Set,this._parallaxFactor=1.81,this._onScroll=function(t,r){window.requestAnimationFrame(e._updateParallax.bind(e,r))},this._updateParallax=function(t){var r=t.top;e._parallaxElements.forEach(function(t){if(t.parentElement){var n=t.parentElement.getBoundingClientRect(),i=n.top,o=n.bottom;if(i<r&&o>r){var a=Math.round((r-i)/e._parallaxFactor);e._setTranslate(t,a)}else i>=r&&e._setTranslate(t,0)}})}}return Object.defineProperty(e,"instance",{get:function(){return void 0===e._instance&&(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isParallaxEnabled",{get:function(){var e=c._BrowserDetection.getBrowserInformation();return e.browser!==c._Browser.Edge&&e.browser!==c._Browser.IE&&!c._BrowserUtilities.isWebViewHosted()},enumerable:!0,configurable:!0}),e.prototype.tryAddParallax=function(e){var t=this.isParallaxEnabled;if(t){c.Validate.isNotNullOrUndefined(e,"targetElement");var r=Object(i.findScrollableParent)(e),n=r===window?document.body:r;l.instance.register(e,this._onScroll,n),this._parallaxElements.add(e),e.style.setProperty("will-change","transform")}return t},e.prototype.removeParallax=function(e){c.Validate.isNotNullOrUndefined(e,"targetElement"),this._parallaxElements.has(e)&&(this._parallaxElements.delete(e),l.instance.unregister(e,this._onScroll),this._setTranslate(e,0),e.style.removeProperty("will-change"))},e.prototype._setTranslate=function(e,t){var r="translate3d(0px,"+t+"px, 0px)";e.style.transform=r},e}(),d=r("cDcd"),p=r("faye"),f=r("q0io"),h=r("P/oh"),_=r("75MU");r("XrIC");var g=r("VmcK"),m=function(e){function t(t){var r=e.call(this,t)||this;return r._renderUploadSpinner=function(e){return d.createElement(e.UploadSpinner,null)},r._renderFocalPoint=function(e){return d.createElement(e.FocalPoint,{position:r.state.focalPoint,onFocalPointMove:r._handleFocalPointMove,onFocalPointEnd:r._handleFocalPointEnd})},r._handleFocalPointMove=function(e){r.setState({focalPoint:e})},r._handleFocalPointEnd=function(e){r.props.onChangeFocalPoint(r.state.focalPoint,e),a.SPFREUtility.dismissFRECallout("sp-fre-titleregion-5")},r.state={focalPoint:t.focalPoint},r}return Object(n.__extends)(t,e),t.applyParallax=function(e){var r=t._findBackgroundImage(e);r&&!r.hasAttribute("data-parallax")&&u.instance.tryAddParallax(r)&&r.setAttribute("data-parallax","1")},t.removeParallax=function(e){var r=t._findBackgroundImage(e);r&&r.hasAttribute("data-parallax")&&(u.instance.removeParallax(r),r.removeAttribute("data-parallax"))},t._findBackgroundImage=function(e){if(e){var t=p.findDOMNode(e);if(t&&t instanceof Element){var r=t.classList.contains("gp_s_9f38462c")?t:t.querySelector(".gp_s_9f38462c");return r instanceof HTMLElement?r:void 0}}},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.focalPoint!==e.focalPoint&&this.setState({focalPoint:e.focalPoint})},t.prototype.render=function(){var e,t=f.b.defaultToCenter(this.state.focalPoint),r=t.x,n=t.y;if(Object(h.c)()&&Object(h.a)()){var a=r+"% "+n+"%";switch(_.a.convertFocalPointToCropMode(this.state.focalPoint)){case o._CropMode.Bottom:a=r+"% 100%";break;case o._CropMode.Top:a=r+"% 0%";break;case o._CropMode.Fill:a="50% 50%"}e=this.props.fullSizeImageURL&&(this.props.editMode||this.props.useFullSizeImageURL)?this.props.fullSizeImageURL?{backgroundImage:'url("'+this.props.fullSizeImageURL+'")',backgroundPosition:r+"% "+n+"%"}:{}:this.props.imageURL?{backgroundImage:'url("'+this.props.imageURL+'")',backgroundPosition:""+a}:{}}else e=this.props.imageURL?{backgroundImage:'url("'+this.props.imageURL+'")',backgroundPosition:r+"% "+n+"%"}:{};return d.createElement("div",{className:Object(i.css)("go_s_9f38462c",this.props.className)},d.createElement("div",{className:Object(i.css)(this.props.className,"gp_s_9f38462c"),style:e,role:"img","aria-label":this.props.altText||g.a,"data-automation-id":"LocalImage"===this.props.image.type||"ExternalImage"===this.props.image.type?"localFilePreview":"titleRegionBackgroundImage"},d.createElement(f.a,{editMode:this.props.editMode,renderEditMode:this._renderUploadSpinner}),d.createElement(f.a,{editMode:this.props.editMode,renderEditMode:this._renderFocalPoint}),this.props.editMode&&d.createElement("div",{"data-sp-fre-id":"sp-fre-titleregion-5","data-offset-left":"50%","data-offset-top":"20%"})))},t}(d.PureComponent)},WfYB:function(e,t,r){(e.exports=r("5ADk")(!1)).push([e.i,".iz_ah_9f38462c{position:relative}@media screen and (min-width:640px){.iz_ah_9f38462c>:not(.gp_ah_9f38462c){position:absolute;left:0;right:0;top:0;bottom:0}}.gp_ah_9f38462c{height:150px}@media screen and (min-width:640px){.gp_ah_9f38462c{height:228px}}@media screen and (min-width:1920px){.gp_ah_9f38462c{height:280px}}@media screen and (max-width:639.99999px){.kb_ah_9f38462c{background-image:none!important}}.ja_ah_9f38462c{-ms-flex-pack:end;justify-content:flex-end;padding-top:16px;padding-bottom:12px}@media screen and (min-width:640px){.ja_ah_9f38462c{padding-bottom:20px}}.jf_ah_9f38462c{margin-bottom:6px}.gl_ah_9f38462c{margin-top:10px}.jh_ah_9f38462c{margin-top:6px}@media screen and (min-width:640px){.jy_ah_9f38462c{color:#fff!important}.jy_ah_9f38462c:-ms-input-placeholder{color:#eaeaea}.white:-ms-input-placeholder{color:#eaeaea}.jy_ah_9f38462c::placeholder{color:#eaeaea}}",""])},"X+PM":function(e,t){e.exports=s},XeeV:function(e,t,r){var n=r("YTcP"),i=r("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var o=0;o<n.length;o++)i.loadStyles(n[o][1],!0);n.locals&&(e.exports=n.locals)},XrIC:function(e,t,r){var n=r("RTdm"),i=r("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var o=0;o<n.length;o++)i.loadStyles(n[o][1],!0);n.locals&&(e.exports=n.locals)},YTcP:function(e,t,r){(e.exports=r("5ADk")(!1)).push([e.i,".ii_v_9f38462c{display:-ms-flexbox;display:flex}.ii_v_9f38462c:not(.ij_v_9f38462c){background-color:transparent;background-image:linear-gradient(180deg,transparent 0,rgba(0,0,0,.6))}.ik_v_9f38462c .ii_v_9f38462c{display:none}",""])},Ys63:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=r("KL1q"),i=r("cDcd");r("XeeV");function o(e){var t=Object(n.css)(e.className,"ii_v_9f38462c",e.disabled&&"ij_v_9f38462c");return i.createElement("div",{className:t},e.children)}(o||(o={})).hideClassName="ik_v_9f38462c"},ZKpy:function(e,t,r){var n=r("6ddY"),i=r("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var o=0;o<n.length;o++)i.loadStyles(n[o][1],!0);n.locals&&(e.exports=n.locals)},ZgyI:function(e,t,r){"use strict";r.d(t,"b",function(){return o}),r.d(t,"a",function(){return a});var n=r("UWqr"),i=new(r("hiL/").KillSwitch)("7e3ee066-0e56-4b8a-9b1e-94e15d634e90");function o(){return n._SPFlight.isEnabled(1248)&&!i.isActivated()}function a(){return n._SPFlight.isEnabled(1761)}},a87W:function(e,t,r){e.exports=r.p+"spdefaultbanner_light_a0bc58c25323ac7ccd8b6d2e15b0ee85.jpg"},aOaD:function(e){e.exports=JSON.parse('{"a":"The profile for {0} has been removed."}')},br4S:function(e,t){e.exports=l},cDcd:function(e,t){e.exports=u},cgRt:function(e,t,r){"use strict";r.d(t,"a",function(){return d});var n=r("17wl"),i=r("KL1q"),o=r("ut3N"),a=r("cDcd"),c=r("q0io"),s=r("P/oh"),l=r("WbzD"),u=r("75MU"),d=function(e){function t(r){var n=e.call(this,r)||this;if(n._asyncCount=0,n.state={imageURL:t._cache.get(r.image.id)||"",previousImage:void 0,fullSizeImageURL:Object(s.c)()&&Object(s.a)()&&t._fullsizeUrlCache.get(r.image.id)||void 0},n._reader=new u.a(r.serviceScope),t._cache.has(r.image.id))n.props.onCompleteFirstRender();else{var i=++n._asyncCount;n._reader.getImageURL(r).then(function(e){if(n.props.onCompleteFirstRender(),i===n._asyncCount&&(t._cache.set(r.image.id,e),n.setState({imageURL:e})),Object(s.c)()&&Object(s.a)())if("SharePointImage"===r.image.type){var o=n._reader.getFullSizeUrl(r);t._fullsizeUrlCache.set(r.image.id,o),n.setState({fullSizeImageURL:o})}else"LocalImage"!==r.image.type&&"DefaultImage"!==r.image.type||n.setState({fullSizeImageURL:void 0})}).catch(function(){n.props.onCompleteFirstRender()})}return n}return Object(n.__extends)(t,e),Object.defineProperty(t,"defaultImage",{get:function(){return u.a.defaultImage},enumerable:!0,configurable:!0}),t.prototype.componentWillUnmount=function(){this._asyncCount++},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var r=this;if(this.props.image.id!==e.image.id&&(this.setState({imageURL:t._cache.get(e.image.id)||"",fullSizeImageURL:Object(s.c)()&&Object(s.a)()&&t._fullsizeUrlCache.get(e.image.id)||""}),!t._cache.has(e.image.id))){var n=++this._asyncCount;this._reader.getImageURL(e).then(function(i){if(n===r._asyncCount&&(t._cache.set(e.image.id,i),r.setState({imageURL:i})),Object(s.c)()&&Object(s.a)())if("SharePointImage"===e.image.type){var o=r._reader.getFullSizeUrl(e);t._fullsizeUrlCache.set(e.image.id,o),r.setState({fullSizeImageURL:o})}else"LocalImage"!==e.image.type&&"DefaultImage"!==e.image.type||r.setState({fullSizeImageURL:void 0})}).catch(function(e){o._TraceLogger.logError(o._LogSource.create("TitleRegion"),e,"GetImageUrl")})}this.props.image!==e.image&&this.setState({previousImage:this.props.image})},t.prototype.render=function(){var e,t=void 0!==this.state.previousImage&&"ExternalImage"===this.state.previousImage.type&&"SharePointImage"===this.props.image.type&&""===this.state.imageURL;return a.createElement(l.a,Object(n.__assign)({},this.props,{className:Object(i.css)(t&&c.c.showClassName,this.props.className),imageURL:this.state.imageURL,fullSizeImageURL:Object(s.c)()&&Object(s.a)()?(e=this.state.fullSizeImageURL,null!=e?e:this.state.imageURL):void 0}))},t.applyParallax=l.a.applyParallax,t.removeParallax=l.a.removeParallax,t._cache=new Map,t._fullsizeUrlCache=new Map,t}(a.PureComponent)},ddOm:function(e,t,r){var n=r("9eD7"),i=r("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var o=0;o<n.length;o++)i.loadStyles(n[o][1],!0);n.locals&&(e.exports=n.locals)},dg7M:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=r("cDcd").createContext({})},faye:function(e,t){e.exports=d},"hiL/":function(e,t){e.exports=p},i3Qc:function(e,t,r){var n=r("4qiQ"),i=r("jOlS");"string"==typeof n&&(n=[[e.i,n]]);for(var o=0;o<n.length;o++)i.loadStyles(n[o][1],!0);n.locals&&(e.exports=n.locals)},iLQm:function(e,t,r){(e.exports=r("5ADk")(!1)).push([e.i,".gl_q_9f38462c{display:-ms-flexbox;display:flex;-ms-flex-pack:start;justify-content:start}.gl_q_9f38462c.gm_q_9f38462c{-ms-flex-pack:start;justify-content:flex-start}.gl_q_9f38462c.gn_q_9f38462c{-ms-flex-pack:center;justify-content:center}",""])},jOlS:function(e,t){e.exports=f},jPq8:function(e,t,r){"use strict";r.d(t,"b",function(){return o}),r.d(t,"a",function(){return p});var n=r("y88i"),i=r("hiL/");function o(e){var t=e.pageContext,r=e.url,o=e.siteId,c=e.webId,s=e.uniqueId,l=e.callerId,u=e.originalWidth,d=e.originalHeight;if(r){var p=i.ExtensionHelper.getExtension(new i.SPResourcePath(r))||"";if(i.PreviewHelper.hasThumbnailOrFileTypeSupportsPreview(p,void 0)||"gif"===p){var f,h=t&&t.web.absoluteUrl||window.location.href,_=new n.Uri(h),g=_.getLeftPart(1),m=!!(o&&c&&s),b=!(t&&t.web&&t.web.serverRelativeUrl&&r)||-1===r.toUpperCase().indexOf(t.web.serverRelativeUrl.toUpperCase());if(!m&&r&&!b){var v=a(r,g,b,t),y=new n.Uri(v);y.getHost().toUpperCase()===_.getHost().toUpperCase()&&(m=!!(f=y.getPath()))}if(m){var w=i.PreviewHelper.getPreviewImageUrl(p,void 0,g,f,o,c,s,void 0,!0,l,u,d);if(w&&w.length<=255)return w}return a(r,g,b,t)}}}function a(e,t,r,i){var o=i&&i.web.absoluteUrl,a=""!==new n.Uri(e).getHost(),c=r?t:o,s=r?e:e.substr(i.web.serverRelativeUrl.length);return a?e:n.Uri.concatenate(c,s)}var c=r("17wl"),s=r("cDcd"),l=r("ut3N"),u=r("UWqr"),d=new Set(["03590920bdfd864322cf7e8cca891bb4","0381c1bcfc0b809623b805e322dd9fa1","03d374b16722d252588fa2d58a3e828d","0540187fe91e3b78e3b5d06999eebf80","083313c7a8083e625c0def330dbd7cdd","0974242efa7f7b9bb52240ee615b931b","0bbb13911b2ce26da17bbdf2ea3404b6","0d827eba349aa0591be57331540fc4f4","0e47add0cdf9530b9e30ddef0c489a40","0f78c3aa1a3da070d8f62bb9a2ee76ae","0fe8fe2f5220263be4cbd5f61d9cf23c","178a70df6ddfa637e3d4f0ea9a80fbdd","1a960363e8daa165d3b82144b0d68c03","1e033e719ef573ec796c38bf8ac41dfc","1f420b466365299439abf6fe2f8bff6a","20f0b5fb7de21fa889b002714ec58f20","2149d6090d915f849f5c33c07545fb03","23d161d98611bae938697c4d0af3bfd4","241b2579d59d10255b2e405fbcbb9117","26736ef07954f237039d261c357f06e5","279ec9ccb88c02985b4e1f645b755faf","2d523e15f73a2b345887c8b8299c8d3c","2fce211aefcaec7742455aa616edfa32","2f73a4291c58a29acc783b73fa88c282","3178a5744ef0cd2b61757583d7b7ccf1","319f83a0e835d32ce2660a4de654a7c0","3a9c8d1a8fae79004ed36c0147bdd71b","3fa3e0b2e84cb77f00799dca10f1a03e","4a48f26592f4e1498d7a478a4c48609c","41ebba55d20ff0a87734a09d88dc8f27","4312d1e9ec65cb2412e83a64f50fcdd1","44f2e736a8f04d1b47a1151eb37e0a64","48e8c755618be2d66c67976910bac81f","49fe29d48bd08304cb7a9be0a4256b8a","5b60516651aebbbc796eafdee967ef2c","613c9c11d6bfdec3dd2a568412b79762","62fe9bb236110e4553483b02e1989986","68df1aaa4d4d20f6749dcf0cbcbfd182","6c06b3944a82b194dd56b848d5c1e53f","6fe016add870f202c0a30c70ee943c73","7024c1dc5ed913c848ac81adadfedee4","7ad602295f8386b7615b582d87bcc294","7f25de15c2e701c901252f81c1911af2","8193ab3946149e9175a3c3d44219e9e1","8a2bceaca7e84b8f4da535d772625c6f","8a430e2d85dc31b60c0c6f68d7cc4c20","8b02cb6c9f9d7a7e895970d94317e20a","8ddba906d9614422695d3c9756afee7f","8f296bb8aac7be4f08409d8dbbbc8714","9029ea4d3ee7796fe043710dfff1d218","90ac8c284c2ac3a6f6b7e6518dbb6227","965331b9e159f7e263f86866902241e8","98f88501895b89e844d24793dadc8a9f","9a85f4ab720503d37748e2d854a238dc","9aae9266066558e0e42223ed4d82b1f8","a284f85a5a3096a5e90f670316993365","a3f3c88a874da09d43c8f88deb9246b6","ab08afa407a9c009513a07525fadf367","ba3cc3f8be4b187472e2f5f7d5376bb9","b3b9212834745aa4457f459f12e56653","b8a930a9d063513ea9bba50a34aaaba5","b8f6d5994ef9e9a96180ea43dbb00ed6","baa367f8c4aef7abdcb912c61f53ed10","bc4fab3f78291f699922e57650be557f","c065f1d4e77c3678be1ff6aa835dda69","c4ae58fb4e94e08cfff98beddeb615ac","c63681d72227d0813a5cdfccb62be638","c903233a37600953361096a5c28d0d46","c9dc379c327bef6f8db124f5f013fe22","cbcecad0b1eb14fe8186c566f22b0fa1","cd26d43c2fabf764bfc054d06462f64f","cd849e71a1785cc1f046b181e68bbec3","d283507fbbeb97715a321ddbd2442164","d6c8114c17555266c90ad015c2acd8b9","dacd2fb8ace0a4176a74a228539b3d33","e6ede0691f3312bd6fd9f1066153a868","e72abfe847c8792f99bc8b2cbeb65886","ea754dbc9eba7d06ae4b444f722c24df","f0d90ca687e974534dfc12798166c7e6","ffb18190d6e56748b5d6d743ff7421ad"]),p=function(e){function t(r){var n=e.call(this,r)||this;n._unmounted=!1,n._completeDetection=function(){n.props.onDetectCompleted&&n.props.onDetectCompleted()},n.revokeBlobUrl=function(){n._blobUrl&&(URL.revokeObjectURL(n._blobUrl),n._blobUrl=void 0)},n._logSource=l._LogSource.create("DoughboyDetector");var i=t._imageDataCache.get(r.imageUrl);return n.state={imageData:i},n}return Object(c.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;this.state.imageData?requestAnimationFrame(this._completeDetection):this.props.disableDelayDetect?this._resolveImage(this.props.imageUrl).then(this._completeDetection,this._completeDetection):setTimeout(function(){e._resolveImage(e.props.imageUrl).then(e._completeDetection,e._completeDetection)},7e3)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var r=this;if(this.props.imageUrl!==e.imageUrl){var n=t._imageDataCache.get(e.imageUrl);n?this.setState({imageData:n}):this._resolveImage(e.imageUrl).catch(function(e){return l._TraceLogger.logError(r._logSource,e,"ResolveImage")})}},t.prototype.componentWillUnmount=function(){this._unmounted=!0,this.revokeBlobUrl()},t.prototype.render=function(){return this.props.renderImage(this.state.imageData||"",this.props.imageProps,this._extraProps)},t.prototype._resolveImage=function(e){var r=this;return new Promise(function(n,o){var a=document.createElement("img");a.onload=function(){var c=r._getImageBase64(a),s=Object(i.Md5Hash)(c);if(d.has(s))l._EngagementLogger.logEventWithLogEntry(new l._LogEntry("DoughboyDetector","IsDoughboyImage",l._LogType.Event,{fingerprint:s})),o(new i.ExpectedFailure("DoughboyImageDetected"));else if(r._unmounted)o(new i.ExpectedFailure("ElementUnmounted"));else{var u="data:image/png;base64,"+c;r.setState({imageData:u}),t._imageDataCache.set(e,u),n()}},a.onerror=function(e){o(new i.ExpectedFailure("DownloadImageFailed",e.error))},u._SPKillSwitch.isActivated("a2a16402-2f33-4194-9f64-0401227d07bd")?a.src=e:r._downloadImageBlob(e).then(function(e){r.revokeBlobUrl(),r._blobUrl=URL.createObjectURL(e),a.src=r._blobUrl}).catch(function(){return a.src=e}),a.crossOrigin="anonymous"})},t.prototype._downloadImageBlob=function(e){var t=this;return new Promise(function(r,n){var o,a=u._SPKillSwitch.isActivated("debde2df-6396-4e00-a52b-9f0e28593f6f"),c=new XMLHttpRequest;c.open("GET",e),c.responseType="blob";var s="";if(!a){var d=e.toLowerCase();s=d.indexOf("/_layouts/15/userphoto.aspx")>-1?"UserPhoto":d.indexOf("_vti_bin/afdcache.ashx/_userprofile/userphoto.jpg")>-1?"AFDCDNUserPhoto":d.indexOf("https://privatecdn")>-1&&d.indexOf("/_userprofile/userphoto.jpg")>-1?"CDNUserPhoto":"Unknown",o=new l._QosMonitor("UserPhotoRenderService."+s)}c.onload=function(){var l;if(c.status>=200&&c.status<300&&c.response){if(!a){var u="CDNUserPhoto"===s||"AFDCDNUserPhoto"===s?c.getResponseHeader("x-cache"):"",d="AFDCDNUserPhoto"===s?c.getResponseHeader("x-ccc"):"",p=c.getResponseHeader("x-cache-origin");o.writeSuccess({service:s,alias:"DoughboyDetector",statusCode:c.status,CDNCache:null===(l=u)||void 0===l?void 0:l.split(" ")[0],OriginCache:p,cacheCountryCode:d,size:c.response.size,source:c.response.type})}return r(c.response)}var f=c.getResponseHeader("location");if(f&&c.status>=300&&c.status<400)t._downloadImageBlob(f).then(r).catch(n);else{if(!a){var h=new Error("<url>"+Object(i.scrubUrl)(void 0,e)+"</url> <errorCode>"+c.status+"</errorCode>");o.writeUnexpectedFailure(s+" failed",h,{alias:"DoughboyDetector",statusCode:c.status})}n("")}return r(c.response)},c.onerror=function(){if(!a){var t=new Error("<url>"+Object(i.scrubUrl)(void 0,e)+"</url> <errorCode>"+c.status+"</errorCode>");o.writeUnexpectedFailure(s+" failed",t,{alias:"DoughboyDetector",headers:c.getAllResponseHeaders()})}n("")},c.send()})},t.prototype._getImageBase64=function(e){var t,r=document.createElement("canvas");r.width=e.width,r.height=e.height,r.getContext("2d").drawImage(e,0,0);try{t=r.toDataURL("image/png"),this.revokeBlobUrl()}catch(e){return""}return t.replace(/^data:image\/png;base64,/,"")},Object.defineProperty(t.prototype,"_extraProps",{get:function(){var e=this.props;return e.imageUrl,e.imageProps,e.renderImage,e.onDetectCompleted,Object(c.__rest)(e,["imageUrl","imageProps","renderImage","onDetectCompleted"])},enumerable:!0,configurable:!0}),t._imageDataCache=new Map,Object(c.__decorate)([Object(i.monitor)("DoughboyDetector.ResolveImage")],t.prototype,"_resolveImage",null),t}(s.Component)},kgWS:function(e,t,r){e.exports=r.p+"image_background_stockImage_9fe1b89a.png"},mFdQ:function(e,t,r){e.exports=r.p+"spdefaultbanner_dark_85e6e2d30affc7996bb1896a98a78096.jpg"},nCbH:function(e,t,r){(e.exports=r("5ADk")(!1)).push([e.i,'.lm_ap_9f38462c{padding:0;width:100%;outline:0;word-wrap:break-word;word-break:break-word;color:"[theme:black, default: #000000]";font-size:24px;line-height:1.35}.lm_ap_9f38462c.im_ap_9f38462c{text-align:center}.lm_ap_9f38462c:-ms-input-placeholder{color:"[theme:neutralSecondary, default: #605e5c]"}.text:-ms-input-placeholder{color:"[theme:neutralSecondary, default: #605e5c]"}.lm_ap_9f38462c::placeholder{color:"[theme:neutralSecondary, default: #605e5c]"}.lm_ap_9f38462c:not(.ce_ap_9f38462c){font-weight:300}.lm_ap_9f38462c.ce_ap_9f38462c{font-size:"[theme:xxLargePlusFontSize, default: 32px]";font-weight:"[theme:xxLargePlusFontWeight, default: 600]"}@media screen and (min-width:480px){.lm_ap_9f38462c{font-size:28px}}@media screen and (min-width:640px){.lm_ap_9f38462c{font-size:32px}}',""])},na3E:function(e){e.exports=JSON.parse('{"d":"Page author byline. {0} {1}.Â {2} {3}","b":"PressÂ EnterÂ toÂ open details for this person.","c":"Press Delete to remove the profile for {0} {1}.","a":"Remove profile"}')},q0io:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"c",function(){return o}),r.d(t,"a",function(){return d});var n,i,o,a=r("Pk8u"),c=r("LIhD");(i=n||(n={})).focus=a.noop,i.defaultToCenter=function(e){return Object(c.a)(e)},function(e){e.showClassName=""}(o||(o={}));var s=r("17wl"),l=r("hiL/"),u=r("5z2F"),d=function(e){function t(t){var r=e.call(this,t)||this;return r._hasUnmount=!1,r.state={module:void 0},t.editMode&&r._requestModule(),r}return Object(s.__extends)(t,e),t.import=function(){return t._bundle||(t._bundle=t._loadBundle().then(function(e){return u.flush(),function(e){n.focus=e.FocalPoint.focus,o.showClassName=e.UploadSpinner.showClassName}(e),e})),t._bundle},t._loadBundle=function(){return Promise.all([r.e(29),r.e(17)]).then(r.bind(null,"vHG5"))},t.prototype.componentWillUnmount=function(){this._hasUnmount=!0},t.prototype.UNSAFE_componentWillReceiveProps=function(e){!this.props.editMode&&e.editMode&&!this.state.module&&this._requestModule()},t.prototype.render=function(){return this.props.editMode&&this.state.module?this.props.renderEditMode(this.state.module,this.props):!!this.props.renderViewMode&&this.props.renderViewMode(this.props)},t.prototype._requestModule=function(){var e=this;t.import().then(function(t){e._hasUnmount||e.setState({module:t})}).catch(function(){})},Object(s.__decorate)([Object(l.monitor)("TitleRegion.LoadEditModeBundle")],t,"_loadBundle",null),t}(r("cDcd").Component)},r5RM:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r("KL1q"),i=r("X+PM"),o=r("cDcd"),a=r("WNWH");r("i3Qc");function c(e){var t=e.serviceScope.consume(i.PageContext.serviceKey),r=Object(n.css)("iz_x_9f38462c",e.editMode&&"gw_x_9f38462c"),c=Object(n.css)(e.className,"ja_x_9f38462c",Object(a.a)(t)&&"jb_x_9f38462c");return o.createElement("div",{className:r},o.createElement("div",{className:c},e.children))}(c||(c={})).hideClassName="ik_x_9f38462c"},"s/fY":function(e,t,r){(e.exports=r("5ADk")(!1)).push([e.i,".le_al_9f38462c{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.le_al_9f38462c.lf_al_9f38462c{z-index:0}",""])},tp9l:function(e,t,r){"use strict";r.r(t);var n=r("17wl"),i=r("UWqr"),o=r("ut3N"),a=r("br4S"),c=r("hiL/"),s=r("2q6Q"),l=r("jPq8"),u=r("cDcd"),d=r("faye"),p=r("cgRt"),f=r("q0io"),h=function(){function e(){}return e.import=function(t){var r=e._map.get(t);return r||(r=e._createLayout(t),e._map.set(t,r)),r},e._createLayout=function(e){switch(e){case"Event":return r.e(20).then(r.bind(null,"h/CR")).then(function(e){return new e.EventLayout});case"EventNoImage":return r.e(21).then(r.bind(null,"GmX1")).then(function(e){return new e.EventNoImageLayout});case"NewsDigest":return r.e(22).then(r.bind(null,"ZiM/")).then(function(e){return new e.NewsDigestLayout});case"TopicPage":return r.e(23).then(r.bind(null,"b7p/")).then(function(e){return new e.TopicPageLayout});case"ColorBlock":return r.e(19).then(r.bind(null,"vkYC")).then(function(e){return new e.ColorBlockLayout});default:throw new Error("Unsupported layout type: "+e)}},e._map=new Map,e}(),_=r("Ozj5"),g=r("r5RM"),m=r("KEhi"),b=r("+L0y"),v=r("DM/N");r("ddOm");var y=function(){function e(){var e=this;this.canvas=function(t){return u.createElement("div",null,e._renderBackground(t),e._renderContent(t))},this._renderBackground=function(e){return u.createElement("div",{className:"jc_y_9f38462c"},u.createElement(p.a,Object(n.__assign)({},e,{onChangeFocalPoint:e.controller.setFocalPoint,onCompleteFirstRender:e.controller.completeFirstRender})))},this._renderContent=function(t){return u.createElement(g.a,{className:"ja_y_9f38462c",editMode:t.editMode,serviceScope:t.serviceScope},u.createElement("div",{className:"je_y_9f38462c"},e._renderTopicHeader(t),e._renderCutInBlock(t)))},this._renderCutInBlock=function(t){return u.createElement("div",{className:"jg_y_9f38462c"},e._renderTitleInput(t),e._renderAuthorByline(t),e._renderPublishDate(t))}}return Object.defineProperty(e.prototype,"type",{get:function(){return"CutInShape"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertyPane",{get:function(){return{showLayoutChoiceGroup:!0,showAlignmentChoiceGroup:!0,showTopicHeaderInput:!0,showAuthorVisibilityToggle:!0,showPublishDateVisibilityToggle:!0,showAltTextInput:!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toolbar",{get:function(){return{enablePropertyPane:!0,enableImageEditing:!0}},enumerable:!0,configurable:!0}),e.prototype._renderTopicHeader=function(e){return e.showTopicHeader&&u.createElement(v.a,{className:"jf_y_9f38462c",alignment:e.alignment,value:e.topicHeader,isFluent:e.isFluent})},e.prototype._renderTitleInput=function(e){return u.createElement(b.a,{editMode:e.editMode,title:e.title,titlePlaceholder:e.titlePlaceholder,titleAriaLabel:e.titleAriaLabel,maxLines:2,alignment:e.alignment,isFluent:e.isFluent,onChangeTitle:e.controller.updateTitle,onCommitTitle:e.controller.commitTitle})},e.prototype._renderPublishDate=function(e){return e.showPublishDate&&u.createElement(m.a,{className:"jh_y_9f38462c",serviceScope:e.serviceScope,alignment:e.alignment,isFluent:e.isFluent})},e.prototype._renderAuthorByline=function(e){return u.createElement(_.a,{isEditMode:e.editMode,serviceScope:e.serviceScope,alignment:e.alignment,className:"gl_y_9f38462c",selectedPersons:e.authors,authorByline:e.authorByline,onChangeSelectedPersons:e.controller.updateAuthors})},e}(),w=r("KL1q"),P=r("Ys63");r("GWJ3");var x=function(){function e(){var e=this;this.canvas=function(t){return u.createElement("div",{className:"iz_ah_9f38462c"},e._renderBackgroundImage(t),e._renderContentBox(t))},this._renderContentBox=function(t){return u.createElement(P.a,{className:"kb_ah_9f38462c",disabled:"DefaultImage"===t.image.type},u.createElement(g.a,{className:"ja_ah_9f38462c",editMode:t.editMode,serviceScope:t.serviceScope},e._renderTopicHeader(t),e._renderTitleText(t),e._renderAuthorByline(t),e._renderPublishDate(t)))}}return Object.defineProperty(e.prototype,"type",{get:function(){return"FullWidthImage"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertyPane",{get:function(){return{showLayoutChoiceGroup:!0,showAlignmentChoiceGroup:!0,showTopicHeaderInput:!0,showAuthorVisibilityToggle:!0,showPublishDateVisibilityToggle:!0,showAltTextInput:!0}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toolbar",{get:function(){return{enablePropertyPane:!0,enableImageEditing:!0}},enumerable:!0,configurable:!0}),e.prototype._renderBackgroundImage=function(e){return u.createElement(p.a,Object(n.__assign)({},e,{className:"gp_ah_9f38462c",onChangeFocalPoint:e.controller.setFocalPoint,onCompleteFirstRender:e.controller.completeFirstRender}))},e.prototype._renderTopicHeader=function(e){return e.showTopicHeader&&u.createElement(v.a,{className:"jf_ah_9f38462c",alignment:e.alignment,value:e.topicHeader,isFluent:e.isFluent})},e.prototype._renderTitleText=function(e){var t=Object(w.css)("DefaultImage"!==e.image.type&&"jy_ah_9f38462c");return u.createElement(b.a,{className:t,editMode:e.editMode,title:e.title,titlePlaceholder:e.titlePlaceholder,titleAriaLabel:e.titleAriaLabel,maxLines:2,alignment:e.alignment,isFluent:e.isFluent,onChangeTitle:e.controller.updateTitle,onCommitTitle:e.controller.commitTitle})},e.prototype._renderPublishDate=function(e){var t=Object(w.css)("jh_ah_9f38462c","DefaultImage"!==e.image.type&&"jy_ah_9f38462c");return e.showPublishDate&&u.createElement(m.a,{className:t,serviceScope:e.serviceScope,alignment:e.alignment,isFluent:e.isFluent})},e.prototype._renderAuthorByline=function(e){var t=Object(w.css)("gl_ah_9f38462c","DefaultImage"!==e.image.type&&_.a.whiteTextClassName);return u.createElement(_.a,{isEditMode:e.editMode,serviceScope:e.serviceScope,alignment:e.alignment,className:t,selectedPersons:e.authors,authorByline:e.authorByline,onChangeSelectedPersons:e.controller.updateAuthors})},e}();r("9ei3");var S=function(){function e(){var e=this;this.canvas=function(t){return u.createElement(g.a,{className:"ja_af_9f38462c",editMode:t.editMode,serviceScope:t.serviceScope},e._renderTopicHeader(t),e._renderTitleText(t),e._renderAuthorByline(t),e._renderPublishDate(t))}}return Object.defineProperty(e.prototype,"type",{get:function(){return"NoImage"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertyPane",{get:function(){return{showLayoutChoiceGroup:!0,showAlignmentChoiceGroup:!0,showTopicHeaderInput:!0,showAuthorVisibilityToggle:!0,showPublishDateVisibilityToggle:!0,showAltTextInput:!1}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toolbar",{get:function(){return{enablePropertyPane:!0,enableImageEditing:!1}},enumerable:!0,configurable:!0}),e.prototype._renderTopicHeader=function(e){return e.showTopicHeader&&u.createElement(v.a,{className:"jf_af_9f38462c",alignment:e.alignment,value:e.topicHeader,isFluent:e.isFluent})},e.prototype._renderAuthorByline=function(e){return u.createElement(_.a,{isEditMode:e.editMode,serviceScope:e.serviceScope,alignment:e.alignment,className:"gl_af_9f38462c",selectedPersons:e.authors,authorByline:e.authorByline,onChangeSelectedPersons:e.controller.updateAuthors})},e.prototype._renderTitleText=function(e){return u.createElement(b.a,{editMode:e.editMode,title:e.title,titlePlaceholder:e.titlePlaceholder,titleAriaLabel:e.titleAriaLabel,maxLines:2,alignment:e.alignment,isFluent:e.isFluent,onChangeTitle:e.controller.updateTitle,onCommitTitle:e.controller.commitTitle})},e.prototype._renderPublishDate=function(e){return e.showPublishDate&&u.createElement(m.a,{className:"jh_af_9f38462c",serviceScope:e.serviceScope,alignment:e.alignment,isFluent:e.isFluent})},e}(),I=function(){function e(){}return e.getLayout=function(t){var r=e._map.get(t);return r||(r=e._createLayout(t),e._map.set(t,r)),r},e._createLayout=function(e){switch(e){case"NoImage":return new S;case"CutInShape":return new y;case"FullWidthImage":default:return new x}},e._map=new Map,e}(),E=r("/l6g");r("NQze");var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderEditMode=function(e){var r=Object(w.mergeStyles)("le_al_9f38462c",E.f.isActivated()&&"lf_al_9f38462c");return u.createElement(e.TitleRegionEditMode,Object(n.__assign)({},t.props,{className:r}))},t._renderViewMode=function(){return u.createElement(t.props.layout.canvas,Object(n.__assign)({},t.props))},t}return Object(n.__extends)(t,e),t.prototype.render=function(){return u.createElement(f.a,{editMode:this.props.editMode,renderViewMode:this._renderViewMode,renderEditMode:this._renderEditMode})},t}(u.PureComponent),L=r("dg7M"),T=r("ZgyI"),j=r("VXhS"),R=r("Expv"),O=r("P/oh"),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isAuthorUpdatedAfterDeserialize=!1,t._useFullSizeImageURL=!1,t._renderTitleRegion=function(){var e=u.createElement(C,{editMode:t.displayMode===i.DisplayMode.Edit,image:t._imageInfo,layout:t._layout,focalPoint:t._imageOffset,altText:t.properties.altText||"",alignment:t.properties.textAlignment||"Left",title:t.properties.title||"",titlePlaceholder:Object(E.b)()&&t.properties.titlePlaceholder||"",titleAriaLabel:t.properties.titleAriaLabel||"",serviceScope:t.context.serviceScope,controller:t._controller,showTopicHeader:t.properties.showTopicHeader||!1,topicHeader:t.properties.topicHeader||"",showPublishDate:t.properties.showPublishDate||!1,dateBox:t.properties.dateBox,authors:t.properties.authors||[],authorByline:t.properties.authorByline||[],requestedHeight:t._getHeightForLayout(t._layout),ref:t._titleRegionDidMount,isFluent:Object(T.b)(),useFullSizeImageURL:Object(O.c)()&&Object(O.a)()&&t._useFullSizeImageURL});d.render(Object(E.p)()?u.createElement(L.a.Provider,{value:{eventObserver:t}},e):e,t.domElement),t._setupFocusOnInput()},t._setupFocusOnInput=function(){t.properties.focusOnInput&&t.displayMode===i.DisplayMode.Edit&&f.a.import().then(function(e){e.TitleInput.focus(t._titleRegion,!E.d.isActivated()||void 0),t.properties.focusOnInput=!1}).catch(function(e){o._TraceLogger.logError(o._LogSource.create("TitleRegion"),e,"ImportEditModeChunk")})},t._titleRegionDidMount=function(e){t._titleRegion=e,e&&(p.a.applyParallax(e),t.context.serviceScope.consume(j.a.serviceKey))},t._updateImage=function(e){"DefaultImage"===e.type?(t.properties.imageSourceType=4,t.properties.imageSource="",t.properties.webId=void 0,t.properties.siteId=void 0,t.properties.listId=void 0,t.properties.uniqueId=void 0):"SharePointImage"===e.type?(t.properties.imageSourceType=2,t.properties.imageSource=e.source,t.properties.webId=e.webId&&e.webId.toString(),t.properties.siteId=e.siteId&&e.siteId.toString(),t.properties.listId=e.listId&&e.listId.toString(),t.properties.uniqueId=e.uniqueId&&e.uniqueId.toString()):"LocalImage"!==e.type&&"ExternalImage"!==e.type||(t.properties.imageSourceType=2,t.properties.imageSource=e.id,t.properties.webId=void 0,t.properties.siteId=void 0,t.properties.listId=void 0,t.properties.uniqueId=void 0),t._imageInfo.id!==e.id&&(t.properties.translateX=void 0,t.properties.translateY=void 0),t._imageInfo=e,t.render()},t._updateAltText=function(e){t.properties.altText=e,t.context.propertyPane.refresh(),t.render()},t._updateTitle=function(e){t.properties.title!==e&&(t.properties.hasTitleBeenCommitted=!1,t.properties.title=e,t._internalSetDirtyBit(),t.render())},t._commitTitle=function(e){e&&(t.properties.title=e,t.properties.hasTitleBeenCommitted=!0)},t._updateAuthorByline=function(e){t.properties.authorByline=e.map(function(e){return e.id}),t._isAuthorUpdatedAfterDeserialize=!0,t.properties.authors=e,t.render()},t._togglePropertyPane=function(){t.context.propertyPane.isPropertyPaneOpen()?t.context.propertyPane.close():t.context.propertyPane.open()},t._switchLayout=function(e){t.properties.layoutType=e,t.render()},t._setFocalPoint=function(e,r){e?(o._EngagementLogger.logEventWithLogEntry(new o._LogEntry("TitleRegionWebPart","FocalPointMove",o._LogType.Event,{focalPointSource:r})),t.properties.translateX=e.x,t.properties.translateY=e.y):(t.properties.translateX=void 0,t.properties.translateY=void 0),t.render()},t}return Object(n.__extends)(t,e),t._getImageInfo=function(e){switch(e.imageSourceType){case 2:return{id:e.imageSource||"",type:"SharePointImage",source:e.imageSource||"",webId:i.Guid.tryParse(e.webId),siteId:i.Guid.tryParse(e.siteId),listId:i.Guid.tryParse(e.listId),uniqueId:i.Guid.tryParse(e.uniqueId)};case 0:case 4:default:return p.a.defaultImage}},Object.defineProperty(t.prototype,"previewImageUrl",{get:function(){var e=this.properties,t=e.imageSourceType,r=e.imageSource,n=e.layoutType;if(!Object(E.a)()||"NoImage"!==n&&"EventNoImage"!==n){var i=!(2===t&&r&&r.indexOf("/_LAYOUTS/")>=0)&&r||"";return Object(l.b)({pageContext:this.context.pageContext,url:i,siteId:this.properties.siteId,webId:this.properties.webId,listId:this.properties.listId,uniqueId:this.properties.uniqueId})}},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this,r=t._getImageInfo(this.properties);this._imageInfo.id!==r.id&&(this._imageInfo=r);var n=this._layoutType;this._isChunkedLayout(n)?h.import(n).then(function(t){e._layout=t}).then(this._renderTitleRegion).catch(function(e){o._TraceLogger.logError(o._LogSource.create("TitleRegion"),e,"ImportLayoutChunk")}):(this._layout=I.getLayout(n),this._renderTitleRegion())},t.prototype.onDispose=function(){e.prototype.onDispose.call(this),p.a.removeParallax(this._titleRegion),d.unmountComponentAtNode(this.domElement)},t.prototype.onInit=function(){var r=this;this._imageInfo=t._getImageInfo(this.properties),this._controller={updateTitle:this._updateTitle,commitTitle:this._commitTitle,updateImage:this._updateImage,updateAltText:this._updateAltText,updateAuthors:this._updateAuthorByline,switchLayout:this._switchLayout,setFocalPoint:this._setFocalPoint,togglePropertyPane:this._togglePropertyPane,completeFirstRender:this.renderCompleted},s._PerformanceLogger.markComponent(this.context.webPartTag,""+s._PerformanceDataDimensions.Layout+(this.properties.layoutType||"FullWidthImage"));var n=this._layoutType;return this._isChunkedLayout(n)?h.import(n).then(function(e){r._layout=e}).then(e.prototype.onInit).catch(function(e){o._TraceLogger.logError(o._LogSource.create("TitleRegion"),e,"ImportLayoutChunk")}):(this._layout=I.getLayout(n),e.prototype.onInit.call(this))},Object.defineProperty(t.prototype,"dataVersion",{get:function(){return i.Version.parse("1.4")},enumerable:!0,configurable:!0}),t.prototype.onAfterDeserialize=function(e,t){return t.lessThan(i.Version.parse("1.2"))&&(void 0!==e.imageSourceType&&1!==e.imageSourceType&&3!==e.imageSourceType||!e.imageSource?e.imageSourceType=4:e.imageSourceType=2),t.lessThan(i.Version.parse("1.4"))&&(e.layoutType=0===e.imageSourceType?"NoImage":"FullWidthImage",e.textAlignment="Left",e.showTopicHeader=!1,e.showPublishDate=!1,e.topicHeader="",e.authorByline=e.authorByline||[],e.authors=e.authors||[]),e.layoutType=e.layoutType||"FullWidthImage",e.textAlignment=e.textAlignment||"Left",e.showTopicHeader=e.showTopicHeader||!1,e.showPublishDate=e.showPublishDate||!1,e.topicHeader=e.topicHeader||"",this._isAuthorUpdatedAfterDeserialize=!1,e.authors||(e.authors=[],this._tryPopulateDefaultAuthor().catch(function(){})),void 0===e.authorByline?e.authorByline=[this.context.pageContext.user.loginName]:e.authorByline=e.authors.map(function(e){return e.id}),e},t.prototype.onDisplayModeChanged=function(t){e.prototype.onDisplayModeChanged.call(this,t),this.displayMode===i.DisplayMode.Edit?(p.a.removeParallax(this._titleRegion),this._useFullSizeImageURL=Object(O.c)()&&Object(O.a)()&&!0):(p.a.applyParallax(this._titleRegion),c.SPFREUtility.clearAllFRECallout())},t.prototype.onPropertyPaneConfigurationComplete=function(){e.prototype.onPropertyPaneConfigurationComplete.call(this);var t=new o._LogEntry("TitleRegionWebPart","Properties",o._LogType.Event,{alignment:String(this.properties.textAlignment),authorsLen:String((this.properties.authors||[]).length),authorBylineLen:String((this.properties.authorByline||[]).length),backgroundImageSourceType:String(this.properties.imageSourceType),layoutType:String(this.properties.layoutType),showPublishDate:String(this.properties.showPublishDate),showTopicHeader:String(this.properties.showTopicHeader),titleRegionWidth:String(this.width),titleTextLen:String((this.properties.title||"").length),topicHeaderLength:String((this.properties.topicHeader||"").length)});o._EngagementLogger.logEventWithLogEntry(t)},Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return E.e.isActivated()?"ColorBlock"===this._layout.type||"CutInShape"===this._layout.type||"FullWidthImage"===this._layout.type:"ColorBlock"===this._layoutType||"CutInShape"===this._layoutType||"FullWidthImage"===this._layoutType},enumerable:!0,configurable:!0}),t.prototype.onBeforeSerialize=function(){delete this.properties.focusOnInput,delete this.properties.textAlignCenter,delete this.properties.kicker,delete this.properties.showKicker,this.properties.authorByline&&(this.properties.authorByline=this.properties.authorByline.filter(function(e){return isNaN(Number(e))}))},t.prototype.onPropertyPaneFieldChanged=function(t,r,n){e.prototype.onPropertyPaneFieldChanged.call(this,t,r,n),"topicHeader"===t&&n!==r&&void 0!==r&&0===r.toString().length&&void 0!==n&&n.toString().length>0&&(this.properties.showTopicHeader=!0)},Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){var e={imageSource:{isImageSource:!0}};return e.imageSource.customMetadata={siteId:"siteId",webId:"webId",listId:"listId",uniqueId:"uniqueId"},e},enumerable:!0,configurable:!0}),t.prototype.loadPropertyPaneResources=function(){var e=this;return f.a.import().then(function(t){e._propertyPane=new t.TitleRegionPropertyPane})},t.prototype.getPropertyPaneConfiguration=function(){if(this._propertyPane&&this._layout.propertyPane){var t=this._layout.propertyPane;return"DefaultImage"===this._imageInfo.type&&(t.showAltTextInput=!1),this._propertyPane.getConfiguration(t,this.properties)}return e.prototype.getPropertyPaneConfiguration.call(this)},Object.defineProperty(t.prototype,"accessibleTitle",{get:function(){return R.a},enumerable:!0,configurable:!0}),t.prototype._getHeightForLayout=function(e){if(Object(O.c)()&&Object(O.a)())return"ColorBlock"===e.type?450:228},Object.defineProperty(t.prototype,"_imageOffset",{get:function(){return void 0===this.properties.translateX||void 0===this.properties.translateY?void 0:{x:this.properties.translateX,y:this.properties.translateY}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_layoutType",{get:function(){return this.properties.isLockedToTitleEditOnly?"NewsDigest":this.properties.layoutType||"FullWidthImage"},enumerable:!0,configurable:!0}),t.prototype._isChunkedLayout=function(e){return"Event"===e||"EventNoImage"===e||"NewsDigest"===e||"TopicPage"===e||"ColorBlock"===e},t.prototype._tryPopulateDefaultAuthor=function(){var e=this;return f.a.import().then(function(t){return new t.DefaultAuthorPopulator(e.context.serviceScope).populateDefaultAuthor()}).catch(function(e){throw new c.UnexpectedFailure("FailToGetDefaultAuthor",e)}).then(function(t){if(e._isAuthorUpdatedAfterDeserialize)throw new c.ExpectedFailure("AuthorUpdated");if(e.displayMode===i.DisplayMode.Read)throw new c.ExpectedFailure("PageEnteredReadMode");e.properties.authors=[t],e.render()})},Object(n.__decorate)([Object(c.monitor)("TitleRegion.TryPopulateDefaultAuthor")],t.prototype,"_tryPopulateDefaultAuthor",null),t}(a.BaseClientSideWebPart);t.default=U},ut3N:function(e,t){e.exports=h},vlQI:function(e,t){e.exports=_},y88i:function(e,t){e.exports=g}})});